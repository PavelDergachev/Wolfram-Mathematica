Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Harmonics",
 FontSlant->"Italic",
 FontColor->RGBColor[1, 0, 0]]], "Title"],

Cell[TextData[StyleBox["Tensor harmonics on the 2-sphere",
 FontColor->RGBColor[0, 0, 1]]], "Subtitle"],

Cell[TextData[{
 "David Brizuela, Jos\[EAcute] M. Mart\[IAcute]n-Garc\[IAcute]a and Guillermo \
A. Mena Marug\[AAcute]n\n",
 StyleBox["Instituto de Estructura de la Materia, CSIC, Madrid\n\n(c) \
2005-2015, under GPL\n\njose@xAct.es\n\nhttp://www.xAct.es/\n\
http://metric.iem.csic.es/Martin-Garcia/xAct/\n\n\
http://groups.google.com/group/xAct",
  FontSize->16],
 "\n"
}], "Subsubtitle",
 FontSize->18],

Cell[TextData[{
 "October 2005 -- May 2006.\n",
 StyleBox["August 2007: Notebook adapted for version 0.9.2 of xAct.\nNovember \
2007: Notebook adapted for version 0.9.3 of xAct.\nJuly 2009: Notebook \
adapted for version 0.9.9 of xAct.",
  FontSize->12]
}], "Subsubtitle",
 FontSize->18],

Cell[TextData[{
 "This notebook defines different forms of the tensor harmonics on the sphere \
S^2. It requires the package ",
 StyleBox["xTensor",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 " for abstract computations and its twin package ",
 StyleBox["xCoba",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 " for component computations.\n\nThe package ",
 StyleBox["Harmonics",
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0, 0]],
 " is distributed under the GNU GPL License"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Date", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2015", ",", "8", ",", "19", ",", "2", ",", "48", ",", 
   "44.071012`8.39672800046133"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xAct`Harmonics`$Version", "=", 
  RowBox[{"{", 
   RowBox[{"\"\<0.7.2\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"2014", ",", "2", ",", "15"}], "}"}]}], "}"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"0.7.2\"\>", ",", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "2", ",", "15"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Initialization", "Subsection"],

Cell[CellGroupData[{

Cell["1.1. GPL", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Harmonics", ",", " ", 
    RowBox[{
    "a", " ", "free", " ", "package", " ", "for", " ", "tensor", " ", 
     "computations", " ", "with", " ", "tensor", " ", "harmonics", " ", "in", 
     " ", "Mathematica"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2005"}], "-", 
     RowBox[{"2015", " ", "David", " ", "Brizuela"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Jose", " ", 
      RowBox[{"M", ".", " ", "Martin"}]}], "-", 
     RowBox[{"Garcia", " ", "and", " ", "Guillermo", " ", 
      RowBox[{"A", ".", " ", "Mena"}], " ", "Marugan"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", " ", "it", " ", "under", " ",
       "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", "General",
       " ", "Public", " ", "License", " ", "as", " ", "published", " ", "by", 
      " ", "the", " ", "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
      "License"}]}], ",", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", "FOR", 
      " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
      
      RowBox[{
      "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "You"}], 
      " ", "should", " ", "have", " ", "received", " ", "a", " ", "copy", " ",
       "of", " ", "the", " ", "GNU", " ", "General", " ", "Public", " ", 
      "License", " ", "along", " ", "with", " ", "this", " ", "program"}], 
     ";", " ", 
     RowBox[{"if", " ", "not"}]}], ",", " ", 
    RowBox[{
    "write", " ", "to", " ", "the", " ", "Free", " ", "Software", " ", 
     "Foundation"}], ",", " ", 
    RowBox[{"Inc", "."}], ",", " ", 
    RowBox[{
     RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
     RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
    RowBox[{
     RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", " ", 
    RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.2. Info package", "Subsubsection"],

Cell["\<\
(* :Title: Harmonics *)

(* :Author: David Brizuela, Jose M. Martin-Garcia and Guillermo A. Mena \
Marugan *)

(* :Summary: Free package for computations with tensor harmonics *)

(* :Brief Discussion:
   - TO FILL IN
*)
  
(* :Context: xAct`Harmonics` *)

(* :Package Version: 0.7.2 *)

(* :Copyright: David Brizuela, Jose M. Martin-Garcia and Guillermo A. Mena \
Marugan (2005-2015) *)

(* :History: see Harmonics.History *)

(* :Keywords: *)

(* :Source: Harmonics.nb *)

(* :Warning: *)

(* :Mathematica Version: 5.0 and later *)

(* :Limitations: *)\
\>", "Input",
 PageWidth->PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.3. BeginPackage", "Subsubsection"],

Cell["Protect against multiple loading of the package:", "Text"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xAct`Harmonics`Private`HarmonicsSymbols", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Names", "[", "\"\<xAct`Harmonics`*\>\"", "]"}], ",", 
         RowBox[{"Names", "[", "\"\<xAct`Harmonics`Private`*\>\"", "]"}]}], 
        "]"}], ",", 
       RowBox[{
       "\"\<$Version\>\"", "|", "\"\<xAct`Harmonics`$Version\>\"", "|", 
        "\"\<$HarmonicsVersionExpected\>\"", "|", 
        "\"\<xAct`Harmonics`$xTensorVersionExpected\>\""}]}], "]"}]}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "/@", "xAct`Harmonics`Private`HarmonicsSymbols"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "/@", "xAct`Harmonics`Private`HarmonicsSymbols"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`Harmonics`\>\""}]}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["xAct`xCore`Private`$LastPackage"], "Input"],

Cell[BoxData["\<\"xAct`Harmonics`\"\>"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Explicit (not hidden) import of ",
 StyleBox["xCoba",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ", ",
 StyleBox["xTensor",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ", ",
 StyleBox["xPerm",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 " and ",
 StyleBox["xCore",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ":"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`Harmonics`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xCoba`\>\"", ",", "\"\<xAct`xTensor`\>\"", ",", 
     "\"\<xAct`xPerm`\>\"", ",", "\"\<xAct`xCore`\>\""}], "}"}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.3\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2015", ",", "8", ",", "23"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.3", ", ", {2015, 8, 23}],
  
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2003-2015, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"Connecting to external mac executable...\"\>"], "Print"],

Cell[BoxData["\<\"Connection established.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.1.2\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2015", ",", "8", ",", "23"}], "}"}]}],
  SequenceForm[
  "Package xAct`xTensor`  version ", "1.1.2", ", ", {2015, 8, 23}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2002-2015, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xCoba`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.8.3\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2015", ",", "8", ",", "23"}], "}"}]}],
  SequenceForm["Package xAct`xCoba`  version ", "0.8.3", ", ", {2015, 8, 23}],
  
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2005-2014, David Yllanes and Jose M. \
Martin-Garcia, under the General Public License.\"\>"], "Print"]
}, Open  ]],

Cell[BoxData["\<\"xAct`Harmonics`\"\>"], "Output"]
}, Open  ]],

Cell["Welcome message:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`Harmonics`  version \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<CopyRight (C) 2005-2015, David Brizuela, Jose M. Martin-Garcia and \
Guillermo A. Mena Marugan, under the General Public License.\>\"", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`Harmonics`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.7.2\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "2", ",", "15"}], "}"}]}],
  SequenceForm[
  "Package xAct`Harmonics`  version ", "0.7.2", ", ", {2014, 2, 15}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2005-2015, David Brizuela, Jose M. \
Martin-Garcia and Guillermo A. Mena Marugan, under the General Public \
License.\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We specify the context xAct`Harmonics` to avoid overriding the Disclaimer of \
the other packages. However we need to turn off the message General:shdw \
temporarily:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`Harmonics`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`Harmonics`\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "Eliminate annoying spell messages (this is now included in ",
 StyleBox["xCore",
  FontSlant->"Italic"],
 "):"
}], "Text"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "spell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "spell1"}], "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.4. Set up", "Subsubsection"],

Cell["Screen all dollar indicess:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSet", "[", 
   RowBox[{"$PrePrint", ",", "ScreenDollarIndices"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell["Postfix format for derivatives:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSet", "[", 
   RowBox[{"$CovDFormat", ",", "\"\<Postfix\>\""}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
In this notebooks we shall allow metric contractions everywhere:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSetOption", "[", 
   RowBox[{"ContractMetric", ",", 
    RowBox[{"AllowUpperDerivatives", "\[Rule]", "True"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSetOption", "[", 
   RowBox[{"MakeRule", ",", 
    RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSetOption", "[", 
   RowBox[{"MakeRule", ",", 
    RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.5. Usage messages", "Subsubsection"],

Cell["This is the only angular function we really need:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"calDEdmonds", "::", "usage"}], "=", 
   "\"\<calDEdmonds[j, mp, m][\[Alpha], \[Beta], \[Gamma]] computes the \
Wigner matrix with labels j, mp and m for the SO(3) rotation described by \
Euler angles \[Alpha], \[Beta], \[Gamma], as given by Edmonds. Note that \
other authors use a different convention for this function.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calD", "::", "usage"}], "=", 
   "\"\<calD[LI[l], LI[mp], LI[m]] is the formal scalar denoting the Wigner \
matrix. It can be transformed into actual functions of the spherical angles \
using the rule calDRule.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calDRule", "::", "usage"}], "=", 
   "\"\<calDRule transforms the calD scalar into the function calDEdmonds \
with Euler angles \[Alpha]=0, \[Beta]=\[Theta], \[Gamma]=\[Phi].\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["The manifold:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S2", "::", "usage"}], "=", 
   "\"\<The package Harmonics constructs the 2-sphere S2 with indices \
IndexList[a, b, c, d, e, f] and ultraindex uS2, and its tangent vbundle \
TangentS2.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TangentS2", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uS2", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"etaUpS2", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"etaDownS2", "::", "usage"}], "=", 
   RowBox[{"S2", "::", "usage"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"a", "::", "shdw"}], "MessageName"], ":", 
  " ", "\<\"Symbol \[NoBreak]\\!\\(\\\"a\\\"\\)\[NoBreak] appears in multiple \
contexts \[NoBreak]\\!\\({\\\"xAct`Harmonics`\\\", \\\"Global`\\\"}\\)\
\[NoBreak]; definitions in context \[NoBreak]\\!\\(\\\"xAct`Harmonics`\\\"\\)\
\[NoBreak] may shadow or be shadowed by other definitions. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/shdw\\\", \
ButtonNote -> \\\"xAct`Harmonics`a::shdw\\\"]\\)\"\>"}]], "Message", "MSG"]
}, Open  ]],

Cell["The metric on the manifold:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gamma", "::", "usage"}], "=", 
   "\"\<The package Harmonics defines the metric gamma (prints as \[Gamma]) \
on the 2-sphere S2. Its Levi-Civita connection is cd, with associated tensors \
Riemanncd, Riccicd, RicciScalarcd = 2, and vanishing Torsioncd, Einsteincd \
and Weylcd. There is also the Christoffelcd connection cd with PD, the \
antisymmetric tensor epsilongamma, and the absolute value of the determinant \
AbsDetgamma in the DefaultChart.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Riemanncd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Riccicd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciScalarcd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Torsioncd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Einsteincd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Weylcd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Christoffelcd", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"epsilongamma", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AbsDetgamma", "::", "usage"}], "=", 
   RowBox[{"gamma", "::", "usage"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["The spherical chart:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"spherical", "::", "usage"}], "=", 
   "\"\<The package Harmonics defines the chart spherical on the 2-sphere S2 \
and assigns values to the components of the metric tensors in this chart. The \
coordinate fields are called \[Theta][] and \[Phi][]. The associated parallel \
(partial) derivative is called PDspherical. The associated\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PDspherical", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TorsionPDspherical", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelPDspherical", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannPDspherical", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciPDspherical", "::", "usage"}], "=", 
   RowBox[{"spherical", "::", "usage"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Complex basis vectors:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m", "::", "usage"}], "=", 
   "\"\<m[a] and mbar[a] are the complex Newman-Penrose vectors on the \
2-sphere. They are null vectors.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mbar", "::", "usage"}], "=", 
   RowBox[{"m", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mmbarRule", "::", "usage"}], "=", 
   "\"\<mmbarRule transforms the product of one m[a] and one mbar[b] vectors \
into a sum of a gamma[a,b] object and epsilongamma[a,b] with suitable \
coefficients.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell["STF harmonics:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Z", "::", "usage"}], "=", 
   "\"\<Z[LI[l], LI[m], a1, a2, ..., as] represents the polar generalized-GS \
tensor harmonics with labels l, m, and s indices.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "::", "usage"}], "=", 
   "\"\<X[LI[l], LI[m], a1, a2, ..., as] represents the axial generalized-GS \
tensor harmonics with labels l, m, and s indices.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calZ", "::", "usage"}], "=", 
   "\"\<calZ[LI[sign], LI[l], LI[m], a1, a2, ..., as] is a combined notation \
for the generalized-GS tensor harmonics. For sign=1 calZ = Z and for sign=-1 \
calZ = -I*X.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZToX", "::", "usage"}], "=", 
   "\"\<ZToX and XToZ are rules which transform the Z tensor harmonics into X \
harmonics and viceversa, respectively.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XToZ", "::", "usage"}], "=", 
   RowBox[{"ZToX", "::", "usage"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dropepsilon", "::", "usage"}], "=", 
   "\"\<Dropepsilon is a rule which contracts epsilongamma with the tensor \
harmonics Z and X.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffK", "::", "usage"}], "=", 
   "\"\<coeffK[l, s] is the normalization factor for pure-spin \
harmonics.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PureSpin", "::", "usage"}], "=", 
   "\"\<PureSpin[l, sign, m][a1, ..., as] returns the pure-spin harmonic as a \
product of coeffK, calD and a number of complex NP vectors.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZXToY", "::", "usage"}], "=", 
   "\"\<ZXToY is a rule which transforms the Z and X harmonics into PureSpin \
harmonics.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Orbitalt", "::", "usage"}], "=", 
   "\"\<Orbitalt[LI[m], a] are the complex Cartesian vectors. Orbitalt[LI[m], \
a1, ..., as] are the complex Cartesian tensors obtained by combination of the \
former.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PureOrbital", "::", "usage"}], "=", 
   "\"\<PureOrbital[j, l, m][a1, ..., as] returns the pure-orbital harmonic \
with labels j, l, m and s indices.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Computation of components:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HarmonicComponent", "::", "usage"}], "=", 
   "\"\<HarmonicComponent[expr] returns the scalar expression as a function \
of the coordinates \[Theta][] and \[Phi][].\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell["Products of harmonics:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"coeffE", "::", "usage"}], "=", 
   "\"\<coeffE[{l1, s1, m1}, {l2, s2, m2}, l] is the formal coefficient E in \
the expansion of a product of two tensor harmonics. It can be evaluated using \
the coeffERule.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffERule", "::", "usage"}], "=", 
   "\"\<coeffERule is a rule which evaluates the numerical value of the E \
coefficients.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProductRule", "::", "usage"}], "=", 
   "\"\<ProductRule is a rule which expands the product of two tensor \
harmonics with integer labels.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormalProductRule", "::", "usage"}], "=", 
   "\"\<FormalProductRule[l] is a rule which expresses the product of two \
tensor harmonics with non-integer labels, using l as last argument of the \
coefficients E.\>\""}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["1.6. Begin private", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`Harmonics`Private`\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<xAct`Harmonics`*\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"a\"\>", ",", "\<\"AbsDetgamma\"\>", ",", "\<\"b\"\>", 
   ",", "\<\"c\"\>", ",", "\<\"calD\"\>", ",", "\<\"calDEdmonds\"\>", 
   ",", "\<\"calDRule\"\>", ",", "\<\"calZ\"\>", ",", "\<\"cd\"\>", 
   ",", "\<\"Christoffelcd\"\>", ",", "\<\"ChristoffelPDspherical\"\>", 
   ",", "\<\"coeffE\"\>", ",", "\<\"coeffERule\"\>", ",", "\<\"coeffK\"\>", 
   ",", "\<\"d\"\>", ",", "\<\"Disclaimer\"\>", ",", "\<\"Dropepsilon\"\>", 
   ",", "\<\"e\"\>", ",", "\<\"Einsteincd\"\>", ",", "\<\"epsilongamma\"\>", 
   ",", "\<\"etaDownS2\"\>", ",", "\<\"etaUpS2\"\>", ",", "\<\"f\"\>", 
   ",", "\<\"FormalProductRule\"\>", ",", "\<\"gamma\"\>", 
   ",", "\<\"HarmonicComponent\"\>", ",", "\<\"m\"\>", ",", "\<\"mbar\"\>", 
   ",", "\<\"mmbarRule\"\>", ",", "\<\"Orbitalt\"\>", 
   ",", "\<\"PDspherical\"\>", ",", "\<\"ProductRule\"\>", 
   ",", "\<\"PureOrbital\"\>", ",", "\<\"PureSpin\"\>", 
   ",", "\<\"Riccicd\"\>", ",", "\<\"RicciPDspherical\"\>", 
   ",", "\<\"RicciScalarcd\"\>", ",", "\<\"Riemanncd\"\>", 
   ",", "\<\"RiemannPDspherical\"\>", ",", "\<\"S2\"\>", 
   ",", "\<\"spherical\"\>", ",", "\<\"TangentS2\"\>", 
   ",", "\<\"Torsioncd\"\>", ",", "\<\"TorsionPDspherical\"\>", 
   ",", "\<\"uS2\"\>", ",", "\<\"Weylcd\"\>", ",", "\<\"X\"\>", 
   ",", "\<\"XToZ\"\>", ",", "\<\"Z\"\>", ",", "\<\"ZToX\"\>", 
   ",", "\<\"ZXToY\"\>", ",", "\<\"\[Theta]\"\>", ",", "\<\"\[Phi]\"\>", 
   ",", "\<\"$Version\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input"],

Cell[BoxData["54"], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Conventions for the angular functions", "Subsection"],

Cell["\<\
There are several conventions in the literature for the functions which are \
used in the description of the rotation group.\
\>", "Text"],

Cell[TextData[{
 "The choice of spherical harmonics is now almost universal. From ",
 StyleBox["Mathematica'",
  FontSlant->"Italic"],
 "s help:\n\nFor ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["l", "TI"], "\[GreaterEqual]", "0"}], TraditionalForm]], 
  "InlineFormula"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox[
     StyleBox["Y", "TI"], 
     StyleBox["l", "TI"], 
     StyleBox["m", "TI"]], 
    RowBox[{"(", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], "=", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", 
        StyleBox["l", "TI"], "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", "\[Pi]"}], ")"}]}]], 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        StyleBox["l", "TI"], "-", 
        StyleBox["m", "TI"]}], ")"}], "!", "/", 
      RowBox[{"(", 
       RowBox[{
        StyleBox["l", "TI"], "+", 
        StyleBox["m", "TI"]}], ")"}], "!"}]], 
    SubsuperscriptBox[
     StyleBox["P", "TI"], 
     StyleBox["l", "TI"], 
     StyleBox["m", "TI"]], 
    RowBox[{"(", 
     RowBox[{"cos", "(", "\[Theta]", ")"}], ")"}], 
    SuperscriptBox[
     StyleBox["e", "TI"], 
     RowBox[{
      StyleBox["i", "TI"], 
      StyleBox["m", "TI"], "\[Phi]"}]]}], TraditionalForm]], 
  "InlineFormula"],
 " where ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    StyleBox["P", "TI"], 
    StyleBox["l", "TI"], 
    StyleBox["m", "TI"]], TraditionalForm]], "InlineFormula"],
 " is the associated Legendre function: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox[
      StyleBox["P", "TI"], 
      StyleBox["l", "TI"], 
      StyleBox["m", "TI"]], 
     RowBox[{"(", 
      StyleBox["x", "TI"], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       StyleBox["m", "TI"]], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["2", "l"], 
        RowBox[{"l", "!"}]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         StyleBox["x", "TI"], "2"]}], ")"}], 
      RowBox[{
       StyleBox["m", "TI"], "/", "2"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         StyleBox["d", "TI"], 
         RowBox[{"l", "+", 
          StyleBox["m", "TI"]}]], "/", 
        StyleBox["d", "TI"]}], 
       SuperscriptBox[
        StyleBox["x", "TI"], 
        RowBox[{"l", "+", 
         StyleBox["m", "TI"]}]]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["x", "TI"], "2"], "-", "1"}], ")"}], "l"]}]}], 
   TraditionalForm]], "InlineFormula"],
 "\n\nNote the phase ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    StyleBox["m", "TI"]], TraditionalForm]], "InlineFormula"],
 " (so-called Condon-Shortley phase) in the Legendre polynomial. Edmonds does \
not use that phase (Edmonds 2.5.17), but later on he compensates that with \
the definition of spherical harmonics (Edmonds 2.5.29). Therefore the \
definitions for ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    StyleBox["Y", "TI"], 
    StyleBox["l", "TI"], 
    StyleBox["m", "TI"]], TraditionalForm]], "InlineFormula"],
 "of Edmonds, Galindo-Pascual and ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " all coincide."
}], "Text"],

Cell["\<\
For the representation matrices we use Edmonds' convention. Note that \
\[Alpha]=0, \[Beta]=\[Theta] and \[Gamma]=\[Phi]. Note also that his equation \
(4.1.12) contains a mistake: angles \[Alpha] and \[Gamma] must be exchanged \
(this error has been previously pointed our for example in PhysRev A 18 \
(1978) 392, appendix B):\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dEdmonds", "[", 
    RowBox[{"j_", ",", "mp_", ",", "m_"}], "]"}], "[", "\[Beta]_", "]"}], ":=", 
  RowBox[{"0", "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "mp", "]"}], ">", "j"}], "||", 
    RowBox[{
     RowBox[{"Abs", "[", "m", "]"}], ">", 
     "j"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dEdmonds", "[", 
    RowBox[{"j_", ",", "mp_", ",", "m_"}], "]"}], "[", "\[Beta]_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "+", "mp"}], ")"}], "!"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "mp"}], ")"}], "!"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "+", "m"}], ")"}], "!"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "m"}], ")"}], "!"}]}], "]"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"j", "-", "mp", "-", "\[Sigma]"}], ")"}]}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "mp", "-", "\[Sigma]"}], ")"}], "!"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "m", "-", "\[Sigma]"}], ")"}], "!"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mp", "+", "m", "+", "\[Sigma]"}], ")"}], "!"}], 
         RowBox[{"\[Sigma]", "!"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Beta]", "/", "2"}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "j"}], "-", "mp", "-", "m", "-", 
         RowBox[{"2", "\[Sigma]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Beta]", "/", "2"}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"mp", "+", "m", "+", 
         RowBox[{"2", "\[Sigma]"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "mp"}], "-", "m"}], ",", "0"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j", "-", "mp"}], ",", 
         RowBox[{"j", "-", "m"}]}], "]"}]}], "}"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"calDEdmonds", "[", 
    RowBox[{"j_", ",", "mp_", ",", "m_"}], "]"}], "[", 
   RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "mp", " ", "\[Alpha]"}], "]"}], 
   RowBox[{
    RowBox[{"dEdmonds", "[", 
     RowBox[{"j", ",", "mp", ",", "m"}], "]"}], "[", "\[Beta]", "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "m", " ", "\[Gamma]"}], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
The the formal Wigner matrices calD will be defined below and replaced by \
their values with the calDRule:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calDRule", "=", 
  RowBox[{
   RowBox[{"calD", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "mp_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
   RowBox[{
    RowBox[{"calDEdmonds", "[", 
     RowBox[{"l", ",", "mp", ",", "m"}], "]"}], "[", 
    RowBox[{"0", ",", 
     RowBox[{"\[Theta]", "[", "]"}], ",", 
     RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"calD", "[", 
   RowBox[{
    RowBox[{"LI", "[", "l_", "]"}], ",", 
    RowBox[{"LI", "[", "mp_", "]"}], ",", 
    RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
  RowBox[{
   RowBox[{"calDEdmonds", "[", 
    RowBox[{"l", ",", "mp", ",", "m"}], "]"}], "[", 
   RowBox[{"0", ",", 
    RowBox[{"\[Theta]", "[", "]"}], ",", 
    RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dEdmonds", "[", 
    RowBox[{"7", ",", "3", ",", "3"}], "]"}], "[", "\[Beta]", "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "128"], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Cos",
      ShowAutoStyles->False,
      AutoSpacing->False],
     Cos,
     Editable->False], "[", 
    FractionBox["\[Beta]", "2"], "]"}], "6"], " ", 
  RowBox[{"(", 
   RowBox[{"5595", "-", 
    RowBox[{"9944", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        ShowAutoStyles->False,
        AutoSpacing->False],
       Cos,
       Editable->False], "[", "\[Beta]", "]"}]}], "+", 
    RowBox[{"6908", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        ShowAutoStyles->False,
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "-", 
    RowBox[{"3432", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        ShowAutoStyles->False,
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", "\[Beta]"}], "]"}]}], "+", 
    RowBox[{"1001", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        ShowAutoStyles->False,
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"4", " ", "\[Beta]"}], "]"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"\[Beta]", ",", "0", ",", "Pi"}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.0238095 0.303152 0.18722 0.416099 [
[.17539 .17472 -9 -9 ]
[.17539 .17472 9 0 ]
[.32696 .17472 -3 -9 ]
[.32696 .17472 3 0 ]
[.47854 .17472 -9 -9 ]
[.47854 .17472 9 0 ]
[.63011 .17472 -3 -9 ]
[.63011 .17472 3 0 ]
[.78169 .17472 -9 -9 ]
[.78169 .17472 9 0 ]
[.93327 .17472 -3 -9 ]
[.93327 .17472 3 0 ]
[.01131 .02078 -24 -4.5 ]
[.01131 .02078 0 4.5 ]
[.01131 .104 -24 -4.5 ]
[.01131 .104 0 4.5 ]
[.01131 .27044 -18 -4.5 ]
[.01131 .27044 0 4.5 ]
[.01131 .35366 -18 -4.5 ]
[.01131 .35366 0 4.5 ]
[.01131 .43688 -18 -4.5 ]
[.01131 .43688 0 4.5 ]
[.01131 .5201 -18 -4.5 ]
[.01131 .5201 0 4.5 ]
[.01131 .60332 -6 -4.5 ]
[.01131 .60332 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.17539 .18722 m
.17539 .19347 L
s
[(0.5)] .17539 .17472 0 1 Mshowa
.32696 .18722 m
.32696 .19347 L
s
[(1)] .32696 .17472 0 1 Mshowa
.47854 .18722 m
.47854 .19347 L
s
[(1.5)] .47854 .17472 0 1 Mshowa
.63011 .18722 m
.63011 .19347 L
s
[(2)] .63011 .17472 0 1 Mshowa
.78169 .18722 m
.78169 .19347 L
s
[(2.5)] .78169 .17472 0 1 Mshowa
.93327 .18722 m
.93327 .19347 L
s
[(3)] .93327 .17472 0 1 Mshowa
.125 Mabswid
.05412 .18722 m
.05412 .19097 L
s
.08444 .18722 m
.08444 .19097 L
s
.11476 .18722 m
.11476 .19097 L
s
.14507 .18722 m
.14507 .19097 L
s
.2057 .18722 m
.2057 .19097 L
s
.23602 .18722 m
.23602 .19097 L
s
.26633 .18722 m
.26633 .19097 L
s
.29665 .18722 m
.29665 .19097 L
s
.35728 .18722 m
.35728 .19097 L
s
.38759 .18722 m
.38759 .19097 L
s
.41791 .18722 m
.41791 .19097 L
s
.44822 .18722 m
.44822 .19097 L
s
.50885 .18722 m
.50885 .19097 L
s
.53917 .18722 m
.53917 .19097 L
s
.56948 .18722 m
.56948 .19097 L
s
.5998 .18722 m
.5998 .19097 L
s
.66043 .18722 m
.66043 .19097 L
s
.69074 .18722 m
.69074 .19097 L
s
.72106 .18722 m
.72106 .19097 L
s
.75138 .18722 m
.75138 .19097 L
s
.81201 .18722 m
.81201 .19097 L
s
.84232 .18722 m
.84232 .19097 L
s
.87264 .18722 m
.87264 .19097 L
s
.90295 .18722 m
.90295 .19097 L
s
.96358 .18722 m
.96358 .19097 L
s
.9939 .18722 m
.9939 .19097 L
s
.25 Mabswid
0 .18722 m
1 .18722 L
s
.02381 .02078 m
.03006 .02078 L
s
[(-0.4)] .01131 .02078 1 0 Mshowa
.02381 .104 m
.03006 .104 L
s
[(-0.2)] .01131 .104 1 0 Mshowa
.02381 .27044 m
.03006 .27044 L
s
[(0.2)] .01131 .27044 1 0 Mshowa
.02381 .35366 m
.03006 .35366 L
s
[(0.4)] .01131 .35366 1 0 Mshowa
.02381 .43688 m
.03006 .43688 L
s
[(0.6)] .01131 .43688 1 0 Mshowa
.02381 .5201 m
.03006 .5201 L
s
[(0.8)] .01131 .5201 1 0 Mshowa
.02381 .60332 m
.03006 .60332 L
s
[(1)] .01131 .60332 1 0 Mshowa
.125 Mabswid
.02381 .04158 m
.02756 .04158 L
s
.02381 .06239 m
.02756 .06239 L
s
.02381 .08319 m
.02756 .08319 L
s
.02381 .1248 m
.02756 .1248 L
s
.02381 .14561 m
.02756 .14561 L
s
.02381 .16641 m
.02756 .16641 L
s
.02381 .20802 m
.02756 .20802 L
s
.02381 .22883 m
.02756 .22883 L
s
.02381 .24963 m
.02756 .24963 L
s
.02381 .29124 m
.02756 .29124 L
s
.02381 .31205 m
.02756 .31205 L
s
.02381 .33285 m
.02756 .33285 L
s
.02381 .37446 m
.02756 .37446 L
s
.02381 .39527 m
.02756 .39527 L
s
.02381 .41607 m
.02756 .41607 L
s
.02381 .45768 m
.02756 .45768 L
s
.02381 .47849 m
.02756 .47849 L
s
.02381 .49929 m
.02756 .49929 L
s
.02381 .5409 m
.02756 .5409 L
s
.02381 .56171 m
.02756 .56171 L
s
.02381 .58251 m
.02756 .58251 L
s
.25 Mabswid
.02381 0 m
.02381 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .60332 m
.02499 .60325 L
.02605 .60305 L
.02729 .60267 L
.02846 .60217 L
.03053 .60092 L
.03279 .59904 L
.03527 .59636 L
.0379 .59283 L
.04262 .58471 L
.05205 .56194 L
.06244 .52758 L
.0842 .43057 L
.10458 .32166 L
.12312 .2214 L
.14335 .12514 L
.15431 .08327 L
.16449 .05264 L
.16949 .04076 L
.17421 .03157 L
.17682 .02734 L
.17965 .02345 L
.18203 .02073 L
.18458 .01837 L
.1859 .01739 L
.18715 .01659 L
.18837 .01596 L
.18949 .01548 L
.19056 .01514 L
.19169 .01489 L
.19283 .01474 L
.19408 .01472 L
.19474 .01476 L
.19543 .01484 L
.19667 .01509 L
.19736 .01529 L
.198 .01551 L
.19946 .01613 L
.20191 .01758 L
.20451 .01967 L
.21019 .02606 L
.21555 .0343 L
.22558 .05487 L
.24559 .11136 L
.26405 .1729 L
.2844 .23893 L
.29436 .26685 L
.30345 .28844 L
.30793 .29746 L
.31282 .30596 L
Mistroke
.31749 .31272 L
.32171 .31764 L
.32665 .32191 L
.32935 .32356 L
.33059 .32416 L
.3319 .32468 L
.33302 .32503 L
.33426 .32532 L
.33539 .3255 L
.33643 .32558 L
.33767 .32559 L
.3388 .32551 L
.3401 .32532 L
.34134 .32503 L
.34248 .32467 L
.34371 .32419 L
.34594 .32308 L
.34859 .32134 L
.35102 .31936 L
.35602 .31414 L
.36129 .30709 L
.37009 .29198 L
.37972 .27139 L
.42033 .16058 L
.4391 .11225 L
.44898 .09132 L
.45943 .0738 L
.46473 .06695 L
.46755 .06391 L
.47056 .06113 L
.47333 .05901 L
.47586 .05745 L
.4784 .05623 L
.48081 .05542 L
.48197 .05514 L
.48324 .05492 L
.48388 .05485 L
.48458 .0548 L
.48583 .05476 L
.48701 .05481 L
.48825 .05495 L
.48931 .05514 L
.49047 .05541 L
.49185 .05583 L
.4931 .05631 L
.49591 .05768 L
.49852 .05934 L
.50098 .06123 L
.51068 .0717 L
.51558 .0787 L
Mistroke
.52097 .08761 L
.53941 .12618 L
.57972 .23114 L
.59827 .27611 L
.61851 .31494 L
.62948 .33018 L
.63482 .33597 L
.63966 .34029 L
.64467 .34383 L
.64939 .3463 L
.65198 .3473 L
.65437 .34801 L
.65562 .34829 L
.65699 .34854 L
.65768 .34865 L
.65842 .34874 L
.65912 .3488 L
.65976 .34885 L
.66094 .3489 L
.66204 .3489 L
.66326 .34886 L
.66457 .34875 L
.66587 .34859 L
.66724 .34836 L
.66968 .34781 L
.67195 .34712 L
.67406 .34634 L
.67886 .34409 L
.68412 .3409 L
.6889 .33739 L
.69962 .32772 L
.73962 .27916 L
.77811 .23383 L
.798 .21636 L
.80815 .20934 L
.81905 .20318 L
.82929 .1986 L
.83864 .19533 L
.84804 .19281 L
.85696 .19101 L
.86658 .18961 L
.87195 .18903 L
.87682 .18861 L
.88138 .18829 L
.8863 .18801 L
.89061 .18782 L
.89522 .18765 L
.90016 .18752 L
.90476 .18743 L
.90757 .18739 L
Mistroke
.91023 .18735 L
.91521 .1873 L
.91776 .18729 L
.92047 .18727 L
.92281 .18726 L
.92532 .18725 L
.92802 .18724 L
.93054 .18723 L
.93355 .18723 L
.9363 .18723 L
.93879 .18722 L
.94106 .18722 L
.94231 .18722 L
.94367 .18722 L
.94485 .18722 L
.94613 .18722 L
.94845 .18722 L
.94971 .18722 L
.95089 .18722 L
.95198 .18722 L
.95301 .18722 L
.95419 .18722 L
.95527 .18722 L
.95646 .18722 L
.95777 .18722 L
.95843 .18722 L
.95914 .18722 L
.96043 .18722 L
.96164 .18722 L
.96291 .18722 L
.964 .18722 L
.96519 .18722 L
.96592 .18722 L
.96661 .18722 L
.9679 .18722 L
.96862 .18722 L
.96928 .18722 L
.97001 .18722 L
.97079 .18722 L
.97207 .18722 L
.97327 .18722 L
.97458 .18722 L
.97532 .18722 L
.97599 .18722 L
.97619 .18722 L
Mfstroke
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzdm/tvFUUUx++jpS2vUlBQHuXWJ6iACFWetVApimJiNPHnhpjAD0YDTUQF
jJoYX9G/xT/EZ2L8L5SHT9Bcu2eW2WX6memZO7u3xht6u/3uzPmeOXvmzDkz
y+m5+bOvvT43f+7MXOfk+bk3z547c6Ez+8b5BajdbDSanUaj8VWnkV13Fy7z
r+7Cv+5E9pUhvV9vkV/thhHaNT/Zd7ua+8PZr1Z2dwBaEtYGbKeV8pMRO5R3
Lzda+KxUytth5eW3b39+DIoXeNAORgTsUFL+kAu5k69lvvxsi+FBEP4QYNTu
++Dwhp0eMWwrAPsuyDZiTUgcDwI25Oco3GyV8nkQgWuA7Odbv58/ABh54Dcl
EaIjcS/V0bl1P2CrAfu6VhH3AbYWsOnsWzzg43RhU9aOxSz8yDUxDW4UsKPK
mfOhX+8JwNYBdtgqNwJ3P6iIQOHSkVRjgB1UevD76VQHfG4qpgwQdABbryRY
A9h7ro/RCDYA9qTSF6/EjaUmqu2A3QXYpNIrc6pwIiBL4IDvLql0N2D7lE/8
slFJuQxmPxQS+qsVxYwi/pF/kC5PKB/upZxWn61oU69xwDYBtjdOU4/VKBto
JWj1OGAbAXtX4WGLYHL9mhQrZuNKe0U+TvT3ALZb2e4dQ09xZxtg91ZEJeOj
sRDBLsA2A/Z2+lhqoiIRjwFG8i76qbYqRTyq7FsTFVnkLdcZqBGRPtIDAYot
Znv+8S6DAtGiLUmJyCF/H7B3KewWkikkjtm+40opE9aS6/0jd7HsQ9GX1jaq
RMgoFAypGKX1iXgphaGVnvTb5jzpfMxj9ViIclSql2gZoFJaayFK0slC5GiU
p4ymm2eF9Ut6fClGGbKSydxaUxRSKp035Oe1GEDheZTRkilIZ3+xXorYW3hy
pdhltX0s3igikHb2jbKK4wxTndHhpoEIshl6dMv7DHKLRk8joJqB9Byykr12
KOoSR5cCC0wBSmEoeNBWGrnTfDoVbfcRFqCiHJC2vWgENNILhkrqoq55GvIh
bkrv/dig61DyN+UEcXIBE1egKUs9tO2Ce+rVDaCowKuWXDXmGi77jGRflIdG
ETUzpGmuojyfwiotS5Rq0eYXBTnaMqDlkGaX8IoLkVbr/IOl9JwiBW0gPgzY
jPWyXemkFNp2AjZtSff0j7TY299bIhWAPIieGiUdVMUV2/H7/OOjvICOv2hv
gWrTQ4D1kZ627ffH0ZN/UkFM+w1PATaZTk91O+2sTNonfsB1LvJjLRVtSNGe
b5lUEfXoYFlLT9u8B+PoaXZSprQHMNq7PVQPPe17kkqH+0dPD+RIHD3FK3JR
es7k+WV68XeaWimkNNuP+sdMZQbFKy099Z2Ko6cR0KPZr/SWpw19yrFX1WpS
RJk2aiYehZGm5IfUjs4RaY07FtQ0fDxGFiL9KFukI9V4/bTHY6QBBRRqR8sr
JWPHg5pqj8xIA4q82iN3qnlnFN6pOkarWlkq2p8xCmiP1kglWk6oqqE0sgPY
CaMSxcCq6bcDNluiFzsQKSULtNF/BDDKe8ukzi0qGmk5oQKR6CnvPZlOT1tq
U4ARx7Nx9JSnUrlN9JQPPRdHT6sURcppwKgerICeFpJjgFFqcsr1d+0rOrR5
NAMYrWPP+8dM0YwWCQpPJwCj6ftCHD0FU1oHZ+uhlyJI9jZPKXucjiP4BDAK
oS+6rkLCPgVsre3xkl8zOpf6DLBVVtjLccI+tx1pukYK+wIw2ud9xYit5pVy
UuTL7Hs4Q141VInJHHH8HJRMb5iTlF+WlqJ7c5x8Myxc+5Z4vOTwG+EBefFv
fweEFVMyYHhybUparv5Pmos9yGgBmZRFXfuvNpcBkhWqU4HSuus9NQ9HwHZw
GgXEppdZ1QqXMZCRFSLbvvFTdntDoeLSGdOySHaqzbbvyQREFP5PjX71eygF
22VrTmvyb703964mCTLTmlNh8nvvzb3JW4JM5xa59x89NU8JeAGx6QGvWuGt
osGdIv8MigznTVRbhuVFjH+5hGs32aiM+MudBcRTbhQpUxHQby5XczLzLdce
JPNW7zIV6fjffWsuA6RG//hl0u53SnN+t0qu8jdoZN+odC60aLp0zVjkLzpU
cUdo+7SX6NOyLQf00uVHIz3QZ4O59rhfqnS5ruC/yzea/wL3iTx0\
\>"],ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-0.338866, -0.503927, \
0.0124008, 0.00903467}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell["\<\
Galindo-Pascual's definition of the coefficient d coincides with that of \
Goldberg, but they are different from Edmonds' due to a phase (-1)^(m+mp), or \
equivalently, they have opposite signs of \[Beta]. The complex exponentials \
are also different between Edmonds and Galindo-Pascual and (after correcting \
the mistake referred to above) we see that the difference is just the \
exchange of angles \[Alpha] and \[Gamma]. The exponentials of Goldberg \
coincide with those of Edmonds before correcting the mistake! Therefore, \
taking Galindo-Pascual as a reference we find that:
\tcalDEdmonds(\[Alpha], \[Beta], \[Gamma]) = calDGalindo(-\[Alpha], -\[Beta], \
-\[Gamma])
\tcalDGoldberg(\[Alpha], \[Beta], \[Gamma]) = calDGalindo(-\[Gamma], \
-\[Beta], -\[Alpha]) = DGalindo(\[Alpha], \[Beta], \[Gamma])^(-1)
That means that the three calD's are different!\
\>", "Text"],

Cell["\<\
d can be related to the Jacobi polynomials (interestingly, timings are very \
similar).\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dJacobi", "[", 
    RowBox[{"j_", ",", "mp_", ",", "m_"}], "]"}], "[", "\[Beta]_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "+", "mp"}], ")"}], "!"}], 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"j", "-", "mp"}], ")"}], "!"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"j", "+", "m"}], ")"}], "!"}]}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "m"}], ")"}], "!"}]}]}], "]"}], 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Beta]", "/", "2"}], "]"}], "^", 
    RowBox[{"(", 
     RowBox[{"m", "+", "mp"}], ")"}]}], 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"\[Beta]", "/", "2"}], "]"}], "^", 
    RowBox[{"(", 
     RowBox[{"mp", "-", "m"}], ")"}]}], 
   RowBox[{"JacobiP", "[", 
    RowBox[{
     RowBox[{"j", "-", "mp"}], ",", 
     RowBox[{"mp", "-", "m"}], ",", 
     RowBox[{"mp", "+", "m"}], ",", 
     RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dEdmonds", "[", 
     RowBox[{"3", ",", "1", ",", 
      RowBox[{"-", "3"}]}], "]"}], "[", "beta", "]"}], "/", 
   RowBox[{
    RowBox[{"dJacobi", "[", 
     RowBox[{"3", ",", "1", ",", 
      RowBox[{"-", "3"}]}], "]"}], "[", "beta", "]"}]}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData["1"], "Output"]
}, Open  ]],

Cell[TextData[{
 "The Clebsch-Gordan coefficients are also standarized. They can be given \
(and are actually computed by ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " in this way) in terms of a hypergeometric function:"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CG", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j1_", ",", "m1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j2_", ",", "m2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j3_", ",", "m3_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"j1", "+", "m2", "-", "j3"}], ")"}]}], 
   RowBox[{
    RowBox[{"W", "[", 
     RowBox[{
      RowBox[{"j3", "-", "m3"}], ",", 
      RowBox[{"j2", "-", "m2"}], ",", 
      RowBox[{"j1", "-", "m1"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"j1", "+", "m1", "-", "j2", "+", "m2"}], ",", 
     RowBox[{
      RowBox[{"-", "j1"}], "+", "m1", "+", "j2", "+", "m2"}]}], 
    "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", 
    RowBox[{"m_", ",", "n1_", ",", "n2_"}], "]"}], "[", 
   RowBox[{"k1_", ",", "k2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "^", "m"}], " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n1", "+", "n2"}], ")"}], "!"}], "/", 
    RowBox[{"Gamma", "[", 
     RowBox[{"1", "+", "k2"}], "]"}]}], 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "k1", "+", "k2", "+", "1"}], ")"}], 
     RowBox[{"Gamma", "[", 
      RowBox[{"m", "+", "k1", "+", "k2", "+", "1"}], "]"}], 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{"m", "+", "k2", "+", "1"}], "]"}], "/", 
          RowBox[{"n1", "!"}]}], "/", 
         RowBox[{"n2", "!"}]}], "/", 
        RowBox[{"m", "!"}]}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n1", "+", "n2", "-", "m"}], ")"}], "!"}]}], "/", 
      RowBox[{"Gamma", "[", 
       RowBox[{"m", "+", "k1", "+", "1"}], "]"}]}]}], "]"}], 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"Gamma", "[", 
      RowBox[{"n1", "+", "k1", "+", "1"}], "]"}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"n2", "+", "k2", "+", "1"}], "]"}], "/", 
      RowBox[{"Gamma", "[", 
       RowBox[{"n1", "+", "n2", "+", "m", "+", "k1", "+", "k2", "+", "2"}], 
       "]"}]}]}], "]"}], 
   RowBox[{"HypergeometricPFQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "m"}], ",", 
       RowBox[{"m", "+", "k1", "+", "k2", "+", "1"}], ",", 
       RowBox[{"-", "n2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "k2"}], ",", 
       RowBox[{
        RowBox[{"-", "n1"}], "-", "n2"}]}], "}"}], ",", "1"}], 
    "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"j1", "=", "4"}], ",", 
     RowBox[{"m1", "=", 
      RowBox[{"-", "3"}]}], ",", 
     RowBox[{"j2", "=", "5"}], ",", 
     RowBox[{"m2", "=", "2"}], ",", 
     RowBox[{"j3", "=", "7"}], ",", 
     RowBox[{"m3", "=", 
      RowBox[{"-", "1"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ClebschGordan", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j1", ",", "m1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j2", ",", "m2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j3", ",", "m3"}], "}"}]}], "]"}], ",", 
     RowBox[{"CG", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j1", ",", "m1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j2", ",", "m2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j3", ",", "m3"}], "}"}]}], "]"}]}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["35", 
    SqrtBox["4862"]], ",", 
   FractionBox["35", 
    SqrtBox["4862"]]}], "}"}]], "Output"]
}, Open  ]],

Cell["This expression allows us to find a limit for large j1+j2:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Lp", "=", "4"}], ",", 
      RowBox[{"m1", "=", "2"}], ",", 
      RowBox[{"m2", "=", 
       RowBox[{"-", "4"}]}], ",", 
      RowBox[{"lpp", "=", "5"}], ",", 
      RowBox[{"m3", "=", 
       RowBox[{"-", "2"}]}], ",", 
      RowBox[{"lower", "=", "7"}], ",", 
      RowBox[{"upper", "=", "1000"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"nums", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ClebschGordan", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "+", "Lp", "+", "lpp"}], ")"}], "/", "2"}], ",", 
            "m1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "Lp", "+", "lpp"}], ")"}], "/", "2"}], ",", 
            "m2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lpp", ",", "m3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "lower", ",", "upper", ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"approx", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"L", "-", "Lp", "+", "lpp"}], ")"}], "/", "2"}], "+", 
            "m2"}], ")"}]}], 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "lpp"}], "+", "1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"L", "+", "lpp", "+", "1"}], ")"}]}], "]"}], 
         RowBox[{
          RowBox[{"dJacobi", "[", 
           RowBox[{"lpp", ",", "Lp", ",", 
            RowBox[{"m1", "+", "m2"}]}], "]"}], "[", 
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m1", "-", "m2"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"L", "+", "lpp", "+", "1"}], ")"}]}], "]"}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "lower", ",", "upper", ",", "2"}], "}"}]}], 
       "]"}]}]}]}], "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"nums", "/", "approx"}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.0238095 0.00191626 -780.431 780.657 [
[.21544 .21296 -9 -9 ]
[.21544 .21296 9 0 ]
[.40706 .21296 -9 -9 ]
[.40706 .21296 9 0 ]
[.59869 .21296 -9 -9 ]
[.59869 .21296 9 0 ]
[.79031 .21296 -9 -9 ]
[.79031 .21296 9 0 ]
[.98194 .21296 -9 -9 ]
[.98194 .21296 9 0 ]
[.01131 .06933 -36 -4.5 ]
[.01131 .06933 0 4.5 ]
[.01131 .1474 -36 -4.5 ]
[.01131 .1474 0 4.5 ]
[.01131 .30353 -36 -4.5 ]
[.01131 .30353 0 4.5 ]
[.01131 .38159 -36 -4.5 ]
[.01131 .38159 0 4.5 ]
[.01131 .45966 -36 -4.5 ]
[.01131 .45966 0 4.5 ]
[.01131 .53772 -36 -4.5 ]
[.01131 .53772 0 4.5 ]
[.01131 .61579 -36 -4.5 ]
[.01131 .61579 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.21544 .22546 m
.21544 .23171 L
s
[(100)] .21544 .21296 0 1 Mshowa
.40706 .22546 m
.40706 .23171 L
s
[(200)] .40706 .21296 0 1 Mshowa
.59869 .22546 m
.59869 .23171 L
s
[(300)] .59869 .21296 0 1 Mshowa
.79031 .22546 m
.79031 .23171 L
s
[(400)] .79031 .21296 0 1 Mshowa
.98194 .22546 m
.98194 .23171 L
s
[(500)] .98194 .21296 0 1 Mshowa
.125 Mabswid
.06213 .22546 m
.06213 .22921 L
s
.10046 .22546 m
.10046 .22921 L
s
.13879 .22546 m
.13879 .22921 L
s
.17711 .22546 m
.17711 .22921 L
s
.25376 .22546 m
.25376 .22921 L
s
.29209 .22546 m
.29209 .22921 L
s
.33041 .22546 m
.33041 .22921 L
s
.36874 .22546 m
.36874 .22921 L
s
.44539 .22546 m
.44539 .22921 L
s
.48371 .22546 m
.48371 .22921 L
s
.52204 .22546 m
.52204 .22921 L
s
.56036 .22546 m
.56036 .22921 L
s
.63701 .22546 m
.63701 .22921 L
s
.67534 .22546 m
.67534 .22921 L
s
.71366 .22546 m
.71366 .22921 L
s
.75199 .22546 m
.75199 .22921 L
s
.82864 .22546 m
.82864 .22921 L
s
.86696 .22546 m
.86696 .22921 L
s
.90529 .22546 m
.90529 .22921 L
s
.94361 .22546 m
.94361 .22921 L
s
.25 Mabswid
0 .22546 m
1 .22546 L
s
.02381 .06933 m
.03006 .06933 L
s
[(0.9998)] .01131 .06933 1 0 Mshowa
.02381 .1474 m
.03006 .1474 L
s
[(0.9999)] .01131 .1474 1 0 Mshowa
.02381 .30353 m
.03006 .30353 L
s
[(1.0001)] .01131 .30353 1 0 Mshowa
.02381 .38159 m
.03006 .38159 L
s
[(1.0002)] .01131 .38159 1 0 Mshowa
.02381 .45966 m
.03006 .45966 L
s
[(1.0003)] .01131 .45966 1 0 Mshowa
.02381 .53772 m
.03006 .53772 L
s
[(1.0004)] .01131 .53772 1 0 Mshowa
.02381 .61579 m
.03006 .61579 L
s
[(1.0005)] .01131 .61579 1 0 Mshowa
.125 Mabswid
.02381 .08494 m
.02756 .08494 L
s
.02381 .10056 m
.02756 .10056 L
s
.02381 .11617 m
.02756 .11617 L
s
.02381 .13178 m
.02756 .13178 L
s
.02381 .16301 m
.02756 .16301 L
s
.02381 .17862 m
.02756 .17862 L
s
.02381 .19424 m
.02756 .19424 L
s
.02381 .20985 m
.02756 .20985 L
s
.02381 .24108 m
.02756 .24108 L
s
.02381 .25669 m
.02756 .25669 L
s
.02381 .2723 m
.02756 .2723 L
s
.02381 .28791 m
.02756 .28791 L
s
.02381 .31914 m
.02756 .31914 L
s
.02381 .33475 m
.02756 .33475 L
s
.02381 .35037 m
.02756 .35037 L
s
.02381 .36598 m
.02756 .36598 L
s
.02381 .39721 m
.02756 .39721 L
s
.02381 .41282 m
.02756 .41282 L
s
.02381 .42843 m
.02756 .42843 L
s
.02381 .44405 m
.02756 .44405 L
s
.02381 .47527 m
.02756 .47527 L
s
.02381 .49089 m
.02756 .49089 L
s
.02381 .5065 m
.02756 .5065 L
s
.02381 .52211 m
.02756 .52211 L
s
.02381 .55334 m
.02756 .55334 L
s
.02381 .56895 m
.02756 .56895 L
s
.02381 .58456 m
.02756 .58456 L
s
.02381 .60018 m
.02756 .60018 L
s
.02381 .05372 m
.02756 .05372 L
s
.02381 .0381 m
.02756 .0381 L
s
.02381 .02249 m
.02756 .02249 L
s
.02381 .00688 m
.02756 .00688 L
s
.25 Mabswid
.02381 0 m
.02381 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.008 w
.04297 .26888 Mdot
.13304 .61214 Mdot
.13495 .6015 Mdot
.13687 .59129 Mdot
.13879 .58147 Mdot
.1407 .57204 Mdot
.14262 .56297 Mdot
.14453 .55424 Mdot
.14645 .54584 Mdot
.14837 .53776 Mdot
.15028 .52996 Mdot
.1522 .52245 Mdot
.15412 .51522 Mdot
.15603 .50823 Mdot
.15795 .5015 Mdot
.15986 .49499 Mdot
.16178 .48872 Mdot
.1637 .48265 Mdot
.16561 .47679 Mdot
.16753 .47112 Mdot
.16945 .46565 Mdot
.17136 .46035 Mdot
.17328 .45522 Mdot
.17519 .45025 Mdot
.17711 .44545 Mdot
.17903 .44079 Mdot
.18094 .43628 Mdot
.18286 .43191 Mdot
.18478 .42767 Mdot
.18669 .42356 Mdot
.18861 .41957 Mdot
.19052 .4157 Mdot
.19244 .41195 Mdot
.19436 .4083 Mdot
.19627 .40476 Mdot
.19819 .40131 Mdot
.20011 .39797 Mdot
.20202 .39472 Mdot
.20394 .39156 Mdot
.20585 .38849 Mdot
.20777 .3855 Mdot
.20969 .38259 Mdot
.2116 .37976 Mdot
.21352 .37701 Mdot
.21544 .37433 Mdot
.21735 .37171 Mdot
.21927 .36917 Mdot
.22118 .36669 Mdot
.2231 .36428 Mdot
.22502 .36192 Mdot
.22693 .35963 Mdot
.22885 .35739 Mdot
.23077 .3552 Mdot
.23268 .35307 Mdot
.2346 .351 Mdot
.23651 .34897 Mdot
.23843 .34699 Mdot
.24035 .34506 Mdot
.24226 .34317 Mdot
.24418 .34133 Mdot
.2461 .33953 Mdot
.24801 .33777 Mdot
.24993 .33605 Mdot
.25184 .33437 Mdot
.25376 .33273 Mdot
.25568 .33113 Mdot
.25759 .32956 Mdot
.25951 .32802 Mdot
.26143 .32652 Mdot
.26334 .32505 Mdot
.26526 .32361 Mdot
.26717 .32221 Mdot
.26909 .32083 Mdot
.27101 .31949 Mdot
.27292 .31817 Mdot
.27484 .31687 Mdot
.27676 .31561 Mdot
.27867 .31437 Mdot
.28059 .31316 Mdot
.2825 .31197 Mdot
.28442 .3108 Mdot
.28634 .30966 Mdot
.28825 .30854 Mdot
.29017 .30745 Mdot
.29209 .30637 Mdot
.294 .30532 Mdot
.29592 .30428 Mdot
.29783 .30327 Mdot
.29975 .30227 Mdot
.30167 .3013 Mdot
.30358 .30034 Mdot
.3055 .2994 Mdot
.30742 .29848 Mdot
.30933 .29757 Mdot
.31125 .29669 Mdot
.31316 .29581 Mdot
.31508 .29496 Mdot
.317 .29412 Mdot
.31891 .29329 Mdot
.32083 .29248 Mdot
.32275 .29169 Mdot
.32466 .2909 Mdot
.32658 .29013 Mdot
.32849 .28938 Mdot
.33041 .28864 Mdot
.33233 .28791 Mdot
.33424 .28719 Mdot
.33616 .28649 Mdot
.33808 .2858 Mdot
.33999 .28512 Mdot
.34191 .28445 Mdot
.34382 .28379 Mdot
.34574 .28314 Mdot
.34766 .2825 Mdot
.34957 .28188 Mdot
.35149 .28126 Mdot
.35341 .28066 Mdot
.35532 .28006 Mdot
.35724 .27947 Mdot
.35915 .2789 Mdot
.36107 .27833 Mdot
.36299 .27777 Mdot
.3649 .27722 Mdot
.36682 .27668 Mdot
.36874 .27615 Mdot
.37065 .27562 Mdot
.37257 .27511 Mdot
.37449 .2746 Mdot
.3764 .2741 Mdot
.37832 .2736 Mdot
.38023 .27312 Mdot
.38215 .27264 Mdot
.38407 .27217 Mdot
.38598 .2717 Mdot
.3879 .27124 Mdot
.38982 .27079 Mdot
.39173 .27035 Mdot
.39365 .26991 Mdot
.39556 .26948 Mdot
.39748 .26906 Mdot
.3994 .26864 Mdot
.40131 .26822 Mdot
.40323 .26782 Mdot
.40515 .26742 Mdot
.40706 .26702 Mdot
.40898 .26663 Mdot
.41089 .26625 Mdot
.41281 .26587 Mdot
.41473 .26549 Mdot
.41664 .26512 Mdot
.41856 .26476 Mdot
.42048 .2644 Mdot
.42239 .26405 Mdot
.42431 .2637 Mdot
.42622 .26335 Mdot
.42814 .26301 Mdot
.43006 .26268 Mdot
.43197 .26235 Mdot
.43389 .26202 Mdot
.43581 .2617 Mdot
.43772 .26138 Mdot
.43964 .26107 Mdot
.44155 .26076 Mdot
.44347 .26045 Mdot
.44539 .26015 Mdot
.4473 .25985 Mdot
.44922 .25956 Mdot
.45114 .25927 Mdot
.45305 .25898 Mdot
.45497 .2587 Mdot
.45688 .25842 Mdot
.4588 .25815 Mdot
.46072 .25787 Mdot
.46263 .2576 Mdot
.46455 .25734 Mdot
.46647 .25708 Mdot
.46838 .25682 Mdot
.4703 .25656 Mdot
.47221 .25631 Mdot
.47413 .25606 Mdot
.47605 .25581 Mdot
.47796 .25557 Mdot
.47988 .25533 Mdot
.4818 .25509 Mdot
.48371 .25485 Mdot
.48563 .25462 Mdot
.48754 .25439 Mdot
.48946 .25417 Mdot
.49138 .25394 Mdot
.49329 .25372 Mdot
.49521 .2535 Mdot
.49713 .25328 Mdot
.49904 .25307 Mdot
.50096 .25286 Mdot
.50287 .25265 Mdot
.50479 .25244 Mdot
.50671 .25224 Mdot
.50862 .25204 Mdot
.51054 .25184 Mdot
.51246 .25164 Mdot
.51437 .25144 Mdot
.51629 .25125 Mdot
.5182 .25106 Mdot
.52012 .25087 Mdot
.52204 .25068 Mdot
.52395 .2505 Mdot
.52587 .25031 Mdot
.52779 .25013 Mdot
.5297 .24996 Mdot
.53162 .24978 Mdot
.53353 .2496 Mdot
.53545 .24943 Mdot
.53737 .24926 Mdot
.53928 .24909 Mdot
.5412 .24892 Mdot
.54312 .24876 Mdot
.54503 .24859 Mdot
.54695 .24843 Mdot
.54886 .24827 Mdot
.55078 .24811 Mdot
.5527 .24795 Mdot
.55461 .2478 Mdot
.55653 .24764 Mdot
.55845 .24749 Mdot
.56036 .24734 Mdot
.56228 .24719 Mdot
.56419 .24704 Mdot
.56611 .2469 Mdot
.56803 .24675 Mdot
.56994 .24661 Mdot
.57186 .24647 Mdot
.57378 .24632 Mdot
.57569 .24619 Mdot
.57761 .24605 Mdot
.57952 .24591 Mdot
.58144 .24578 Mdot
.58336 .24564 Mdot
.58527 .24551 Mdot
.58719 .24538 Mdot
.58911 .24525 Mdot
.59102 .24512 Mdot
.59294 .24499 Mdot
.59485 .24487 Mdot
.59677 .24474 Mdot
.59869 .24462 Mdot
.6006 .2445 Mdot
.60252 .24438 Mdot
.60444 .24426 Mdot
.60635 .24414 Mdot
.60827 .24402 Mdot
.61018 .2439 Mdot
.6121 .24379 Mdot
.61402 .24367 Mdot
.61593 .24356 Mdot
.61785 .24345 Mdot
.61977 .24333 Mdot
.62168 .24322 Mdot
.6236 .24311 Mdot
.62551 .24301 Mdot
.62743 .2429 Mdot
.62935 .24279 Mdot
.63126 .24269 Mdot
.63318 .24258 Mdot
.6351 .24248 Mdot
.63701 .24238 Mdot
.63893 .24227 Mdot
.64085 .24217 Mdot
.64276 .24207 Mdot
.64468 .24197 Mdot
.64659 .24188 Mdot
.64851 .24178 Mdot
.65043 .24168 Mdot
.65234 .24159 Mdot
.65426 .24149 Mdot
.65618 .2414 Mdot
.65809 .24131 Mdot
.66001 .24121 Mdot
.66192 .24112 Mdot
.66384 .24103 Mdot
.66576 .24094 Mdot
.66767 .24085 Mdot
.66959 .24077 Mdot
.67151 .24068 Mdot
.67342 .24059 Mdot
.67534 .24051 Mdot
.67725 .24042 Mdot
.67917 .24034 Mdot
.68109 .24025 Mdot
.683 .24017 Mdot
.68492 .24009 Mdot
.68684 .24 Mdot
.68875 .23992 Mdot
.69067 .23984 Mdot
.69258 .23976 Mdot
.6945 .23968 Mdot
.69642 .23961 Mdot
.69833 .23953 Mdot
.70025 .23945 Mdot
.70217 .23937 Mdot
.70408 .2393 Mdot
.706 .23922 Mdot
.70791 .23915 Mdot
.70983 .23907 Mdot
.71175 .239 Mdot
.71366 .23893 Mdot
.71558 .23886 Mdot
.7175 .23878 Mdot
.71941 .23871 Mdot
.72133 .23864 Mdot
.72324 .23857 Mdot
.72516 .2385 Mdot
.72708 .23843 Mdot
.72899 .23837 Mdot
.73091 .2383 Mdot
.73283 .23823 Mdot
.73474 .23816 Mdot
.73666 .2381 Mdot
.73857 .23803 Mdot
.74049 .23797 Mdot
.74241 .2379 Mdot
.74432 .23784 Mdot
.74624 .23777 Mdot
.74816 .23771 Mdot
.75007 .23765 Mdot
.75199 .23759 Mdot
.7539 .23752 Mdot
.75582 .23746 Mdot
.75774 .2374 Mdot
.75965 .23734 Mdot
.76157 .23728 Mdot
.76349 .23722 Mdot
.7654 .23716 Mdot
.76732 .23711 Mdot
.76923 .23705 Mdot
.77115 .23699 Mdot
.77307 .23693 Mdot
.77498 .23688 Mdot
.7769 .23682 Mdot
.77882 .23676 Mdot
.78073 .23671 Mdot
.78265 .23665 Mdot
.78456 .2366 Mdot
.78648 .23654 Mdot
.7884 .23649 Mdot
.79031 .23644 Mdot
.79223 .23638 Mdot
.79415 .23633 Mdot
.79606 .23628 Mdot
.79798 .23623 Mdot
.79989 .23617 Mdot
.80181 .23612 Mdot
.80373 .23607 Mdot
.80564 .23602 Mdot
.80756 .23597 Mdot
.80948 .23592 Mdot
.81139 .23587 Mdot
.81331 .23582 Mdot
.81522 .23577 Mdot
.81714 .23573 Mdot
.81906 .23568 Mdot
.82097 .23563 Mdot
.82289 .23558 Mdot
.82481 .23553 Mdot
.82672 .23549 Mdot
.82864 .23544 Mdot
.83055 .2354 Mdot
.83247 .23535 Mdot
.83439 .2353 Mdot
.8363 .23526 Mdot
.83822 .23521 Mdot
.84014 .23517 Mdot
.84205 .23513 Mdot
.84397 .23508 Mdot
.84588 .23504 Mdot
.8478 .23499 Mdot
.84972 .23495 Mdot
.85163 .23491 Mdot
.85355 .23487 Mdot
.85547 .23482 Mdot
.85738 .23478 Mdot
.8593 .23474 Mdot
.86121 .2347 Mdot
.86313 .23466 Mdot
.86505 .23462 Mdot
.86696 .23458 Mdot
.86888 .23454 Mdot
.8708 .2345 Mdot
.87271 .23446 Mdot
.87463 .23442 Mdot
.87654 .23438 Mdot
.87846 .23434 Mdot
.88038 .2343 Mdot
.88229 .23426 Mdot
.88421 .23422 Mdot
.88613 .23419 Mdot
.88804 .23415 Mdot
.88996 .23411 Mdot
.89188 .23407 Mdot
.89379 .23404 Mdot
.89571 .234 Mdot
.89762 .23396 Mdot
.89954 .23393 Mdot
.90146 .23389 Mdot
.90337 .23385 Mdot
.90529 .23382 Mdot
.90721 .23378 Mdot
.90912 .23375 Mdot
.91104 .23371 Mdot
.91295 .23368 Mdot
.91487 .23364 Mdot
.91679 .23361 Mdot
.9187 .23358 Mdot
.92062 .23354 Mdot
.92254 .23351 Mdot
.92445 .23348 Mdot
.92637 .23344 Mdot
.92828 .23341 Mdot
.9302 .23338 Mdot
.93212 .23334 Mdot
.93403 .23331 Mdot
.93595 .23328 Mdot
.93787 .23325 Mdot
.93978 .23322 Mdot
.9417 .23318 Mdot
.94361 .23315 Mdot
.94553 .23312 Mdot
.94745 .23309 Mdot
.94936 .23306 Mdot
.95128 .23303 Mdot
.9532 .233 Mdot
.95511 .23297 Mdot
.95703 .23294 Mdot
.95894 .23291 Mdot
.96086 .23288 Mdot
.96278 .23285 Mdot
.96469 .23282 Mdot
.96661 .23279 Mdot
.96853 .23276 Mdot
.97044 .23273 Mdot
.97236 .2327 Mdot
.97427 .23267 Mdot
.97619 .23265 Mdot
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 
  1}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztW0lrFEEU7pmeiRMDevDgEmN6kjGJRomIoigGFImg6MGL3mSIQiKKkuTg
yYNHPXnyIuJBEAQRRVFxA437rnH3dxgQNKZqOtU9xfeqt6qeSTCESvHVV+99
/erV6+6ayc7yyMCBw+WRwf6ys22ofHRgsH/Y6TsyNAnZGcvKOJZlXXUs1p+Y
7LrNxOTvRJE1DDHb7+R/bKvimI9Yv8INZdnAeGIzM8FDSDNZwc0BEh/lkA16
OTE3Tztwx/wj7KcJzLBJLCfPz1Ji60KEP/aE60ZlZO0EkS2oxCaEUY7UpRpv
GWZXJzjZy2vcezOhftS2tHg906UlGDNdV0Iq0FNUvMI9HbZxfamZtkWlxNqc
yAFJZFE52qa8wHZltko+bMqKTUvv4G2+CptKA+XCVptZQu60sHnh6EiuNj1X
U4yuJcN6mUpPSpxOPaJaqVQILbQ9Roir/bWwNh99XWJ4xgE1k72OxhXybbiw
19uK4Rj7x44+L2s8ujF2k3YLcn2KGd9EFU4R6VLMxdNSNLUYKcbMfb1h9dXb
4Hum+s6r8b5M3vsV9+VEDy3c6282kKe5DQCblQIvDR//NaswmA4rALYyAdYl
Mn8qzd3BAq3hFmt7GDLXR+Jb5RzrNbNeLz3/FGvnMWQvTTrO2jkMOUiThlnb
xJBjspJDrNfIeifo+ftZW2DISZq0j7UNDDntJ+EbLr8iPnRGVrRHhPos7Wy3
IJ2nSbsE6QJN2iFIF2Ul21mPsy/R8/sE6bJ7dV6CsB9faQT3BbIk20IWesXc
KpxeqThDDirbw8ALLnK2RSi/VitF3Ptm0bteJ5HpFWt1o04UbRIxuulOzVWl
rOWeDWk5MyGP5TYKFbfpuBSUmwSZ9VJhg+jdobfvekG6S5PWAcxP5/MR6R5t
cy3A7tP0NQB7QNNXC1kPZZ3e0CN6/ipBGg0gSZjCZg/ARmV1iPSYtonu1U/c
/EuhDqPHjKd0NmvZ5eiFEG2EbnENzw0rQoa9CKIYPTOsKGwl7K6BNrRWaE2X
A8xdSZP1OlwwlwHsBR04dRlHJ+Do6l0HqA50AewlTffqzesAkoS98tHJ13OF
zY5o9KUAexOfzhUj0lvaZikaHR0lvItPD/qsog1g793E1VL/1Q8bCveG63+o
XVoE2AfD8sjy5p1Dpawo1Ncjal7uHYB9dI3UvNwrxOkp9yhTXQcRDw1bATbm
o3N36HrGYrlDHxV+ik8PqnctAPscS3iQpSAliwH2xc0hLZWXfLlLeQOHfZZU
BESXtrwMe6gXt3G9PhugTwu/hyCnzQD7anjNZG1UPk19ccRMgVXfeCLGJclJ
iGIbLwLYN5quKChBloKULATY91hKgiwl+IrNAoD9CGeJe0XSgufrKaihviVX
8+eg+QD7WSttJgqq4pj0bxqeJMOuT6PPmNBj9CLnncX9qZjgk1L6PwMr8w+e
6Zmm\
\>"],ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-81.8767, 0.999662, \
2.09309, 5.13786}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Unit sphere", "Subsection"],

Cell[CellGroupData[{

Cell["3.0. Unit sphere", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DefUnitSphere", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "manifold_Symbol", ",", "dim_Integer", ",", "indices_List", ",", 
       "manifoldoptions___"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"metric_Symbol", ",", "covd_Symbol", ",", "metricoptions___"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "chart_Symbol", ",", "cnumbers_List", ",", "scalars_List", ",", 
       "chartoptions___"}], "}"}]}], "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "=!=", "2"}], ",", 
        RowBox[{"Throw", "@", 
         RowBox[{"Message", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "indices", "]"}], "<", "3"}], ",", 
        RowBox[{"Throw", "@", 
         RowBox[{"Message", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "=", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"b", "=", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"c", "=", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"theta", "=", 
           RowBox[{"scalars", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Define", " ", "geometric", " ", "structures"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DefManifold", "[", 
          RowBox[{
          "manifold", ",", "dim", ",", "indices", ",", "manifoldoptions"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"DefChart", "[", 
          RowBox[{
          "chart", ",", "manifold", ",", "cnumbers", ",", "scalars", ",", 
           "chartoptions"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"DefMetric", "[", 
          RowBox[{"1", ",", 
           RowBox[{"metric", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], ",", "covd", ",", "metricoptions"}],
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rs", "=", 
             RowBox[{"GiveSymbol", "[", 
              RowBox[{"RicciScalar", ",", "covd"}], "]"}]}], "}"}], ",", 
           RowBox[{"Set", "[", 
            RowBox[{
             RowBox[{"rs", "[", "]"}], ",", "2"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Unit", " ", "metric"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"$CVVerbose", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"metricvalues", "=", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"theta", "[", "]"}], "]"}], "^", "2"}]}], "}"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"MetricInBasis", "[", 
          RowBox[{"metric", ",", 
           RowBox[{"-", "chart"}], ",", "metricvalues"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricInBasis", "[", 
          RowBox[{"metric", ",", "chart", ",", 
           RowBox[{"Inverse", "[", "metricvalues", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ComponentValue", "[", 
          RowBox[{
           RowBox[{"Determinant", "[", 
            RowBox[{
             RowBox[{"metric", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "b"}]}], "]"}], ",", "chart"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"Det", "[", "metricvalues", "]"}], "]"}], "//", 
            "PowerExpand"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Remove", "[", "metricvalues", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"$BMUseValues", "=", "All"}], ";", "\[IndentingNewLine]", 
         RowBox[{"$TUseValues", "=", "All"}], ";", "\[IndentingNewLine]", 
         RowBox[{"$CVSimplify", "=", "Simplify"}], ";", "\[IndentingNewLine]", 
         RowBox[{"$CCSimplify", "=", "Simplify"}], ";", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"eps", "=", 
              RowBox[{"GiveSymbol", "[", 
               RowBox[{"epsilon", ",", "metric"}], "]"}]}], ",", 
             RowBox[{"det", "=", 
              RowBox[{"GiveSymbol", "[", 
               RowBox[{"Det", ",", "metric", ",", "chart"}], "]"}]}]}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ComponentValue", "[", 
             RowBox[{
              RowBox[{"ComponentArray", "[", 
               RowBox[{"eps", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "chart"}], ",", 
                  RowBox[{"-", "chart"}]}], "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"$epsilonSign", " ", 
                RowBox[{"det", "[", "]"}], 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "//", 
               "ToValues"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ChangeComponents", "[", 
             RowBox[{
              RowBox[{"eps", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "chart"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "chart"}], "}"}]}], "]"}], ",", 
              RowBox[{"eps", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{"-", "chart"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "b"}], ",", 
                  RowBox[{"-", "chart"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AllComponentValues", "[", 
          RowBox[{
           RowBox[{"Christoffel", "[", 
            RowBox[{"cd", ",", "PDspherical"}], "]"}], "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "chart"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", 
              RowBox[{"-", "chart"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "c"}], ",", 
              RowBox[{"-", "chart"}]}], "}"}]}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"metric", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "chart"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", 
              RowBox[{"-", "chart"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"SeparateBasis", "[", "AIndex", "]"}], "[", "tmp", "]"}], 
           "-", "tmp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{"covd", "[", 
            RowBox[{"-", "c"}], "]"}], "[", "tmp", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{"tmp", "//", "ContractMetric"}], "//", "ContractBasis"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", "//", 
           RowBox[{"ToBasis", "[", "chart", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ComponentArray", "[", "tmp", "]"}], "//", "ToValues"}], "//",
            "Flatten"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[Equal]", "0"}], "&"}], ",", "tmp"}], "]"}], 
            ",", 
            RowBox[{"First", "/@", 
             RowBox[{"Last", "[", 
              RowBox[{"TensorValues", "[", 
               RowBox[{"GiveSymbol", "[", 
                RowBox[{"Christoffel", ",", "covd", ",", 
                 RowBox[{"GiveSymbol", "[", 
                  RowBox[{"PD", ",", "chart"}], "]"}]}], "]"}], "]"}], 
              "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Rule", "\[Rule]", "ComponentValue"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ChangeComponents", "[", 
          RowBox[{
           RowBox[{"ChristoffelcdPDspherical", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "spherical"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "b"}], ",", 
               RowBox[{"-", "spherical"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "c"}], ",", 
               RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"ChristoffelcdPDspherical", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "spherical"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "b"}], ",", 
               RowBox[{"-", "spherical"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "c"}], ",", 
               RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"identity", ",", "Orderless"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"identity", "[", 
           RowBox[{"a_Symbol", ",", 
            RowBox[{"-", "b_Symbol"}]}], "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"Basis", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
            RowBox[{"Basis", "[", 
             RowBox[{
              RowBox[{"-", "b"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "spherical"}], "}"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Basis", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
            RowBox[{"Basis", "[", 
             RowBox[{
              RowBox[{"-", "b"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "spherical"}], "}"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Basis", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
            RowBox[{"Basis", "[", 
             RowBox[{
              RowBox[{"-", "b"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "spherical"}], "}"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"DefTensor", "[", 
          RowBox[{
           RowBox[{"m", "[", "a", "]"}], ",", "S2"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"DefTensor", "[", 
          RowBox[{
           RowBox[{"mbar", "[", "a", "]"}], ",", "S2", ",", 
           RowBox[{"PrintAs", "\[Rule]", "\"\<mb\>\""}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"m", "/:", 
          RowBox[{
           RowBox[{"m", "[", "a_", "]"}], 
           RowBox[{"m", "[", 
            RowBox[{"-", "a_"}], "]"}]}], ":=", "0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mbar", "/:", 
          RowBox[{
           RowBox[{"mbar", "[", "a_", "]"}], 
           RowBox[{"mbar", "[", 
            RowBox[{"-", "a_"}], "]"}]}], ":=", "0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mbar", "/:", 
          RowBox[{
           RowBox[{"m", "[", "a_", "]"}], 
           RowBox[{"mbar", "[", 
            RowBox[{"-", "a_"}], "]"}]}], ":=", "1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"m", "/:", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"-", "a_"}], "]"}], 
           RowBox[{"mbar", "[", "a_", "]"}]}], ":=", "1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ComponentValue", "[", 
          RowBox[{
           RowBox[{"ComponentArray", "[", 
            RowBox[{"m", "[", 
             RowBox[{"{", 
              RowBox[{"a", ",", "spherical"}], "}"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"I", " ", 
              RowBox[{
               RowBox[{"Csc", "[", 
                RowBox[{"\[Theta]", "[", "]"}], "]"}], "/", "2"}]}]}], 
            "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ChangeComponents", "[", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "spherical"}]}], "}"}], "]"}], ",", 
           RowBox[{"m", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "spherical"}], "}"}], "]"}]}], "]"}], ";", 
         RowBox[{"ComponentValue", "[", 
          RowBox[{
           RowBox[{"ComponentArray", "[", 
            RowBox[{"mbar", "[", 
             RowBox[{"{", 
              RowBox[{"a", ",", "spherical"}], "}"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "I"}], " ", 
              RowBox[{
               RowBox[{"Csc", "[", 
                RowBox[{"\[Theta]", "[", "]"}], "]"}], "/", "2"}]}]}], 
            "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ChangeComponents", "[", 
          RowBox[{
           RowBox[{"mbar", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "spherical"}]}], "}"}], "]"}], ",", 
           RowBox[{"mbar", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "spherical"}], "}"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"m", "/:", 
          RowBox[{
           RowBox[{"m", "[", "a_", "]"}], 
           RowBox[{"Basis", "[", 
            RowBox[{
             RowBox[{"-", "a_"}], ",", 
             RowBox[{"{", 
              RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
          RowBox[{"m", "[", 
           RowBox[{"{", 
            RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"m", "/:", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"-", "a_"}], "]"}], 
           RowBox[{"Basis", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"{", 
              RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
          RowBox[{"m", "[", 
           RowBox[{"{", 
            RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mbar", "/:", 
          RowBox[{
           RowBox[{"mbar", "[", "a_", "]"}], 
           RowBox[{"Basis", "[", 
            RowBox[{
             RowBox[{"-", "a_"}], ",", 
             RowBox[{"{", 
              RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
          RowBox[{"mbar", "[", 
           RowBox[{"{", 
            RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mbar", "/:", 
          RowBox[{
           RowBox[{"mbar", "[", 
            RowBox[{"-", "a_"}], "]"}], 
           RowBox[{"Basis", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"{", 
              RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
          RowBox[{"mbar", "[", 
           RowBox[{"{", 
            RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefHarmonicStructure", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Cartesian", " ", "structure"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DefChart", "[", 
        RowBox[{"cartesian", ",", "S2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"y", "[", "]"}], ",", 
           RowBox[{"z", "[", "]"}]}], "}"}], ",", 
         RowBox[{"ChartColor", "\[Rule]", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DefTensor", "[", 
        RowBox[{
         RowBox[{"x", "[", "]"}], ",", "S2"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Coordinate", "[", 
         RowBox[{"1", ",", "cartesian"}], "]"}], ":=", "x"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DefTensor", "[", 
        RowBox[{
         RowBox[{"r", "[", "]"}], ",", "S2"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Coordinate", "[", 
         RowBox[{"1", ",", "spherical"}], "]"}], ":=", "r"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"change", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"r", "[", "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "[", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"r", "[", "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "[", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"z", "[", "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"r", "[", "]"}], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cartesian", "/:", 
        RowBox[{"CNumbersOf", "[", 
         RowBox[{"cartesian", ",", "TangentS2"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"spherical", "/:", 
        RowBox[{"CNumbersOf", "[", 
         RowBox[{"spherical", ",", "TangentS2"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"changeL", "=", 
         RowBox[{"ComponentArray", "[", 
          RowBox[{"Basis", ",", 
           RowBox[{"{", 
            RowBox[{"cartesian", ",", 
             RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"changeLinv", "=", 
         RowBox[{"ComponentArray", "[", 
          RowBox[{"Basis", ",", 
           RowBox[{"{", 
            RowBox[{"spherical", ",", 
             RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       RowBox[{"sphericalcoordinates", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Coordinate", "[", 
            RowBox[{"i", ",", "spherical"}], "]"}], "[", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"cartesiancoordinates", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Coordinate", "[", 
             RowBox[{"i", ",", "cartesian"}], "]"}], "[", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "/.", "change"}]}], ";", 
       
       RowBox[{"MatrixForm", "[", 
        RowBox[{"changeR", "=", 
         RowBox[{"Outer", "[", 
          RowBox[{
          "D", ",", "cartesiancoordinates", ",", "sphericalcoordinates"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"changeRinv", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Inverse", "[", "changeR", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ComponentValue", "[", 
        RowBox[{"changeL", ",", "changeR"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ComponentValue", "[", 
        RowBox[{"changeLinv", ",", "changeRinv"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ChangeComponents", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "cartesian"}], "}"}], "]"}], ",", 
         RowBox[{"m", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "spherical"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ChangeComponents", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "cartesian"}]}], "}"}], "]"}], ",", 
         RowBox[{"m", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "]"}], ":=", "1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"mmbarRule", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"mbar", "[", "a_", "]"}], 
          RowBox[{"m", "[", "b_", "]"}]}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "+", 
            RowBox[{"I", " ", 
             RowBox[{"epsilongamma", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}]}], ")"}], "/", "2"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DefConstantSymbol", "[", "l", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DefTensor", "[", 
        RowBox[{
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}], ",", 
           RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", 
         "S2"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DefTensor", "[", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}], ",", 
           RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", 
         "S2"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DefTensor", "[", 
        RowBox[{
         RowBox[{"calZ", "[", 
          RowBox[{
           RowBox[{"LI", "[", "sign", "]"}], ",", 
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}], ",", 
           RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", "S2", 
         ",", 
         RowBox[{"PrintAs", "\[Rule]", "\"\<\[GothicCapitalZ]\>\""}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calZ", "[", 
         RowBox[{
          RowBox[{"LI", "[", "1", "]"}], ",", 
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}]}], "]"}], ":=", 
        RowBox[{"2", 
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calZ", "[", 
         RowBox[{
          RowBox[{"LI", "[", "1", "]"}], ",", 
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}], ",", "inds"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calZ", "[", 
         RowBox[{
          RowBox[{"LI", "[", 
           RowBox[{"-", "1"}], "]"}], ",", 
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}], ",", "inds"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calZ", "[", 
         RowBox[{
          RowBox[{"LI", "[", 
           RowBox[{"c_.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"a_.", "+", 
               RowBox[{"2", "b_"}]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
        RowBox[{"calZ", "[", 
         RowBox[{
          RowBox[{"LI", "[", 
           RowBox[{"c", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", "a"}]}], "]"}], ",", 
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}], ",", "inds"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Z", "/:", 
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "inds", "}"}], "]"}], ">", "l"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "/:", 
        RowBox[{"X", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "inds", "}"}], "]"}], ">", "l"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"calZ", "/:", 
        RowBox[{"calZ", "[", 
         RowBox[{
          RowBox[{"LI", "[", "sign_", "]"}], ",", 
          RowBox[{"LI", "[", "l_", "]"}], ",", 
          RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "inds", "}"}], "]"}], ">", "l"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SymmetryGroupOfTensor", "[", 
         RowBox[{"Z", "[", 
          RowBox[{"_LI", ",", "_LI", ",", "indices___"}], "]"}], "]"}], "^:=", 
        RowBox[{"Symmetric", "[", 
         RowBox[{
          RowBox[{"2", "+", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", 
             RowBox[{"{", "indices", "}"}]}]}]}], ",", "Cycles"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SymmetryGroupOfTensor", "[", 
         RowBox[{"X", "[", 
          RowBox[{"_LI", ",", "_LI", ",", "indices___"}], "]"}], "]"}], "^:=", 
        RowBox[{"Symmetric", "[", 
         RowBox[{
          RowBox[{"2", "+", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", 
             RowBox[{"{", "indices", "}"}]}]}]}], ",", "Cycles"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SymmetryGroupOfTensor", "[", 
         RowBox[{"calZ", "[", 
          RowBox[{"_LI", ",", "_LI", ",", "_LI", ",", "indices___"}], "]"}], 
         "]"}], "^:=", 
        RowBox[{"Symmetric", "[", 
         RowBox[{
          RowBox[{"3", "+", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", 
             RowBox[{"{", "indices", "}"}]}]}]}], ",", "Cycles"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"_LI", ",", "_LI", ",", "___", ",", "a_", ",", "___", ",", 
          RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"_LI", ",", "_LI", ",", "___", ",", 
          RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=",
         "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"_LI", ",", "_LI", ",", "___", ",", "a_", ",", "___", ",", 
          RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"_LI", ",", "_LI", ",", "___", ",", 
          RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=",
         "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calZ", "[", 
         RowBox[{
         "_LI", ",", "_LI", ",", "_LI", ",", "___", ",", "a_", ",", "___", 
          ",", 
          RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calZ", "[", 
         RowBox[{"_LI", ",", "_LI", ",", "_LI", ",", "___", ",", 
          RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=",
         "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"_LI", ",", "_LI"}], "]"}], ":=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "/:", 
        RowBox[{
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}], ",", 
           RowBox[{"inds1__", "?", "AIndexQ"}]}], "]"}], 
         RowBox[{"X", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}], ",", 
           RowBox[{"inds2__", "?", "AIndexQ"}]}], "]"}]}], ":=", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"xAct`xTensor`Private`TakePairs", "[", 
            RowBox[{"IndexList", "[", 
             RowBox[{"inds1", ",", "inds2"}], "]"}], "]"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"IndexList", "[", 
            RowBox[{"inds1", ",", "inds2"}], "]"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ZToX", "=", 
        RowBox[{
         RowBox[{"Z", "[", 
          RowBox[{"l_LI", ",", "m_LI", ",", "a_", ",", "b___"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "c", "}"}], ",", 
           RowBox[{"-", 
            RowBox[{"Symmetrize", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"epsilongamma", "[", 
                RowBox[{"a", ",", "c"}], "]"}], 
               RowBox[{"X", "[", 
                RowBox[{"l", ",", "m", ",", 
                 RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]}], "]"}]}]}], ";", 
       RowBox[{"XToZ", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"l_LI", ",", "m_LI", ",", "a_", ",", "b___"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "c", "}"}], ",", 
           RowBox[{"Symmetrize", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"epsilongamma", "[", 
               RowBox[{"a", ",", "c"}], "]"}], 
              RowBox[{"Z", "[", 
               RowBox[{"l", ",", "m", ",", 
                RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
       RowBox[{"calZTocalZ", "=", 
        RowBox[{
         RowBox[{"calZ", "[", 
          RowBox[{
           RowBox[{"LI", "[", "sign_", "]"}], ",", "l_LI", ",", "m_LI", ",", 
           "a_", ",", "b___"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "c", "}"}], ",", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"Symmetrize", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"epsilongamma", "[", 
                RowBox[{"a", ",", "c"}], "]"}], 
               RowBox[{"calZ", "[", 
                RowBox[{
                 RowBox[{"LI", "[", 
                  RowBox[{"-", "sign"}], "]"}], ",", "l", ",", "m", ",", 
                 RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Dropepsilon", "=", 
        RowBox[{
         RowBox[{"term", ":", 
          RowBox[{"(", 
           RowBox[{"_.", " ", 
            RowBox[{"epsilongamma", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Z", "|", "X", "|", "calZ"}], ")"}], "[", "__", "]"}]}],
            ")"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"term", ",", 
            RowBox[{"{", 
             RowBox[{"ZToX", ",", "XToZ", ",", "calZTocalZ"}], "}"}]}], "]"}],
           "/;", 
          RowBox[{
           RowBox[{"IsIndexOf", "[", 
            RowBox[{"term", ",", 
             RowBox[{"-", "a"}]}], "]"}], "||", 
           RowBox[{"IsIndexOf", "[", 
            RowBox[{"term", ",", 
             RowBox[{"-", "b"}]}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"cd", "[", "a_", "]"}], "[", 
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "]"}], ":=", 
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}], ",", "a"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cd", "[", "b_", "]"}], "[", 
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}], ",", 
           RowBox[{"a_", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b"}], "]"}], "-", 
         RowBox[{"l", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}], "/", "2"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", "b"}], "]"}], 
          RowBox[{"Z", "[", 
           RowBox[{
            RowBox[{"LI", "[", "l", "]"}], ",", 
            RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cd", "[", "b_", "]"}], "[", 
         RowBox[{"X", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}], ",", 
           RowBox[{"a_", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b"}], "]"}], "-", 
         RowBox[{"l", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}], "/", "2"}], 
          RowBox[{"epsilongamma", "[", 
           RowBox[{"a", ",", "b"}], "]"}], 
          RowBox[{"Z", "[", 
           RowBox[{
            RowBox[{"LI", "[", "l", "]"}], ",", 
            RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cd", "[", "b_", "]"}], "[", 
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}], ",", 
           RowBox[{"a1_", "?", "AIndexQ"}], ",", 
           RowBox[{"a2_", "?", "AIndexQ"}], ",", 
           RowBox[{"a___", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "b$", "}"}], ",", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"1", "+", "1", "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"Z", "[", 
               RowBox[{
                RowBox[{"LI", "[", "l", "]"}], ",", 
                RowBox[{"LI", "[", "m", "]"}], ",", "a1", ",", "a2", ",", "a",
                 ",", "b$"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "s"}], ")"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"l", "-", "s", "+", "1"}], ")"}], "/", "2"}], 
               RowBox[{"Symmetrize", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "/", "2"}], 
                   RowBox[{"gamma", "[", 
                    RowBox[{"a1", ",", "a2"}], "]"}], 
                   RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", "l", "]"}], ",", 
                    RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b$"}], 
                    "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"gamma", "[", 
                    RowBox[{"b$", ",", "a1"}], "]"}], 
                   RowBox[{"Z", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", "l", "]"}], ",", 
                    RowBox[{"LI", "[", "m", "]"}], ",", "a2", ",", "a"}], 
                    "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"a1", ",", "a2", ",", "a"}], "}"}]}], "]"}]}]}]}], 
            "]"}], "/.", 
           RowBox[{"b$", "\[Rule]", "b"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cd", "[", "b_", "]"}], "[", 
         RowBox[{"X", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l_", "]"}], ",", 
           RowBox[{"LI", "[", "m_", "]"}], ",", 
           RowBox[{"a1_", "?", "AIndexQ"}], ",", 
           RowBox[{"a2_", "?", "AIndexQ"}], ",", 
           RowBox[{"a___", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "b$", "}"}], ",", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", "=", 
               RowBox[{"1", "+", "1", "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{
                RowBox[{"LI", "[", "l", "]"}], ",", 
                RowBox[{"LI", "[", "m", "]"}], ",", "a1", ",", "a2", ",", "a",
                 ",", "b$"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "s"}], ")"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"l", "-", "s", "+", "1"}], ")"}], "/", "2"}], 
               RowBox[{"Symmetrize", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "/", "2"}], 
                   RowBox[{"gamma", "[", 
                    RowBox[{"a1", ",", "a2"}], "]"}], 
                   RowBox[{"X", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", "l", "]"}], ",", 
                    RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b$"}], 
                    "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"gamma", "[", 
                    RowBox[{"b$", ",", "a1"}], "]"}], 
                   RowBox[{"X", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", "l", "]"}], ",", 
                    RowBox[{"LI", "[", "m", "]"}], ",", "a2", ",", "a"}], 
                    "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"a1", ",", "a2", ",", "a"}], "}"}]}], "]"}]}]}]}], 
            "]"}], "/.", 
           RowBox[{"b$", "\[Rule]", "b"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeffK", "[", 
         RowBox[{"l_", ",", "s_"}], "]"}], ":=", 
        RowBox[{"Infinity", "/;", 
         RowBox[{"s", ">", "l"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeffK", "[", 
         RowBox[{"l_", ",", "s_"}], "]"}], ":=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l"}], "+", "1"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"4", "Pi"}], ")"}]}], "/", 
           RowBox[{"2", "^", "s"}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "s"}], ")"}], "!"}], "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "-", "s"}], ")"}], "!"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"DefTensor", "[", 
        RowBox[{
         RowBox[{"calD", "[", 
          RowBox[{
           RowBox[{"LI", "[", "l", "]"}], ",", 
           RowBox[{"LI", "[", "mp", "]"}], ",", 
           RowBox[{"LI", "[", "m", "]"}]}], "]"}], ",", "manifold", ",", 
         RowBox[{"PrintAs", "->", "\"\<\[GothicCapitalD]\>\""}]}], "]"}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l_", ",", "1", ",", "mlabel_"}], "]"}], "[", "inds___", 
         "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "inds", "}"}], "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"coeffK", "[", 
            RowBox[{"l", ",", "s"}], "]"}], 
           RowBox[{"calD", "[", 
            RowBox[{
             RowBox[{"LI", "@", "l"}], ",", 
             RowBox[{"LI", "@", "s"}], ",", 
             RowBox[{"LI", "@", "mlabel"}]}], "]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "s"}], " ", 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"m", "/@", 
              RowBox[{"{", "inds", "}"}]}], ")"}]}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l_", ",", 
           RowBox[{"-", "1"}], ",", "mlabel_"}], "]"}], "[", "inds___", "]"}],
         ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "inds", "}"}], "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"coeffK", "[", 
            RowBox[{"l", ",", "s"}], "]"}], 
           RowBox[{"calD", "[", 
            RowBox[{
             RowBox[{"LI", "@", "l"}], ",", 
             RowBox[{"LI", "@", 
              RowBox[{"-", "s"}]}], ",", 
             RowBox[{"LI", "@", "mlabel"}]}], "]"}], 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"mbar", "/@", 
              RowBox[{"{", "inds", "}"}]}], ")"}]}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ZXToY", ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Z", "[", 
            RowBox[{
             RowBox[{"LI", "[", "l_", "]"}], ",", 
             RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"PureSpin", "[", 
             RowBox[{"l", ",", "1", ",", "m"}], "]"}], "[", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Z", "[", 
            RowBox[{
             RowBox[{"LI", "[", "l_", "]"}], ",", 
             RowBox[{"LI", "[", "m_", "]"}], ",", "inds__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"PureSpin", "[", 
              RowBox[{"l", ",", "1", ",", "m"}], "]"}], "[", "inds", "]"}], 
            "+", 
            RowBox[{
             RowBox[{"PureSpin", "[", 
              RowBox[{"l", ",", 
               RowBox[{"-", "1"}], ",", "m"}], "]"}], "[", "inds", "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{
             RowBox[{"LI", "[", "l_", "]"}], ",", 
             RowBox[{"LI", "[", "m_", "]"}], ",", "inds__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"I", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"PureSpin", "[", 
                RowBox[{"l", ",", "1", ",", "m"}], "]"}], "[", "inds", "]"}], 
              "-", 
              RowBox[{
               RowBox[{"PureSpin", "[", 
                RowBox[{"l", ",", 
                 RowBox[{"-", "1"}], ",", "m"}], "]"}], "[", "inds", "]"}]}], 
             ")"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"spherical", "/:", 
        RowBox[{"CNumbersOf", "[", 
         RowBox[{"spherical", ",", "TangentS2"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cartesian", "/:", 
        RowBox[{"CNumbersOf", "[", 
         RowBox[{"cartesian", ",", "TangentS2"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HarmonicComponent", "[", "expr_", "]"}], ":=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"ToValues", "[", 
          RowBox[{
           RowBox[{"expr", "/.", "ZXToY"}], "/.", "calDRule"}], "]"}], 
         "]"}]}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Format", "[", 
         RowBox[{"coeffE", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s_", ",", "l_", ",", "m_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"sp_", ",", "lp_", ",", "mp_"}], "}"}], ",", "lpp_"}], 
          "]"}], "]"}], ":=", 
        RowBox[{"Subsuperscript", "[", 
         RowBox[{"\"\<E\>\"", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "s", "]"}], ",", "\"\<,\>\"", ",", 
            RowBox[{"ToString", "[", "l", "]"}], ",", "\"\<,\>\"", ",", 
            RowBox[{"ToString", "[", "m", "]"}], ",", "\"\<;\>\"", ",", 
            RowBox[{"ToString", "[", "lpp", "]"}]}], "]"}], ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "sp", "]"}], ",", "\"\<,\>\"", ",", 
            RowBox[{"ToString", "[", "lp", "]"}], ",", "\"\<,\>\"", ",", 
            RowBox[{"ToString", "[", "mp", "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coeffE", "/:", 
        RowBox[{"FindIndices", "[", 
         RowBox[{"coeffE", "[", "___", "]"}], "]"}], "=", 
        RowBox[{"IndexList", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"_", "?", "FirstDerQ"}], "[", 
         RowBox[{"coeffE", "[", "__", "]"}], "]"}], "^=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IsIndexOf", "[", 
         RowBox[{
          RowBox[{"coeffE", "[", "___", "]"}], ",", "__"}], "]"}], "^:=", 
        "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"coeffERule", "=", 
        RowBox[{
         RowBox[{"coeffE", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s_", ",", "l_", ",", "m_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"sp_", ",", "lp_", ",", "mp_"}], "}"}], ",", "lpp_"}], 
          "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"coeffK", "[", 
           RowBox[{"lp", ",", 
            RowBox[{"Abs", "[", "sp", "]"}]}], "]"}], 
          RowBox[{
           RowBox[{"coeffK", "[", 
            RowBox[{"l", ",", 
             RowBox[{"Abs", "[", "s", "]"}]}], "]"}], "/", 
           RowBox[{"coeffK", "[", 
            RowBox[{"lpp", ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"s", "+", "sp"}], "]"}]}], "]"}]}], 
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lp", ",", "mp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lpp", ",", 
              RowBox[{"m", "+", "mp"}]}], "}"}]}], "]"}], 
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lp", ",", "sp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "s"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lpp", ",", 
              RowBox[{"s", "+", "sp"}]}], "}"}]}], "]"}]}]}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"TTensor", "[", "1", "]"}], "[", 
         RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"Length", "[", "ainds", "]"}]}], 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"mbar", "/@", "ainds"}], ")"}]}], 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"m", "/@", "binds"}], ")"}]}]}]}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"TTensor", "[", 
          RowBox[{"-", "1"}], "]"}], "[", 
         RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"Length", "[", "ainds", "]"}]}], 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"m", "/@", "ainds"}], ")"}]}], 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"mbar", "/@", "binds"}], ")"}]}]}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"calTTensor", "[", "sign_", "]"}], "[", 
         RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"TTensor", "[", 
             RowBox[{"-", "1"}], "]"}], "[", 
            RowBox[{"ainds", ",", "binds"}], "]"}], "+", 
           RowBox[{"sign", " ", 
            RowBox[{
             RowBox[{"TTensor", "[", "1", "]"}], "[", 
             RowBox[{"ainds", ",", "binds"}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ProductRule", ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"rest_.", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tp", ":", 
               RowBox[{"(", 
                RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "lp_", "]"}], ",", 
              RowBox[{"LI", "[", "mp_", "]"}], ",", "a___"}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", ":", 
               RowBox[{"(", 
                RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "l_", "]"}], ",", 
              RowBox[{"LI", "[", "mlabel_", "]"}], ",", "b___"}], "]"}]}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sp", "=", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "a", "}"}], "]"}]}], ",", 
                RowBox[{"s", "=", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "b", "}"}], "]"}]}], ",", "ab", ",", "aa", ",",
                 "sigma", ",", "sigmap", ",", "coeff", ",", "coeffp"}], "}"}],
               ",", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"coeffp", ",", "sigmap"}], "}"}], "=", 
                RowBox[{"Switch", "[", 
                 RowBox[{"tp", ",", "Z", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
                  RowBox[{"{", 
                   RowBox[{"I", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"coeff", ",", "sigma"}], "}"}], "=", 
                RowBox[{"Switch", "[", 
                 RowBox[{"t", ",", "Z", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
                  RowBox[{"{", 
                   RowBox[{"I", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ab", "=", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"{", "a", "}"}], ",", "s"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"aa", "=", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"{", "a", "}"}], ",", 
                  RowBox[{
                   RowBox[{"-", "sp"}], "+", "s"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"rest", " ", "coeffp", " ", "coeff", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"s", "===", "0"}], ",", 
                  RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"sp", "===", "0"}], ",", 
                  RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"coeffE", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sp", ",", "lp", ",", "mp"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "l", ",", "mlabel"}], "}"}], ",", 
                    "lpp"}], "]"}], 
                    RowBox[{"calZ", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "lp", "-", "lpp"}], ")"}]}], "sigma", 
                    " ", "sigmap"}], "]"}], ",", 
                    RowBox[{"LI", "[", "lpp", "]"}], ",", 
                    RowBox[{"LI", "[", 
                    RowBox[{"mp", "+", "mlabel"}], "]"}], ",", "a", ",", 
                    "b"}], "]"}]}], "+", 
                   RowBox[{"sigma", " ", 
                    RowBox[{"coeffE", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sp", ",", "lp", ",", "mp"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "s"}], ",", "l", ",", "mlabel"}], "}"}], ",",
                     "lpp"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"calTTensor", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"aa", ",", 
                    RowBox[{"{", "b", "}"}]}], "]"}], 
                    RowBox[{"calZ", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "lp", "-", "lpp"}], ")"}]}], "sigma", 
                    " ", "sigmap"}], "]"}], ",", 
                    RowBox[{"LI", "[", "lpp", "]"}], ",", 
                    RowBox[{"LI", "[", 
                    RowBox[{"mp", "+", "mlabel"}], "]"}], ",", "ab"}], 
                    "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"calTTensor", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"aa", ",", 
                    RowBox[{"{", "b", "}"}]}], "]"}], 
                    RowBox[{"calZ", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "lp", "-", "lpp"}], ")"}]}]}], "sigma", 
                    " ", "sigmap"}], "]"}], ",", 
                    RowBox[{"LI", "[", "lpp", "]"}], ",", 
                    RowBox[{"LI", "[", 
                    RowBox[{"mp", "+", "mlabel"}], "]"}], ",", "ab"}], 
                    "]"}]}]}], ")"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lpp", ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"lp", "-", "l"}], "]"}], ",", 
                    RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}]}], "]"}], "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "a", "}"}], "]"}], "\[GreaterEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "b", "}"}], "]"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"rest_.", " ", 
            RowBox[{
             RowBox[{"Z", "[", 
              RowBox[{
               RowBox[{"LI", "[", "l_", "]"}], ",", 
               RowBox[{"LI", "[", "mlabel_", "]"}]}], "]"}], "^", "2"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"rest", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffE", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "l", ",", "mlabel"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "l", ",", "mlabel"}], "}"}], ",", "lpp"}],
                 "]"}], 
               RowBox[{"Z", "[", 
                RowBox[{
                 RowBox[{"LI", "[", "lpp", "]"}], ",", 
                 RowBox[{"LI", "[", 
                  RowBox[{"2", "mlabel"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"lpp", ",", "0", ",", 
                RowBox[{"2", "l"}]}], "}"}]}], "]"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FormalProductRule", "[", "lc_", "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"rest_.", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ta", ":", 
               RowBox[{"(", 
                RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "la_", "]"}], ",", 
              RowBox[{"LI", "[", "ma_", "]"}], ",", "a___"}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tb", ":", 
               RowBox[{"(", 
                RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "lb_", "]"}], ",", 
              RowBox[{"LI", "[", "mb_", "]"}], ",", "b___"}], "]"}]}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sa", "=", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "a", "}"}], "]"}]}], ",", 
                RowBox[{"sb", "=", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "b", "}"}], "]"}]}], ",", "sigmaa", ",", 
                "sigmab", ",", "coeffa", ",", "coeffb", ",", "indicesA", ",", 
                "indicesZ"}], "}"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"coeffa", ",", "sigmaa"}], "}"}], "=", 
                RowBox[{"Switch", "[", 
                 RowBox[{"ta", ",", "Z", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
                  RowBox[{"{", 
                   RowBox[{"I", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"coeffb", ",", "sigmab"}], "}"}], "=", 
                RowBox[{"Switch", "[", 
                 RowBox[{"tb", ",", "Z", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
                  RowBox[{"{", 
                   RowBox[{"I", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"indicesZ", "=", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"(", 
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"{", "a", "}"}], ",", "sb"}], "]"}], ")"}]}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"indicesA", "=", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"{", "a", "}"}], ",", 
                  RowBox[{"sb", "-", "sa"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"rest", " ", "coeffa", " ", "coeffb", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"sa", "===", "0"}], ",", 
                  RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"sb", "===", "0"}], ",", 
                  RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"coeffE", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sa", ",", "la", ",", "ma"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"sb", ",", "lb", ",", "mb"}], "}"}], ",", "lc"}], 
                    "]"}], 
                   RowBox[{"calZ", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"lb", "+", "la", "-", "lc"}], ")"}]}], "sigmaa", 
                    " ", "sigmab"}], "]"}], ",", 
                    RowBox[{"LI", "[", "lc", "]"}], ",", 
                    RowBox[{"LI", "[", 
                    RowBox[{"ma", "+", "mb"}], "]"}], ",", "a", ",", "b"}], 
                    "]"}]}], "+", 
                  RowBox[{"sigmab", " ", 
                   RowBox[{"coeffE", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sa", ",", "la", ",", "ma"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "sb"}], ",", "lb", ",", "mb"}], "}"}], ",", 
                    "lc"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"calTTensor", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"indicesA", ",", 
                    RowBox[{"{", "b", "}"}]}], "]"}], 
                    RowBox[{"calZ", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"lb", "+", "la", "-", "lc"}], ")"}]}], "sigmaa", 
                    " ", "sigmab"}], "]"}], ",", 
                    RowBox[{"LI", "[", "lc", "]"}], ",", 
                    RowBox[{"LI", "[", 
                    RowBox[{"ma", "+", "mb"}], "]"}], ",", "indicesZ"}], 
                    "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"calTTensor", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"indicesA", ",", 
                    RowBox[{"{", "b", "}"}]}], "]"}], 
                    RowBox[{"calZ", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"lb", "+", "la", "-", "lc"}], ")"}]}]}], "sigmaa",
                     " ", "sigmab"}], "]"}], ",", 
                    RowBox[{"LI", "[", "lc", "]"}], ",", 
                    RowBox[{"LI", "[", 
                    RowBox[{"ma", "+", "mb"}], "]"}], ",", "indicesZ"}], 
                    "]"}]}]}], ")"}]}]}], ")"}]}]}]}], "]"}], "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "a", "}"}], "]"}], "\[GreaterEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "b", "}"}], "]"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"rest_.", " ", 
            RowBox[{
             RowBox[{"Z", "[", 
              RowBox[{
               RowBox[{"LI", "[", "la_", "]"}], ",", 
               RowBox[{"LI", "[", "ma_", "]"}]}], "]"}], "^", "2"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"rest", " ", 
            RowBox[{"coeffE", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "la", ",", "ma"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "la", ",", "ma"}], "}"}], ",", "lc"}], "]"}], 
            RowBox[{
             RowBox[{"calZ", "[", 
              RowBox[{
               RowBox[{"LI", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "lc"}], ")"}]}], "]"}], ",", 
               RowBox[{"LI", "[", "lc", "]"}], ",", 
               RowBox[{"LI", "[", 
                RowBox[{"2", "ma"}], "]"}]}], "]"}], "/", "2"}]}]}]}], 
         "}"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.1. Definition of manifold", "Subsubsection"],

Cell["Define S2 manifold", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefManifold", "[", 
  RowBox[{"S2", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}], "}"}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefManifold", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"manifold \"\>", "\[InvisibleSpace]", "S2", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefManifold, ": Defining ", "manifold ", S2, ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefVBundle", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle \"\>", "\[InvisibleSpace]", "TangentS2", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefVBundle, ": Defining ", "vbundle ", TangentS2, ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell["with round metric", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefMetric", "[", 
  RowBox[{"1", ",", 
   RowBox[{"gamma", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "cd", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<:\>\"", ",", "\"\<D\>\""}], "}"}], ",", 
   RowBox[{"PrintAs", "->", "\"\<\[Gamma]\>\""}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric metric tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"gamma", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "symmetric metric tensor ", 
   gamma[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric tensor \"\>", "\[InvisibleSpace]", 
   
   RowBox[{"epsilongamma", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "antisymmetric tensor ", 
   epsilongamma[a, b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"covariant derivative \"\>", "\[InvisibleSpace]", 
   
   RowBox[{"cd", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefCovD, ": Defining ", "covariant derivative ", 
   cd[-a], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing torsion tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"Torsioncd", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing torsion tensor ", 
   Torsioncd[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"Christoffelcd", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefTensor, ": Defining ", "symmetric Christoffel tensor ", 
   Christoffelcd[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Riemann tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"Riemanncd", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Riemann tensor ", 
   Riemanncd[-a, -b, -c, -d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"Riccicd", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "symmetric Ricci tensor ", 
   Riccicd[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData["\<\"** DefCovD:  Contractions of Riemann automatically replaced \
by Ricci.\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Ricci scalar \"\>", "\[InvisibleSpace]", 
   RowBox[{"RicciScalarcd", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Ricci scalar ", 
   RicciScalarcd[], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData["\<\"** DefCovD:  Contractions of Ricci automatically replaced \
by RicciScalar.\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Einstein tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"Einsteincd", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefTensor, ": Defining ", "vanishing Einstein tensor ", 
   Einsteincd[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Weyl tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"Weylcd", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing Weyl tensor ", 
   Weylcd[-a, -b, -c, -d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing TFRicci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"TFRiccicd", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing TFRicci tensor ", 
   TFRiccicd[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Kretschmann scalar \"\>", "\[InvisibleSpace]", 
   RowBox[{"Kretschmanncd", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Kretschmann scalar ", 
   Kretschmanncd[], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** DefCovD:  Computing RiemannToWeylRules for dim \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["** DefCovD:  Computing RiemannToWeylRules for dim ", 2],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** DefCovD:  Computing RicciToTFRicci for dim \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["** DefCovD:  Computing RicciToTFRicci for dim ", 2],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** DefCovD:  Computing RicciToEinsteinRules for dim \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["** DefCovD:  Computing RicciToEinsteinRules for dim ", 2],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"weight +2 density \"\>", "\[InvisibleSpace]", 
   RowBox[{"Detgamma", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"Determinant.\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "weight +2 density ", 
   Detgamma[], ". ", "Determinant."],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell["Constant (unit) Gaussian curvature:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RicciScalarcd", "[", "]"}], ":=", "2"}]], "Input",
 InitializationCell->True],

Cell["We can now define the calD scalars:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"calD", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "mp", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}]}], "]"}], ",", "S2", ",", 
   RowBox[{"PrintAs", "->", "\"\<\[GothicCapitalD]\>\""}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"calD", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "mp", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   calD[
    LI[l], 
    LI[mp], 
    LI[m]], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell["\<\
We shall use the convention of having three upper label indices\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calD", "[", 
  RowBox[{
   RowBox[{"LI", "[", "l", "]"}], ",", 
   RowBox[{"LI", "[", 
    RowBox[{"m", "'"}], "]"}], ",", 
   RowBox[{"LI", "[", "m", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["\[GothicCapitalD]", "   ", 
    RowBox[{
     RowBox[{"lm", "'"}], "m"}]],
   AutoSpacing->False],
  calD[
   LI[l], 
   LI[
    Derivative[1][m]], 
   LI[m]],
  Editable->False]], "Output"]
}, Open  ]],

Cell["instead of the usual", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calD", "[", 
  RowBox[{
   RowBox[{"LI", "[", "l", "]"}], ",", 
   RowBox[{"-", 
    RowBox[{"LI", "[", 
     RowBox[{"m", "'"}], "]"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"LI", "[", "m", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["\[GothicCapitalD]", 
    RowBox[{" ", 
     RowBox[{
      RowBox[{"m", "'"}], "m"}]}], 
    RowBox[{"l", "  "}]],
   AutoSpacing->False],
  calD[
   LI[l], -LI[
     Derivative[1][m]], -LI[m]],
  Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3.2. Coordinate systems", "Subsubsection"],

Cell["\<\
We use a dirty trick to have 3-dimensional coordinate systems on the \
2-dimensional manifold S2:\
\>", "Text"],

Cell["Define the cartesian coordinate system:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefChart", "[", 
  RowBox[{"cartesian", ",", "S2", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "[", "]"}], ",", 
     RowBox[{"z", "[", "]"}]}], "}"}], ",", 
   RowBox[{"ChartColor", "\[Rule]", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"y", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   y[], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"z", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   z[], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefBasis", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"basis \"\>", "\[InvisibleSpace]", "cartesian", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefBasis, ": Defining ", "basis ", cartesian, ". ", ""],
  
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative \"\>", "\[InvisibleSpace]", 
   RowBox[{"PDcartesian", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefCovD, ": Defining ", "parallel derivative ", 
   PDcartesian[-a], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing torsion tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"TorsionPDcartesian", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing torsion tensor ", 
   TorsionPDcartesian[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"ChristoffelPDcartesian", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefTensor, ": Defining ", "symmetric Christoffel tensor ", 
   ChristoffelPDcartesian[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Riemann tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RiemannPDcartesian", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", "d"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>",
    "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing Riemann tensor ", 
   RiemannPDcartesian[-a, -b, -c, d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RicciPDcartesian", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing Ricci tensor ", 
   RicciPDcartesian[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaUpcartesian", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "antisymmetric +1 density ", 
   etaUpcartesian[a, b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaDowncartesian", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "antisymmetric -1 density ", 
   etaDowncartesian[-a, -b], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We enlarge the coordinate system with an additional coordinate:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"x", "[", "]"}], ",", "S2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coordinate", "[", 
    RowBox[{"1", ",", "cartesian"}], "]"}], ":=", "x"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"x", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   x[], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell["Define the spherical system:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefChart", "[", 
  RowBox[{"spherical", ",", "S2", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "]"}], ",", 
     RowBox[{"\[Phi]", "[", "]"}]}], "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[Theta]", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   \[Theta][], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[Phi]", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   \[Phi][], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefBasis", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"basis \"\>", "\[InvisibleSpace]", "spherical", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefBasis, ": Defining ", "basis ", spherical, ". ", ""],
  
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative \"\>", "\[InvisibleSpace]", 
   RowBox[{"PDspherical", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefCovD, ": Defining ", "parallel derivative ", 
   PDspherical[-a], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing torsion tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"TorsionPDspherical", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing torsion tensor ", 
   TorsionPDspherical[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"ChristoffelPDspherical", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefTensor, ": Defining ", "symmetric Christoffel tensor ", 
   ChristoffelPDspherical[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Riemann tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RiemannPDspherical", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", "d"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>",
    "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing Riemann tensor ", 
   RiemannPDspherical[-a, -b, -c, d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RicciPDspherical", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing Ricci tensor ", 
   RicciPDspherical[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaUpspherical", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "antisymmetric +1 density ", 
   etaUpspherical[a, b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaDownspherical", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "antisymmetric -1 density ", 
   etaDownspherical[-a, -b], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell["Again, We add a third coordinate to the spherical chart:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"r", "[", "]"}], ",", "S2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coordinate", "[", 
    RowBox[{"1", ",", "spherical"}], "]"}], ":=", "r"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"r", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   r[], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell["Now we give the metric in this coordinate system:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CVVerbose", "=", "False"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metricvalues", "=", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "]"}], "]"}], "^", "2"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MetricInBasis", "[", 
  RowBox[{"gamma", ",", 
   RowBox[{"-", "spherical"}], ",", "metricvalues"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{2, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "1"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{2, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"3", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{3, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{3, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], "2"]}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MetricInBasis", "[", 
  RowBox[{"gamma", ",", "spherical", ",", 
   RowBox[{"Inverse", "[", "metricvalues", "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{2, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", "1"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"2", "3"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{2, spherical}, {3, spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{3, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{3, spherical}, {3, spherical}],
       Editable->False], "\[Rule]", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox[
         StyleBox["Csc",
          AutoSpacing->False],
         Csc,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], "2"]}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TensorValues", "[", "gamma", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", "  ", 
        StyleBox[
         RowBox[{"3", "2"}],
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      gamma[{3, spherical}, {2, spherical}],
      Editable->False], "\[Rule]", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", "  ", 
        StyleBox[
         RowBox[{"2", "3"}],
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      gamma[{2, spherical}, {3, spherical}],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{2, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", "1"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"2", "3"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{2, spherical}, {3, spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       gamma[{3, spherical}, {3, spherical}],
       Editable->False], "\[Rule]", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox[
         StyleBox["Csc",
          AutoSpacing->False],
         Csc,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox[
         RowBox[{"3", "2"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      gamma[{3, -spherical}, {2, -spherical}],
      Editable->False], "\[Rule]", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox[
         RowBox[{"2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      gamma[{2, -spherical}, {3, -spherical}],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{2, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "1"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{2, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       gamma[{3, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], "2"]}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell["We enlarge the metric:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox[
        RowBox[{"1", "1"}],
        FontColor->RGBColor[1, 0, 0]], "  "],
      AutoSpacing->False],
     gamma[{1, -spherical}, {1, -spherical}],
     Editable->False], "\[Rule]", "0"}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox[
        RowBox[{"1", "2"}],
        FontColor->RGBColor[1, 0, 0]], "  "],
      AutoSpacing->False],
     gamma[{1, -spherical}, {2, -spherical}],
     Editable->False], "\[Rule]", "0"}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox[
        RowBox[{"1", "3"}],
        FontColor->RGBColor[1, 0, 0]], "  "],
      AutoSpacing->False],
     gamma[{1, -spherical}, {3, -spherical}],
     Editable->False], "\[Rule]", "0"}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox[
        RowBox[{"2", "1"}],
        FontColor->RGBColor[1, 0, 0]], "  "],
      AutoSpacing->False],
     gamma[{2, -spherical}, {1, -spherical}],
     Editable->False], "\[Rule]", "0"}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox[
        RowBox[{"3", "1"}],
        FontColor->RGBColor[1, 0, 0]], "  "],
      AutoSpacing->False],
     gamma[{3, -spherical}, {1, -spherical}],
     Editable->False], "\[Rule]", "0"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["The determinant of the metric:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"Det", "[", "metricvalues", "]"}], "]"}], "//", 
  "PowerExpand"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox["Sin",
    AutoSpacing->False],
   Sin,
   Editable->False], "[", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Theta]", "", ""],
    AutoSpacing->False],
   \[Theta][],
   Editable->False], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{"Determinant", "[", 
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "b"}]}], "]"}], ",", "spherical"}], "]"}], ",", "%"}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"weight +2 density \"\>", "\[InvisibleSpace]", 
   RowBox[{"Detgammaspherical", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>",
    "\[InvisibleSpace]", "\<\"Determinant.\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "weight +2 density ", 
   Detgammaspherical[], ". ", "Determinant."],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     OverscriptBox["\[Gamma]", 
      OverscriptBox[
       StyleBox["~",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["~",
        FontColor->RGBColor[1, 0, 0]]]], "", ""],
    AutoSpacing->False],
   Detgammaspherical[],
   Editable->False], "\[Rule]", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "metricvalues", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell["And the epsilon tensor:", "Text"],

Cell[CellGroupData[{

Cell[BoxData["$epsilonSign"], "Input"],

Cell[BoxData["1"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentArray", "[", 
  RowBox[{"epsilongamma", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "spherical"}], ",", 
     RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", 
        StyleBox[
         RowBox[{"2", "2"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      epsilongamma[{2, -spherical}, {2, -spherical}],
      Editable->False], ",", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", 
        StyleBox[
         RowBox[{"2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      epsilongamma[{2, -spherical}, {3, -spherical}],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", 
        StyleBox[
         RowBox[{"3", "2"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      epsilongamma[{3, -spherical}, {2, -spherical}],
      Editable->False], ",", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", 
        StyleBox[
         RowBox[{"3", "3"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      epsilongamma[{3, -spherical}, {3, -spherical}],
      Editable->False]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"$epsilonSign", " ", 
   RowBox[{"Detgammaspherical", "[", "]"}], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "//", 
  "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", "0"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{"ComponentArray", "[", 
    RowBox[{"epsilongamma", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "spherical"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"$epsilonSign", " ", 
     RowBox[{"Detgammaspherical", "[", "]"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "//", 
    "ToValues"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"3", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
Now we compute the values of epsilongamma in all other index configurations:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$BMUseValues", "=", "All"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TUseValues", "=", "All"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CVSimplify", "=", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CCSimplify", "=", "Simplify"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeComponents", "[", 
  RowBox[{
   RowBox[{"epsilongamma", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "spherical"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "spherical"}], "}"}]}], "]"}], ",", 
   RowBox[{"epsilongamma", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "b"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]\[Gamma]", 
       RowBox[{
        StyleBox["a",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]]}]],
      AutoSpacing->False],
     epsilongamma[{-a, -spherical}, {b, spherical}],
     Editable->False]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", 
        StyleBox[
         RowBox[{"a", "c"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      epsilongamma[{-a, -spherical}, {-c, -spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", "  ", 
        StyleBox[
         RowBox[{"b", "c"}],
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      gamma[{b, spherical}, {c, spherical}],
      Editable->False]}], "\[InvisibleSpace]", "\<\" in \"\>", 
    "\[InvisibleSpace]", "0.030253`4.932313440876003", 
    "\[InvisibleSpace]", "\<\" Seconds\"\>"}]}],
  SequenceForm[
  "Computed ", epsilongamma[{-a, -spherical}, {b, spherical}] -> 
   epsilongamma[{-a, -spherical}, {-c, -spherical}] 
    gamma[{b, spherical}, {c, spherical}], " in ", 0.030253`4.932313440876003,
    " Seconds"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
       StyleBox[
        RowBox[{"a", "b"}],
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     epsilongamma[{a, spherical}, {b, spherical}],
     Editable->False]}], "\[Rule]", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]\[Gamma]", 
       RowBox[{
        StyleBox["c",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]]}]],
      AutoSpacing->False],
     epsilongamma[{-c, -spherical}, {b, spherical}],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", "  ", 
       StyleBox[
        RowBox[{"a", "c"}],
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     gamma[{a, spherical}, {c, spherical}],
     Editable->False], "\[InvisibleSpace]", "\<\" in \"\>", 
    "\[InvisibleSpace]", "0.013991`4.597393750086518", 
    "\[InvisibleSpace]", "\<\" Seconds\"\>"}]}],
  SequenceForm[
  "Computed ", epsilongamma[{a, spherical}, {b, spherical}] -> 
   epsilongamma[{-c, -spherical}, {b, spherical}] 
    gamma[{a, spherical}, {c, spherical}], " in ", 0.013991`4.597393750086518,
    " Seconds"],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       epsilongamma[{2, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        epsilongamma[{2, spherical}, {3, spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {3, spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
        StyleBox[
         RowBox[{"2", "3"}],
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      epsilongamma[{2, spherical}, {3, spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      InterpretationBox[
       StyleBox["Csc",
        AutoSpacing->False],
       Csc,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{" ", 
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]], " "}]],
         AutoSpacing->False],
        epsilongamma[{2, spherical}, {2, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{" ", 
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]], " "}]],
         AutoSpacing->False],
        epsilongamma[{2, spherical}, {3, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {3, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{" ", 
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]], " "}]],
         AutoSpacing->False],
        epsilongamma[{3, spherical}, {3, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]], " "}], 
          RowBox[{" ", 
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]]}]],
         AutoSpacing->False],
        epsilongamma[{2, -spherical}, {3, spherical}],
        Editable->False]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{2, spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{2, spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {3, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TensorValues", "[", "epsilongamma", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       epsilongamma[{2, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "2"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        epsilongamma[{2, spherical}, {3, spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {3, spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", 
        StyleBox[
         RowBox[{"2", "3"}],
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      epsilongamma[{2, spherical}, {3, spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      InterpretationBox[
       StyleBox["Csc",
        AutoSpacing->False],
       Csc,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{" ", 
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]], " "}]],
         AutoSpacing->False],
        epsilongamma[{2, spherical}, {2, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{" ", 
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]], " "}]],
         AutoSpacing->False],
        epsilongamma[{2, spherical}, {3, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {3, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{" ", 
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]], " "}]],
         AutoSpacing->False],
        epsilongamma[{3, spherical}, {3, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          RowBox[{
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]], " "}], 
          RowBox[{" ", 
           StyleBox["3",
            FontColor->RGBColor[1, 0, 0]]}]],
         AutoSpacing->False],
        epsilongamma[{2, -spherical}, {3, spherical}],
        Editable->False]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{2, spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{2, spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {3, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}]],
        AutoSpacing->False],
       epsilongamma[{3, spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{2, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"3", "2"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {2, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Epsilon]\[Gamma]", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]], "  "],
         AutoSpacing->False],
        epsilongamma[{2, -spherical}, {3, -spherical}],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", 
         StyleBox[
          RowBox[{"3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "  "],
        AutoSpacing->False],
       epsilongamma[{3, -spherical}, {3, -spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", 
        StyleBox[
         RowBox[{"2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      epsilongamma[{2, -spherical}, {3, -spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell["Compute Christoffels:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AllComponentValues", "[", 
  RowBox[{
   RowBox[{"Christoffel", "[", 
    RowBox[{"cd", ",", "PDspherical"}], "]"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"ChristoffelcdPDspherical", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   ChristoffelcdPDspherical[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "3", "2"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "3", "2"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {3, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
        2, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"2", "3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
        3, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "2", "2"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
        2, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "2", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {3, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         StyleBox[
          RowBox[{"3", "3", "3"}],
          FontColor->RGBColor[1, 0, 0]], "   "],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, -spherical}, {3, -spherical}, {
        3, -spherical}],
       Editable->False]}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{"gamma", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["\[Gamma]", 
    StyleBox[
     RowBox[{"a", "b"}],
     FontColor->RGBColor[1, 0, 0]], "  "],
   AutoSpacing->False],
  gamma[{-a, -spherical}, {-b, -spherical}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"SeparateBasis", "[", "AIndex", "]"}], "[", "tmp", "]"}], "-", 
   "tmp"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["a",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "c"}]],
     AutoSpacing->False],
    Basis[{-a, -spherical}, c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "d"}]],
     AutoSpacing->False],
    Basis[{-b, -spherical}, d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "cd", "  "],
     AutoSpacing->False],
    gamma[-c, -d],
    Editable->False]}], "-", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Gamma]", 
     StyleBox[
      RowBox[{"a", "b"}],
      FontColor->RGBColor[1, 0, 0]], "  "],
    AutoSpacing->False],
   gamma[{-a, -spherical}, {-b, -spherical}],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{"cd", "[", 
    RowBox[{"-", "e"}], "]"}], "[", "tmp", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "d"}]],
     AutoSpacing->False],
    Basis[{-b, -spherical}, d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"D", ",", 
        StyleBox["\[ScriptCapitalD]",
         FontColor->RGBColor[1, 0, 0]]}], "]"}], 
      RowBox[{" ", 
       RowBox[{"e", 
        StyleBox["a",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{"c", "  "}]],
     AutoSpacing->False],
    ChristoffelcdPDspherical[c, -e, {-a, -spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "cd", "  "],
     AutoSpacing->False],
    gamma[-c, -d],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["a",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "c"}]],
     AutoSpacing->False],
    Basis[{-a, -spherical}, c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"D", ",", 
        StyleBox["\[ScriptCapitalD]",
         FontColor->RGBColor[1, 0, 0]]}], "]"}], 
      RowBox[{" ", 
       RowBox[{"e", 
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{"d", "  "}]],
     AutoSpacing->False],
    ChristoffelcdPDspherical[d, -e, {-b, -spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "cd", "  "],
     AutoSpacing->False],
    gamma[-c, -d],
    Editable->False]}], "-", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Gamma]", 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]], 
      RowBox[{
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]], ":", "e"}]}], "    "],
    AutoSpacing->False],
   cd[-e][
    gamma[{-a, -spherical}, {-b, -spherical}]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{"tmp", "//", "ContractMetric"}], "//", 
   "ContractBasis"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     RowBox[{"\[CapitalGamma]", "[", 
      RowBox[{"D", ",", 
       StyleBox["\[ScriptCapitalD]",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]], "e", 
      StyleBox["b",
       FontColor->RGBColor[1, 0, 0]]}], "   "],
    AutoSpacing->False],
   ChristoffelcdPDspherical[{-a, -spherical}, -e, {-b, -spherical}],
   Editable->False], "+", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     RowBox[{"\[CapitalGamma]", "[", 
      RowBox[{"D", ",", 
       StyleBox["\[ScriptCapitalD]",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], 
     RowBox[{
      StyleBox["b",
       FontColor->RGBColor[1, 0, 0]], "e", 
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]]}], "   "],
    AutoSpacing->False],
   ChristoffelcdPDspherical[{-b, -spherical}, -e, {-a, -spherical}],
   Editable->False], "-", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Gamma]", 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]], 
      RowBox[{
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]], ":", "e"}]}], "    "],
    AutoSpacing->False],
   cd[-e][
    gamma[{-a, -spherical}, {-b, -spherical}]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{"tmp", "//", 
   RowBox[{"ToBasis", "[", "spherical", "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     RowBox[{"\[CapitalGamma]", "[", 
      RowBox[{"D", ",", 
       StyleBox["\[ScriptCapitalD]",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], 
     StyleBox[
      RowBox[{"a", "e", "b"}],
      FontColor->RGBColor[1, 0, 0]], "   "],
    AutoSpacing->False],
   ChristoffelcdPDspherical[{-a, -spherical}, {-e, -spherical}, {-b, -
     spherical}],
   Editable->False], "+", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     RowBox[{"\[CapitalGamma]", "[", 
      RowBox[{"D", ",", 
       StyleBox["\[ScriptCapitalD]",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], 
     StyleBox[
      RowBox[{"b", "e", "a"}],
      FontColor->RGBColor[1, 0, 0]], "   "],
    AutoSpacing->False],
   ChristoffelcdPDspherical[{-b, -spherical}, {-e, -spherical}, {-a, -
     spherical}],
   Editable->False], "-", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Gamma]", 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]], 
      RowBox[{
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]], ":", 
       StyleBox["e",
        FontColor->RGBColor[1, 0, 0]]}]}], "    "],
    AutoSpacing->False],
   cd[{-e, -spherical}][
    gamma[{-a, -spherical}, {-b, -spherical}]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ComponentArray", "[", "tmp", "]"}], "//", "ToValues"}], "//", 
   "Flatten"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
      2, -spherical}],
     Editable->False]}], ",", 
   RowBox[{"2", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"2", "2", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
      3, -spherical}],
     Editable->False]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"2", "2", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
      3, -spherical}],
     Editable->False], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"3", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
      2, -spherical}],
     Editable->False]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"2", "3", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
      3, -spherical}],
     Editable->False], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"3", "2", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
      3, -spherical}],
     Editable->False]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"2", "2", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
      3, -spherical}],
     Editable->False], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"3", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
      2, -spherical}],
     Editable->False]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"2", "3", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
      3, -spherical}],
     Editable->False], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"3", "2", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
      3, -spherical}],
     Editable->False]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
       3, -spherical}],
      Editable->False]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}]}], ",", 
   RowBox[{"2", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       StyleBox[
        RowBox[{"3", "3", "3"}],
        FontColor->RGBColor[1, 0, 0]], "   "],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{3, -spherical}, {3, -spherical}, {
      3, -spherical}],
     Editable->False]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Equal]", "0"}], "&"}], ",", "tmp"}], "]"}], ",", 
    RowBox[{"First", "/@", 
     RowBox[{"Last", "[", 
      RowBox[{"TensorValues", "[", "ChristoffelcdPDspherical", "]"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"2", "2", "2"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
       2, -spherical}],
      Editable->False], "\[Rule]", "0"}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"2", "2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", "0"}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"2", "3", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}]}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "2", "2"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
       2, -spherical}],
      Editable->False], "\[Rule]", "0"}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}]}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "3", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {3, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", "0"}]}], "}"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "/.", 
  RowBox[{"Rule", "\[Rule]", "ComponentValue"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"2", "2", "2"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
       2, -spherical}],
      Editable->False], "\[Rule]", "0"}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"2", "2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{2, -spherical}, {2, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", "0"}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"2", "3", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{2, -spherical}, {3, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}]}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "2", "2"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
       2, -spherical}],
      Editable->False], "\[Rule]", "0"}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "2", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {2, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}]}], ",", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"3", "3", "3"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{3, -spherical}, {3, -spherical}, {
       3, -spherical}],
      Editable->False], "\[Rule]", "0"}]}], "}"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeComponents", "[", 
  RowBox[{
   RowBox[{"ChristoffelcdPDspherical", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "spherical"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "b"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "c"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"ChristoffelcdPDspherical", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "b"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "c"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       RowBox[{" ", 
        StyleBox[
         RowBox[{"b", "c"}],
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{
        StyleBox["a",
         FontColor->RGBColor[1, 0, 0]], "  "}]],
      AutoSpacing->False],
     ChristoffelcdPDspherical[{
      a, spherical}, {-b, -spherical}, {-c, -spherical}],
     Editable->False]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        StyleBox[
         RowBox[{"d", "b", "c"}],
         FontColor->RGBColor[1, 0, 0]], "   "],
       AutoSpacing->False],
      ChristoffelcdPDspherical[{-d, -spherical}, {-b, -spherical}, {-c, -
        spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", "  ", 
        StyleBox[
         RowBox[{"a", "d"}],
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      gamma[{a, spherical}, {d, spherical}],
      Editable->False]}], "\[InvisibleSpace]", "\<\" in \"\>", 
    "\[InvisibleSpace]", "0.049843`5.149149167681504", 
    "\[InvisibleSpace]", "\<\" Seconds\"\>"}]}],
  SequenceForm[
  "Computed ", 
   ChristoffelcdPDspherical[{
     a, spherical}, {-b, -spherical}, {-c, -spherical}] -> 
   ChristoffelcdPDspherical[{-d, -spherical}, {-b, -spherical}, {-c, -
       spherical}] gamma[{a, spherical}, {d, spherical}], " in ", 
   0.049843`5.149149167681504, " Seconds"],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"3", "2"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"3", "2"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"2", "2"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"3", "3"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}]}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"2", "2"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
        2, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"2", "3"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cot",
         AutoSpacing->False],
        Cot,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"D", ",", 
           StyleBox["\[ScriptCapitalD]",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], 
         RowBox[{" ", 
          StyleBox[
           RowBox[{"3", "3"}],
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], "  "}]],
        AutoSpacing->False],
       ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
        3, -spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Note that the spherical basis is not normalized (because it is a coordinate \
chart):\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], 
  RowBox[{"Basis", "[", 
   RowBox[{"a", ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
  RowBox[{"Basis", "[", 
   RowBox[{"b", ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "a"}]],
    AutoSpacing->False],
   Basis[{3, -spherical}, a],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "b"}]],
    AutoSpacing->False],
   Basis[{3, -spherical}, b],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Gamma]", "ab", "  "],
    AutoSpacing->False],
   gamma[-a, -b],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//", "ContractBasis"}], "//", "ToValues"}]], "Input"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], "2"]], "Output"]
}, Open  ]],

Cell["\<\
Transformation between spherical and Cartesian charts. Instead of defining a \
new chart, we define the Cartesian chart as the DefaultChart. Note the trick \
of using 3 coordinate values rather than 2:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"change", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"r", "[", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"y", "[", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"r", "[", "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"z", "[", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"r", "[", "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"spherical", "/:", 
   RowBox[{"CNumbersOf", "[", 
    RowBox[{"spherical", ",", "TangentS2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cartesian", "/:", 
   RowBox[{"CNumbersOf", "[", 
    RowBox[{"cartesian", ",", "TangentS2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Compute relevant matrices for the change of basis:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"changeL", "=", 
   RowBox[{"ComponentArray", "[", 
    RowBox[{"Basis", ",", 
     RowBox[{"{", 
      RowBox[{"cartesian", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{1, -spherical}, {1, cartesian}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, {1, cartesian}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, {1, cartesian}],
       Editable->False]},
     {
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{1, -spherical}, {2, cartesian}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, {2, cartesian}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, {2, cartesian}],
       Editable->False]},
     {
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{1, -spherical}, {3, cartesian}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, {3, cartesian}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, {3, cartesian}],
       Editable->False]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"changeLinv", "=", 
   RowBox[{"ComponentArray", "[", 
    RowBox[{"Basis", ",", 
     RowBox[{"{", 
      RowBox[{"spherical", ",", 
       RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{1, -cartesian}, {1, spherical}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{2, -cartesian}, {1, spherical}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{3, -cartesian}, {1, spherical}],
       Editable->False]},
     {
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{1, -cartesian}, {2, spherical}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{2, -cartesian}, {2, spherical}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{3, -cartesian}, {2, spherical}],
       Editable->False]},
     {
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{1, -cartesian}, {3, spherical}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{2, -cartesian}, {3, spherical}],
       Editable->False], 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{3, -cartesian}, {3, spherical}],
       Editable->False]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sphericalcoordinates", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Coordinate", "[", 
      RowBox[{"i", ",", "spherical"}], "]"}], "[", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cartesiancoordinates", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Coordinate", "[", 
       RowBox[{"i", ",", "cartesian"}], "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "/.", "change"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["r", "", ""],
     AutoSpacing->False],
    r[],
    Editable->False], ",", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], ",", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Phi]", "", ""],
     AutoSpacing->False],
    \[Phi][],
    Editable->False]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False], "]"}], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["r", "", ""],
      AutoSpacing->False],
     r[],
     Editable->False], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["r", "", ""],
      AutoSpacing->False],
     r[],
     Editable->False], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["r", "", ""],
      AutoSpacing->False],
     r[],
     Editable->False]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"changeR", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"D", ",", "cartesiancoordinates", ",", "sphericalcoordinates"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"changeRinv", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "changeR", "]"}], "]"}]}], "]"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]}], 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}], 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}], 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]},
     {
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}], 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]], 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox["Csc",
            AutoSpacing->False],
           Csc,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}], 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Csc",
           AutoSpacing->False],
          Csc,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}]}], 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell["Equate them:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{"changeL", ",", "changeR"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{1, -spherical}, {1, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, {1, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, {1, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{1, -spherical}, {2, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, {2, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, {2, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{1, -spherical}, {3, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, {3, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]]}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, {3, cartesian}],
       Editable->False], "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{"changeLinv", ",", "changeRinv"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{1, -cartesian}, {1, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{2, -cartesian}, {1, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["1",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{3, -cartesian}, {1, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{1, -cartesian}, {2, spherical}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{2, -cartesian}, {2, spherical}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{3, -cartesian}, {2, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["1",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{1, -cartesian}, {3, spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox["Csc",
            AutoSpacing->False],
           Csc,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}], 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["r", "", ""],
          AutoSpacing->False],
         r[],
         Editable->False]]}]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{2, -cartesian}, {3, spherical}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Csc",
           AutoSpacing->False],
          Csc,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}]}], 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["r", "", ""],
         AutoSpacing->False],
        r[],
        Editable->False]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[0, 0, 1]], " "}], 
         RowBox[{" ", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]],
        AutoSpacing->False],
       Basis[{3, -cartesian}, {3, spherical}],
       Editable->False], "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "[", "]"}], ":=", "1"}]], "Input",
 InitializationCell->True],

Cell["Identity in the spherical basis:", "Text"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"identity", ",", "Orderless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"identity", "[", 
   RowBox[{"a_Symbol", ",", 
    RowBox[{"-", "b_Symbol"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "spherical"}], "}"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "spherical"}], "}"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "spherical"}], "}"}]}], "]"}]}]}]}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"identity", "[", 
  RowBox[{
   RowBox[{"-", "b"}], ",", "a"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {1, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["1",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{1, -spherical}, a],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, a],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False]}]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3.3. Complex basis vectors", "Subsubsection"],

Cell["Then we have the complex basis vectors", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"m", "[", "a", "]"}], ",", "S2"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"m", "[", "a", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   m[a], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"mbar", "[", "a", "]"}], ",", "S2", ",", 
   RowBox[{"PrintAs", "->", "\"\<\!\(\*OverscriptBox[\(m\), \(_\)]\)\>\""}]}],
   "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"mbar", "[", "a", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   mbar[a], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell["Orthogonality properties:", "Text"],

Cell[BoxData[{
 RowBox[{"m", "/:", 
  RowBox[{
   RowBox[{"m", "[", "a_", "]"}], 
   RowBox[{"m", "[", 
    RowBox[{"-", "a_"}], "]"}]}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"mbar", "/:", 
  RowBox[{
   RowBox[{"mbar", "[", "a_", "]"}], 
   RowBox[{"mbar", "[", 
    RowBox[{"-", "a_"}], "]"}]}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"mbar", "/:", 
  RowBox[{
   RowBox[{"m", "[", "a_", "]"}], 
   RowBox[{"mbar", "[", 
    RowBox[{"-", "a_"}], "]"}]}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"m", "/:", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"-", "a_"}], "]"}], 
   RowBox[{"mbar", "[", "a_", "]"}]}], ":=", "1"}]}], "Input",
 InitializationCell->True],

Cell["Components in the coordinated spherical basis:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{"ComponentArray", "[", 
    RowBox[{"m", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "spherical"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     FractionBox[
      RowBox[{"I", " ", 
       RowBox[{"Csc", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}]}], 
      SqrtBox["2"]]}], "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", 
       StyleBox["1",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     m[{1, spherical}],
     Editable->False], "\[Rule]", "0"}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     m[{2, spherical}],
     Editable->False], "\[Rule]", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     m[{3, spherical}],
     Editable->False], "\[Rule]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], 
     SqrtBox["2"]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeComponents", "[", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}], "]"}], ",", 
   RowBox[{"m", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "spherical"}], "}"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", 
       StyleBox["a",
        FontColor->RGBColor[1, 0, 0]], " "],
      AutoSpacing->False],
     m[{-a, -spherical}],
     Editable->False], "\[Rule]", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox[
         RowBox[{"b", "a"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      gamma[{-b, -spherical}, {-a, -spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", 
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      m[{b, spherical}],
      Editable->False]}]}], "\[InvisibleSpace]", "\<\" in \"\>", 
   "\[InvisibleSpace]", "0.020898`4.771649718337857", 
   "\[InvisibleSpace]", "\<\" Seconds\"\>"}],
  SequenceForm[
  "Computed ", m[{-a, -spherical}] -> 
   gamma[{-b, -spherical}, {-a, -spherical}] m[{b, spherical}], " in ", 
   0.020898`4.771649718337857, " Seconds"],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", 
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], " "],
        AutoSpacing->False],
       m[{1, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "],
        AutoSpacing->False],
       m[{2, -spherical}],
       Editable->False], "\[Rule]", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", 
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "],
        AutoSpacing->False],
       m[{3, -spherical}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}]}], 
       SqrtBox["2"]]}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{"ComponentArray", "[", 
    RowBox[{"mbar", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "spherical"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"I", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}]}], 
       SqrtBox["2"]]}]}], "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", 
       StyleBox["1",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     mbar[{1, spherical}],
     Editable->False], "\[Rule]", "0"}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     mbar[{2, spherical}],
     Editable->False], "\[Rule]", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     mbar[{3, spherical}],
     Editable->False], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Csc",
          AutoSpacing->False],
         Csc,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], 
      SqrtBox["2"]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeComponents", "[", 
  RowBox[{
   RowBox[{"mbar", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}], "]"}], ",", 
   RowBox[{"mbar", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "spherical"}], "}"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], 
       StyleBox["a",
        FontColor->RGBColor[1, 0, 0]], " "],
      AutoSpacing->False],
     mbar[{-a, -spherical}],
     Editable->False], "\[Rule]", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox[
         RowBox[{"b", "a"}],
         FontColor->RGBColor[1, 0, 0]], "  "],
       AutoSpacing->False],
      gamma[{-b, -spherical}, {-a, -spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", 
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]]],
       AutoSpacing->False],
      mbar[{b, spherical}],
      Editable->False]}]}], "\[InvisibleSpace]", "\<\" in \"\>", 
   "\[InvisibleSpace]", "0.020322`4.759511440524248", 
   "\[InvisibleSpace]", "\<\" Seconds\"\>"}],
  SequenceForm[
  "Computed ", mbar[{-a, -spherical}] -> 
   gamma[{-b, -spherical}, {-a, -spherical}] mbar[{b, spherical}], " in ", 
   0.020322`4.759511440524248, " Seconds"],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], 
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], " "],
        AutoSpacing->False],
       mbar[{1, -spherical}],
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "],
        AutoSpacing->False],
       mbar[{2, -spherical}],
       Editable->False], "\[Rule]", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], 
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "],
        AutoSpacing->False],
       mbar[{3, -spherical}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}]}], 
        SqrtBox["2"]]}]}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"m", "/:", 
  RowBox[{
   RowBox[{"m", "[", "a_", "]"}], 
   RowBox[{"Basis", "[", 
    RowBox[{
     RowBox[{"-", "a_"}], ",", 
     RowBox[{"{", 
      RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
  RowBox[{"m", "[", 
   RowBox[{"{", 
    RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"m", "/:", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"-", "a_"}], "]"}], 
   RowBox[{"Basis", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"{", 
      RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
  RowBox[{"m", "[", 
   RowBox[{"{", 
    RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"mbar", "/:", 
  RowBox[{
   RowBox[{"mbar", "[", "a_", "]"}], 
   RowBox[{"Basis", "[", 
    RowBox[{
     RowBox[{"-", "a_"}], ",", 
     RowBox[{"{", 
      RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
  RowBox[{"mbar", "[", 
   RowBox[{"{", 
    RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"mbar", "/:", 
  RowBox[{
   RowBox[{"mbar", "[", 
    RowBox[{"-", "a_"}], "]"}], 
   RowBox[{"Basis", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"{", 
      RowBox[{"b_", ",", "spherical"}], "}"}]}], "]"}]}], ":=", 
  RowBox[{"mbar", "[", 
   RowBox[{"{", 
    RowBox[{"b", ",", "spherical"}], "}"}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeComponents", "[", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "cartesian"}], "}"}], "]"}], ",", 
   RowBox[{"m", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "spherical"}], "}"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", 
       StyleBox["a",
        FontColor->RGBColor[0, 0, 1]]],
      AutoSpacing->False],
     m[{a, cartesian}],
     Editable->False]}], "\[Rule]", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["a",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{-b, -spherical}, {a, cartesian}],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", 
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]]],
      AutoSpacing->False],
     m[{b, spherical}],
     Editable->False], "\[InvisibleSpace]", "\<\" in \"\>", 
    "\[InvisibleSpace]", "0.05807`5.2154968195293", 
    "\[InvisibleSpace]", "\<\" Seconds\"\>"}]}],
  SequenceForm[
  "Computed ", m[{a, cartesian}] -> 
   Basis[{-b, -spherical}, {a, cartesian}] m[{b, spherical}], " in ", 
   0.05807`5.2154968195293, " Seconds"],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", " ", 
         StyleBox["1",
          FontColor->RGBColor[0, 0, 1]]],
        AutoSpacing->False],
       m[{1, cartesian}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", " ", 
         StyleBox["2",
          FontColor->RGBColor[0, 0, 1]]],
        AutoSpacing->False],
       m[{2, cartesian}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", " ", 
         StyleBox["3",
          FontColor->RGBColor[0, 0, 1]]],
        AutoSpacing->False],
       m[{3, cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], 
        SqrtBox["2"]]}]}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeComponents", "[", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "cartesian"}]}], "}"}], "]"}], ",", 
   RowBox[{"m", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"Computed \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", 
       StyleBox["a",
        FontColor->RGBColor[0, 0, 1]], " "],
      AutoSpacing->False],
     m[{-a, -cartesian}],
     Editable->False]}], "\[Rule]", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["a",
         FontColor->RGBColor[0, 0, 1]], " "}], 
       RowBox[{" ", 
        StyleBox["b",
         FontColor->RGBColor[1, 0, 0]]}]],
      AutoSpacing->False],
     Basis[{-a, -cartesian}, {b, spherical}],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", 
       StyleBox["b",
        FontColor->RGBColor[1, 0, 0]], " "],
      AutoSpacing->False],
     m[{-b, -spherical}],
     Editable->False], "\[InvisibleSpace]", "\<\" in \"\>", 
    "\[InvisibleSpace]", "0.018598`4.721011236871663", 
    "\[InvisibleSpace]", "\<\" Seconds\"\>"}]}],
  SequenceForm[
  "Computed ", m[{-a, -cartesian}] -> 
   Basis[{-a, -cartesian}, {b, spherical}] m[{-b, -spherical}], " in ", 
   0.018598`4.721011236871663, " Seconds"],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"FoldedRule", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", 
         StyleBox["1",
          FontColor->RGBColor[0, 0, 1]], " "],
        AutoSpacing->False],
       m[{1, -cartesian}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", 
         StyleBox["2",
          FontColor->RGBColor[0, 0, 1]], " "],
        AutoSpacing->False],
       m[{2, -cartesian}],
       Editable->False], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "]"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False], "]"}]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", 
         StyleBox["3",
          FontColor->RGBColor[0, 0, 1]], " "],
        AutoSpacing->False],
       m[{3, -cartesian}],
       Editable->False], "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], 
        SqrtBox["2"]]}]}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"TraceBasisDummy", "[", 
    RowBox[{
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "spherical"}], "}"}], "]"}], 
     RowBox[{"Basis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}]}], "]"}], 
   "]"}], "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"D", ",", 
        StyleBox["\[ScriptCapitalD]",
         FontColor->RGBColor[1, 0, 0]]}], "]"}], 
      RowBox[{" ", 
       RowBox[{"a", 
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{"b", "  "}]],
     AutoSpacing->False],
    ChristoffelcdPDspherical[b, -a, {2, -spherical}],
    Editable->False], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"D", ",", 
         StyleBox["\[ScriptCapitalD]",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], 
       RowBox[{" ", 
        RowBox[{"a", 
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]]}]}], 
       RowBox[{"b", "  "}]],
      AutoSpacing->False],
     ChristoffelcdPDspherical[b, -a, {3, -spherical}],
     Editable->False], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Csc",
       AutoSpacing->False],
      Csc,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{"a", " "}], 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]]}]],
      AutoSpacing->False],
     Basis[-a, {2, spherical}],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["3",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", "b"}]],
      AutoSpacing->False],
     Basis[{3, -spherical}, b],
     Editable->False], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cot",
       AutoSpacing->False],
      Cot,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Csc",
       AutoSpacing->False],
      Csc,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   SqrtBox["2"]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "spherical"}], "}"}]}], "]"}], "%"}], "//", 
   "ContractBasis"}], "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   SqrtBox["2"]]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3.4. Products of m, mbar", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mmbarRule", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"mbar", "[", "a_", "]"}], 
    RowBox[{"m", "[", "b_", "]"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gamma", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"epsilongamma", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}]}], ")"}], "/", "2"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", 
      UnderscriptBox["b", "_"]],
     AutoSpacing->False],
    m[
     Pattern[b, 
      Blank[]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", 
      UnderscriptBox["a", "_"]],
     AutoSpacing->False],
    mbar[
     Pattern[a, 
      Blank[]]],
    Editable->False]}], "\[Rule]", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ab"],
        AutoSpacing->False],
       epsilongamma[a, b],
       Editable->False]}], "+", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Gamma]", "  ", "ab"],
       AutoSpacing->False],
      gamma[a, b],
      Editable->False]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mbar", "[", "a", "]"}], 
  RowBox[{"mbar", "[", "c", "]"}], 
  RowBox[{"mbar", "[", "e", "]"}], 
  RowBox[{"mbar", "[", "f1", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     OverscriptBox["m", "_"], " ", "a"],
    AutoSpacing->False],
   mbar[a],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     OverscriptBox["m", "_"], " ", "c"],
    AutoSpacing->False],
   mbar[c],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     OverscriptBox["m", "_"], " ", "e"],
    AutoSpacing->False],
   mbar[e],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     OverscriptBox["m", "_"], "  ", "f1"],
    AutoSpacing->False],
   mbar[f1],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mbar", "[", "a", "]"}], 
   RowBox[{"m", "[", "c", "]"}], 
   RowBox[{"mbar", "[", "e", "]"}], 
   RowBox[{"m", "[", "f1", "]"}]}], "/.", "mmbarRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ac"],
       AutoSpacing->False],
      epsilongamma[a, c],
      Editable->False]}], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", "  ", "ac"],
      AutoSpacing->False],
     gamma[a, c],
     Editable->False]}], ")"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["m", "  ", "f1"],
    AutoSpacing->False],
   m[f1],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox[
     OverscriptBox["m", "_"], " ", "e"],
    AutoSpacing->False],
   mbar[e],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mbar", "[", "a", "]"}], 
   RowBox[{"m", "[", "c", "]"}], 
   RowBox[{"mbar", "[", "e", "]"}], 
   RowBox[{"m", "[", "f1", "]"}]}], "//.", "mmbarRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ac"],
       AutoSpacing->False],
      epsilongamma[a, c],
      Editable->False]}], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", "  ", "ac"],
      AutoSpacing->False],
     gamma[a, c],
     Editable->False]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]\[Gamma]", "   ", "ef1"],
       AutoSpacing->False],
      epsilongamma[e, f1],
      Editable->False]}], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Gamma]", "   ", "ef1"],
      AutoSpacing->False],
     gamma[e, f1],
     Editable->False]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]\[Gamma]", "   ", "ef1"],
     AutoSpacing->False],
    epsilongamma[e, f1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "  ", "ac"],
     AutoSpacing->False],
    gamma[a, c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "   ", "af1"],
     AutoSpacing->False],
    gamma[a, f1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "  ", "ce"],
     AutoSpacing->False],
    gamma[c, e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "  ", "ae"],
     AutoSpacing->False],
    gamma[a, e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "   ", "cf1"],
     AutoSpacing->False],
    gamma[c, f1],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ac"],
     AutoSpacing->False],
    epsilongamma[a, c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "   ", "ef1"],
     AutoSpacing->False],
    gamma[e, f1],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "  ", "ac"],
     AutoSpacing->False],
    gamma[a, c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "   ", "ef1"],
     AutoSpacing->False],
    gamma[e, f1],
    Editable->False]}]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3.5. Orbital basis vectors", "Subsubsection"],

Cell["\<\
Again, we define the basis tensor with an arbitrary number of indices:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"Orbitalt", "[", 
    RowBox[{
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", "S2", ",", 
   RowBox[{"PrintAs", "->", "\"\<t\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"Orbitalt", "[", 
    RowBox[{
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   Orbitalt[
    LI[m], 
    AnyIndices[TangentS2]], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "Orbitalt"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Orbitalt[LI[m], a] are the complex Cartesian vectors. \
Orbitalt[LI[m], a1, ..., as] are the complex Cartesian tensors obtained by \
combination of the former.\"\>"], "Print",
 CellTags->"Info3467289667-4776147"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         InterpretationBox[
          StyleBox[
           RowBox[{"Dagger", "[", "Orbitalt", "]"}],
           AutoSpacing->False],
          Dagger[Orbitalt],
          Editable->False], "^=", "Orbitalt"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"DependenciesOfTensor", "[", "Orbitalt", "]"}], "^=", 
         RowBox[{"{", "S2", "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"HostsOf", "[", "Orbitalt", "]"}], "^=", 
         RowBox[{"{", 
          RowBox[{"S2", ",", "TangentS2"}], "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"Info", "[", "Orbitalt", "]"}], "^=", 
         RowBox[{"{", 
          RowBox[{"\<\"tensor\"\>", ",", "\<\"\"\>"}], "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"PrintAs", "[", "Orbitalt", "]"}], "^=", "\<\"t\"\>"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"SlotsOfTensor", "[", "Orbitalt", "]"}], "^=", 
         RowBox[{"{", 
          RowBox[{"Labels", ",", 
           RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"TensorID", "[", "Orbitalt", "]"}], "^=", 
         RowBox[{"{", "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"xTensorQ", "[", "Orbitalt", "]"}], "^=", "True"}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition["Orbitalt"],
  Editable->False]], "Print",
 CellTags->"Info3467289667-4776147"]
}, Open  ]]
}, Open  ]],

Cell["They are STF tensors:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SymmetryGroupOfTensor", "[", 
   RowBox[{"Orbitalt", "[", 
    RowBox[{"_LI", ",", "indices__"}], "]"}], "]"}], "^:=", 
  RowBox[{"Symmetric", "[", 
   RowBox[{"1", "+", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", 
      RowBox[{"{", "indices", "}"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Orbitalt", "[", 
   RowBox[{"_LI", ",", "___", ",", "a_", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", "0"}], "\n", 
 RowBox[{
  RowBox[{"Orbitalt", "[", 
   RowBox[{"_LI", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=", 
  "0"}]}], "Input"],

Cell["Define Cartesian components:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "cartesian"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "I"}], ",", "0"}], "}"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "I"}], ",", "0"}], "}"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "0", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "cartesian"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "0", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "cartesian"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "I"}], ",", "0"}], "}"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "I"}], ",", "0"}], "}"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell["Components of the vectors in the spherical chart:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "spherical"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
        RowBox[{"I", " ", 
         RowBox[{"Csc", "[", 
          RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], "}"}]}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
        RowBox[{"I", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], "}"}]}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "0", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "spherical"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}]}], ",", "0"}], "}"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "0", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}]}], ",", "0"}], "}"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "spherical"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], "}"}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], "}"}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], "]"}], ";"}]}], "Input"],

Cell["Arbitrary number of indices, in any chart:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Orbitalt", "[", 
   RowBox[{
    RowBox[{"LI", "[", "m_Integer", "]"}], ",", 
    RowBox[{"first", ":", 
     RowBox[{"{", 
      RowBox[{"_Integer", ",", "basis_"}], "}"}]}], ",", 
    RowBox[{"seq", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_Integer", ",", "basis_"}], "}"}], ".."}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"{", 
         RowBox[{"first", ",", "seq"}], "}"}], "]"}]}], ",", 
      RowBox[{"perms", "=", 
       RowBox[{"Permutations", "[", 
        RowBox[{"{", 
         RowBox[{"first", ",", "seq"}], "}"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ClebschGordan", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "mp"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "-", "1"}], ",", 
           RowBox[{"m", "-", "mp"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "m"}], "}"}]}], "]"}], 
       RowBox[{
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Orbitalt", "[", 
               RowBox[{
                RowBox[{"LI", "[", "mp", "]"}], ",", 
                RowBox[{"First", "[", "#", "]"}]}], "]"}], 
              RowBox[{"Orbitalt", "[", 
               RowBox[{
                RowBox[{"LI", "[", 
                 RowBox[{"m", "-", "mp"}], "]"}], ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Rest", "[", "#", "]"}]}]}], "]"}]}], ")"}], "&"}], "/@",
            "perms"}], ")"}]}], "/", 
        RowBox[{"Length", "[", "perms", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"mp", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"ClebschGordan", "::", "phy"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Orbitalt", "[", 
    RowBox[{
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], 
   RowBox[{"Basis", "[", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "//", 
  "ContractBasis"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["t", 
    RowBox[{" ", 
     RowBox[{"a", 
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]]}]}], 
    RowBox[{"2", "  "}]],
   AutoSpacing->False],
  Orbitalt[
   LI[2], -a, {2, -spherical}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", 
   RowBox[{"Basis", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "//", 
  "ContractBasis"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["t", 
     RowBox[{" ", 
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]]}], 
     RowBox[{"1", " "}]],
    AutoSpacing->False],
   Orbitalt[
    LI[1], {2, -spherical}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["t", 
     RowBox[{" ", 
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]]}], 
     RowBox[{"1", " "}]],
    AutoSpacing->False],
   Orbitalt[
    LI[1], {3, -spherical}],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Cos",
     AutoSpacing->False],
    Cos,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}]}]], "Output"]
}, Open  ]],

Cell["All components:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Orbitalt", "[", 
    RowBox[{
     RowBox[{"LI", "[", "mm", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mm", ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{
        RowBox[{"-", "1"}], " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[-1], {2, -spherical}],
     Editable->False], "3"], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["t", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          RowBox[{"-", "1"}], " "}]],
        AutoSpacing->False],
       Orbitalt[
        LI[-1], {2, -spherical}],
       Editable->False], "2"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{"0", " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[0], {2, -spherical}],
      Editable->False]}], 
    SqrtBox["3"]], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["t", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          RowBox[{"-", "1"}], " "}]],
        AutoSpacing->False],
       Orbitalt[
        LI[-1], {2, -spherical}],
       Editable->False], " ", 
      SuperscriptBox[
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["t", 
          RowBox[{" ", 
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{"0", " "}]],
         AutoSpacing->False],
        Orbitalt[
         LI[0], {2, -spherical}],
        Editable->False], "2"]}], 
     SqrtBox["15"]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["t", 
          RowBox[{" ", 
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{
           RowBox[{"-", "1"}], " "}]],
         AutoSpacing->False],
        Orbitalt[
         LI[-1], {2, -spherical}],
        Editable->False], "2"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["t", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{"1", " "}]],
        AutoSpacing->False],
       Orbitalt[
        LI[1], {2, -spherical}],
       Editable->False]}], 
     SqrtBox["15"]], "+", 
    RowBox[{
     SqrtBox[
      FractionBox["2", "5"]], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{
         RowBox[{"-", "1"}], " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[-1], {2, -spherical}],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{"0", " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[0], {2, -spherical}],
          Editable->False], "2"]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{
             RowBox[{"-", "1"}], " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[-1], {2, -spherical}],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{"1", " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[1], {2, -spherical}],
          Editable->False]}], 
        SqrtBox["6"]]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox[
      FractionBox["2", "5"]], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{
         RowBox[{"-", "1"}], " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[-1], {2, -spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{"0", " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[0], {2, -spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{"1", " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[1], {2, -spherical}],
      Editable->False]}], "+", 
    RowBox[{
     SqrtBox[
      FractionBox["3", "5"]], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{"0", " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[0], {2, -spherical}],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{"0", " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[0], {2, -spherical}],
          Editable->False], "2"]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{
             RowBox[{"-", "1"}], " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[-1], {2, -spherical}],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{"1", " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[1], {2, -spherical}],
          Editable->False]}], 
        SqrtBox["6"]]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", 
      SuperscriptBox[
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["t", 
          RowBox[{" ", 
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{"0", " "}]],
         AutoSpacing->False],
        Orbitalt[
         LI[0], {2, -spherical}],
        Editable->False], "2"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["t", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{"1", " "}]],
        AutoSpacing->False],
       Orbitalt[
        LI[1], {2, -spherical}],
       Editable->False]}], 
     SqrtBox["15"]], "+", 
    FractionBox[
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["t", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{
          RowBox[{"-", "1"}], " "}]],
        AutoSpacing->False],
       Orbitalt[
        LI[-1], {2, -spherical}],
       Editable->False], " ", 
      SuperscriptBox[
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["t", 
          RowBox[{" ", 
           StyleBox["2",
            FontColor->RGBColor[1, 0, 0]]}], 
          RowBox[{"1", " "}]],
         AutoSpacing->False],
        Orbitalt[
         LI[1], {2, -spherical}],
        Editable->False], "2"]}], 
     SqrtBox["15"]], "+", 
    RowBox[{
     SqrtBox[
      FractionBox["2", "5"]], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{"1", " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[1], {2, -spherical}],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{"0", " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[0], {2, -spherical}],
          Editable->False], "2"]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{
             RowBox[{"-", "1"}], " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[-1], {2, -spherical}],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["t", 
            RowBox[{" ", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}], 
            RowBox[{"1", " "}]],
           AutoSpacing->False],
          Orbitalt[
           LI[1], {2, -spherical}],
          Editable->False]}], 
        SqrtBox["6"]]}], ")"}]}]}], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["t", 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}], 
        RowBox[{"0", " "}]],
       AutoSpacing->False],
      Orbitalt[
       LI[0], {2, -spherical}],
      Editable->False], " ", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["t", 
         RowBox[{" ", 
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]]}], 
         RowBox[{"1", " "}]],
        AutoSpacing->False],
       Orbitalt[
        LI[1], {2, -spherical}],
       Editable->False], "2"]}], 
    SqrtBox["3"]], ",", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {2, -spherical}],
     Editable->False], "3"]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//", "ToValues"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Phi]", "", ""],
         AutoSpacing->False],
        \[Phi][],
        Editable->False]}]], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "3"]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    SqrtBox["3"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SqrtBox[
     FractionBox["3", "10"]], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"5", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], "+", 
     RowBox[{"5", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}], 
    RowBox[{"4", " ", 
     SqrtBox["10"]}]], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SqrtBox[
     FractionBox["3", "10"]], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"5", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    SqrtBox["3"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False]}]], " ", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], "3"]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["At the poles we have:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"northpole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"southpole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", "]"}], "\[Rule]", "Pi"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "\[Rule]", "0"}]}], "}"}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"-", 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}]}]}], "]"}], "/.", 
  "northpole"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"-", 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}]}]}], "]"}], "/.", 
  "northpole"}]}], "Input"],

Cell[BoxData["True"], "Output"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"mbar", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}], "/.", 
  "northpole"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"mbar", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}], "/.", 
  "northpole"}]}], "Input"],

Cell[BoxData["True"], "Output"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"-", 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}]}]}], "]"}], "/.", 
  "southpole"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", 
       RowBox[{"-", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"-", 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}]}]}], "]"}], "/.", 
  "southpole"}]}], "Input"],

Cell[BoxData["True"], "Output"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"mbar", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}], "/.", 
  "southpole"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToValues", "[", 
   RowBox[{
    RowBox[{"Orbitalt", "[", 
     RowBox[{
      RowBox[{"LI", "[", "1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"mbar", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}], "/.", 
  "southpole"}]}], "Input"],

Cell[BoxData["True"], "Output"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["\<\
These three must coincide. Note the importance of the (-1)^s factor:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"ToValues", "[", 
     RowBox[{"Orbitalt", "[", 
      RowBox[{
       RowBox[{"LI", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "]"}], "/.", 
    "northpole"}], ",", 
   RowBox[{
    RowBox[{"ToValues", "[", 
     RowBox[{"Orbitalt", "[", 
      RowBox[{
       RowBox[{"LI", "[", 
        RowBox[{"-", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "]"}], "/.", 
    "southpole"}], ",", 
   RowBox[{"ToValues", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", "3"}], 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}], 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}], 
     RowBox[{"m", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], "]"}]}], "]"}]}], 
  "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["We can compute it also using the Cartesian components:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Orbitalt", "[", 
   RowBox[{
    RowBox[{"LI", "[", "3", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "cartesian"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "cartesian"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}], 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "cartesian"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", "cartesian"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", "cartesian"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", 
      StyleBox["a",
       FontColor->RGBColor[0, 0, 1]]}]],
    AutoSpacing->False],
   Basis[{2, -spherical}, {a, cartesian}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", 
      StyleBox["b",
       FontColor->RGBColor[0, 0, 1]]}]],
    AutoSpacing->False],
   Basis[{2, -spherical}, {b, cartesian}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", 
      StyleBox["c",
       FontColor->RGBColor[0, 0, 1]]}]],
    AutoSpacing->False],
   Basis[{2, -spherical}, {c, cartesian}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["t", 
     RowBox[{" ", 
      StyleBox[
       RowBox[{"a", "b", "c"}],
       FontColor->RGBColor[0, 0, 1]]}], 
     RowBox[{"3", "   "}]],
    AutoSpacing->False],
   Orbitalt[
    LI[3], {-a, -cartesian}, {-b, -cartesian}, {-c, -cartesian}],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraceBasisDummy", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["1",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {1, cartesian}],
     Editable->False], "3"], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["1",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {1, -cartesian}],
     Editable->False], "3"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["1",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {1, cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {2, cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["1",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {1, -cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {2, -cartesian}],
    Editable->False]}], "+", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {1, cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {2, cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {1, -cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {2, -cartesian}],
     Editable->False], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {2, cartesian}],
     Editable->False], "3"], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {2, -cartesian}],
     Editable->False], "3"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["1",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {1, cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {3, cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["1",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {1, -cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {3, -cartesian}],
    Editable->False]}], "+", 
  RowBox[{"6", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {1, cartesian}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {2, cartesian}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {3, cartesian}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {1, -cartesian}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {2, -cartesian}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {3, -cartesian}],
    Editable->False]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {2, cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {3, cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["2",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {2, -cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {3, -cartesian}],
    Editable->False]}], "+", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {1, cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["3",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {3, cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {1, -cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["3",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {3, -cartesian}],
     Editable->False], "2"]}], "+", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[0, 0, 1]]}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, {2, cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["3",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {3, cartesian}],
     Editable->False], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {2, -cartesian}],
    Editable->False], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["3",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {3, -cartesian}],
     Editable->False], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", 
        StyleBox["3",
         FontColor->RGBColor[0, 0, 1]]}]],
      AutoSpacing->False],
     Basis[{2, -spherical}, {3, cartesian}],
     Editable->False], "3"], " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["t", 
       RowBox[{" ", 
        StyleBox["3",
         FontColor->RGBColor[0, 0, 1]]}], 
       RowBox[{"1", " "}]],
      AutoSpacing->False],
     Orbitalt[
      LI[1], {3, -cartesian}],
     Editable->False], "3"]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "3"], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Phi]", "", ""],
         AutoSpacing->False],
        \[Phi][],
        Editable->False], "]"}], "3"]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "-", 
  FractionBox[
   RowBox[{"3", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False], "]"}], "2"], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False], "]"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "3"], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False], "]"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False], "]"}], "3"]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False]}], "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False]}], "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "northpole"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Orbitalt", "[", 
  RowBox[{
   RowBox[{"LI", "[", "3", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "cartesian"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "cartesian"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 SuperscriptBox[
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["t", 
     RowBox[{" ", 
      StyleBox["1",
       FontColor->RGBColor[0, 0, 1]]}], 
     RowBox[{"1", " "}]],
    AutoSpacing->False],
   Orbitalt[
    LI[1], {1, -cartesian}],
   Editable->False], "3"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output"]
}, Open  ]],

Cell["Cut and paste:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["t", 
      RowBox[{" ", 
       StyleBox["1",
        FontColor->RGBColor[0, 0, 1]]}], 
      RowBox[{"1", " "}]],
     AutoSpacing->False],
    Orbitalt[
     LI[1], {1, -cartesian}],
    Editable->False], "3"], "//", "InputForm"}]], "Input"],

Cell["Orbitalt[LI[1], {1, -cartesian}]^3", "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Spherical harmonics", "Subsection"],

Cell[CellGroupData[{

Cell["STF Spherical harmonics", "Subsubsection"],

Cell["Harmonic label:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "l", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefConstantSymbol", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"constant symbol \"\>", "\[InvisibleSpace]", "l", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefConstantSymbol, ": Defining ", "constant symbol ", l, ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell["Now we define the STF tensors.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", "S2"}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", 
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   Z[
    LI[l], 
    LI[m], 
    AnyIndices[TangentS2]], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", "S2"}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", 
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   X[
    LI[l], 
    LI[m], 
    AnyIndices[TangentS2]], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell["\<\
Common notation with a sign. Note the stupid exception for scalars:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"calZ", "[", 
    RowBox[{
     RowBox[{"LI", "[", "sign", "]"}], ",", 
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], ",", "S2", ",", 
   RowBox[{"PrintAs", "->", "\"\<\[GothicCapitalZ]\>\""}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"calZ", "[", 
    RowBox[{
     RowBox[{"LI", "[", "sign", "]"}], ",", 
     RowBox[{"LI", "[", 
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"AnyIndices", "[", "TangentS2", "]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "tensor ", 
   calZ[
    LI[sign], 
    LI[l], 
    LI[m], 
    AnyIndices[TangentS2]], ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{
    RowBox[{"LI", "[", "1", "]"}], ",", 
    RowBox[{"LI", "[", "l_", "]"}], ",", 
    RowBox[{"LI", "[", "m_", "]"}]}], "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{
    RowBox[{"LI", "[", "1", "]"}], ",", 
    RowBox[{"LI", "[", "l_", "]"}], ",", 
    RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "l", "]"}], ",", 
    RowBox[{"LI", "[", "m", "]"}], ",", "inds"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{
    RowBox[{"LI", "[", 
     RowBox[{"-", "1"}], "]"}], ",", 
    RowBox[{"LI", "[", "l_", "]"}], ",", 
    RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "I"}], " ", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", "inds"}], "]"}]}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{
    RowBox[{"LI", "[", 
     RowBox[{"c_.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"a_.", "+", 
         RowBox[{"2", "b_"}]}], ")"}]}]}], "]"}], ",", 
    RowBox[{"LI", "[", "l_", "]"}], ",", 
    RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
  RowBox[{"calZ", "[", 
   RowBox[{
    RowBox[{"LI", "[", 
     RowBox[{"c", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", "a"}]}], "]"}], ",", 
    RowBox[{"LI", "[", "l", "]"}], ",", 
    RowBox[{"LI", "[", "m", "]"}], ",", "inds"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{
    RowBox[{"LI", "[", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"x", "+", 
         RowBox[{"2", "y"}]}], ")"}]}]}], "]"}], ",", 
    RowBox[{"LI", "[", "l", "]"}], ",", 
    RowBox[{"LI", "[", "m", "]"}], ",", 
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", "InputForm"}]], "Input"],

Cell["calZ[LI[-(-1)^x], LI[l], LI[m], -a, -b]", "Output"]
}, Open  ]],

Cell["0) We need |m|\[LessEqual]l and s\[LessEqual]l:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z", "/:", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "inds", "}"}], "]"}], ">", "l"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "/:", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "inds", "}"}], "]"}], ">", "l"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calZ", "/:", 
   RowBox[{"calZ", "[", 
    RowBox[{
     RowBox[{"LI", "[", "sign_", "]"}], ",", 
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", "inds___"}], "]"}], ":=", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "inds", "}"}], "]"}], ">", "l"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["1) We introduce their symmetry properties:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryGroupOfTensor", "[", 
   RowBox[{"Z", "[", 
    RowBox[{"_LI", ",", "_LI", ",", "indices___"}], "]"}], "]"}], "^:=", 
  RowBox[{"Symmetric", "[", 
   RowBox[{
    RowBox[{"2", "+", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", 
       RowBox[{"{", "indices", "}"}]}]}]}], ",", "Cycles"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryGroupOfTensor", "[", 
   RowBox[{"X", "[", 
    RowBox[{"_LI", ",", "_LI", ",", "indices___"}], "]"}], "]"}], "^:=", 
  RowBox[{"Symmetric", "[", 
   RowBox[{
    RowBox[{"2", "+", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", 
       RowBox[{"{", "indices", "}"}]}]}]}], ",", "Cycles"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryGroupOfTensor", "[", 
   RowBox[{"calZ", "[", 
    RowBox[{"_LI", ",", "_LI", ",", "_LI", ",", "indices___"}], "]"}], "]"}], 
  "^:=", 
  RowBox[{"Symmetric", "[", 
   RowBox[{
    RowBox[{"3", "+", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", 
       RowBox[{"{", "indices", "}"}]}]}]}], ",", "Cycles"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell["2) They are all traceless:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{"_LI", ",", "_LI", ",", "___", ",", "a_", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{"_LI", ",", "_LI", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{"_LI", ",", "_LI", ",", "___", ",", "a_", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", "0"}], "\n", 
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{"_LI", ",", "_LI", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{
   "_LI", ",", "_LI", ",", "_LI", ",", "___", ",", "a_", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___"}], "]"}], ":=", "0"}], "\n", 
 RowBox[{
  RowBox[{"calZ", "[", 
   RowBox[{"_LI", ",", "_LI", ",", "_LI", ",", "___", ",", 
    RowBox[{"-", "a_"}], ",", "___", ",", "a_", ",", "___"}], "]"}], ":=", 
  "0"}]}], "Input",
 InitializationCell->True],

Cell["3) There are no pseudoscalars:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{"_LI", ",", "_LI"}], "]"}], ":=", "0"}]], "Input",
 InitializationCell->True],

Cell["4) Orthogonality relations:", "Text"],

Cell[BoxData[
 RowBox[{"X", "/:", " ", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", 
     RowBox[{"inds1__", "?", "AIndexQ"}]}], "]"}], 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", 
     RowBox[{"inds2__", "?", "AIndexQ"}]}], "]"}]}], ":=", 
  RowBox[{"0", "/;", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"xAct`xTensor`Private`TakePairs", "[", 
      RowBox[{"IndexList", "[", 
       RowBox[{"inds1", ",", "inds2"}], "]"}], "]"}], "]"}], "===", 
    RowBox[{"Sort", "[", 
     RowBox[{"IndexList", "[", 
      RowBox[{"inds1", ",", "inds2"}], "]"}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell["5) Products with epsilongamma:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ZToX", "=", 
   RowBox[{
    RowBox[{"Z", "[", 
     RowBox[{"l_LI", ",", "m_LI", ",", "a_", ",", "b___"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"-", 
       RowBox[{"Symmetrize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"epsilongamma", "[", 
           RowBox[{"a", ",", "c"}], "]"}], 
          RowBox[{"X", "[", 
           RowBox[{"l", ",", "m", ",", 
            RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XToZ", "=", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"l_LI", ",", "m_LI", ",", "a_", ",", "b___"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"Symmetrize", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"epsilongamma", "[", 
          RowBox[{"a", ",", "c"}], "]"}], 
         RowBox[{"Z", "[", 
          RowBox[{"l", ",", "m", ",", 
           RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calZTocalZ", "=", 
   RowBox[{
    RowBox[{"calZ", "[", 
     RowBox[{
      RowBox[{"LI", "[", "sign_", "]"}], ",", "l_LI", ",", "m_LI", ",", "a_", 
      ",", "b___"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"Symmetrize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"epsilongamma", "[", 
           RowBox[{"a", ",", "c"}], "]"}], 
          RowBox[{"calZ", "[", 
           RowBox[{
            RowBox[{"LI", "[", 
             RowBox[{"-", "sign"}], "]"}], ",", "l", ",", "m", ",", 
            RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dropepsilon", "=", 
   RowBox[{
    RowBox[{"term", ":", 
     RowBox[{"(", 
      RowBox[{"_.", " ", 
       RowBox[{"epsilongamma", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Z", "|", "X", "|", "calZ"}], ")"}], "[", "__", "]"}]}], 
      ")"}]}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"term", ",", 
       RowBox[{"{", 
        RowBox[{"ZToX", ",", "XToZ", ",", "calZTocalZ"}], "}"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"IsIndexOf", "[", 
       RowBox[{"term", ",", 
        RowBox[{"-", "a"}]}], "]"}], "||", 
      RowBox[{"IsIndexOf", "[", 
       RowBox[{"term", ",", 
        RowBox[{"-", "b"}]}], "]"}]}]}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["An alternative coding (not used now):", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dropepsilon", "=", 
   RowBox[{
    RowBox[{"term", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_.", " ", 
        RowBox[{"epsilongamma", "[", 
         RowBox[{"___", ",", "a_", ",", "___"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Z", "|", "X", "|", "calZ"}], ")"}], "[", 
         RowBox[{"___", ",", 
          RowBox[{"-", "a_"}], ",", "___"}], "]"}]}], "|", 
       RowBox[{"_.", " ", 
        RowBox[{"epsilongamma", "[", 
         RowBox[{"___", ",", 
          RowBox[{"-", "a_"}], ",", "___"}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Z", "|", "X"}], ")"}], "[", 
         RowBox[{"___", ",", "a_", ",", "___"}], "]"}]}]}], ")"}]}], 
    "\[RuleDelayed]", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"term", ",", 
      RowBox[{"{", 
       RowBox[{"ZToX", ",", "XToZ", ",", "calZTocalZ"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 Evaluatable->False],

Cell["\<\
6) We define the relations between STF tensors with different numbers of \
indices. Note that the only place where epsilongamma appears is in the \
derivative of X_a:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", "a_", "]"}], "[", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "]"}], ":=", 
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "l", "]"}], ",", 
    RowBox[{"LI", "[", "m", "]"}], ",", "a"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", "b_", "]"}], "[", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", 
     RowBox[{"a_", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b"}], "]"}], "-", 
   RowBox[{"l", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l", "+", "1"}], ")"}], "/", "2"}], 
    RowBox[{"gamma", "[", 
     RowBox[{"a", ",", "b"}], "]"}], 
    RowBox[{"Z", "[", 
     RowBox[{
      RowBox[{"LI", "[", "l", "]"}], ",", 
      RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", "b_", "]"}], "[", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", 
     RowBox[{"a_", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b"}], "]"}], "-", 
   RowBox[{"l", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l", "+", "1"}], ")"}], "/", "2"}], 
    RowBox[{"epsilongamma", "[", 
     RowBox[{"a", ",", "b"}], "]"}], 
    RowBox[{"Z", "[", 
     RowBox[{
      RowBox[{"LI", "[", "l", "]"}], ",", 
      RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", "b_", "]"}], "[", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", 
     RowBox[{"a1_", "?", "AIndexQ"}], ",", 
     RowBox[{"a2_", "?", "AIndexQ"}], ",", 
     RowBox[{"a___", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "b$", "}"}], ",", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", "=", 
         RowBox[{"1", "+", "1", "+", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}], ",", "a1", ",", "a2", ",", "a", ",", 
          "b$"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "+", "s"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "-", "s", "+", "1"}], ")"}], "/", "2"}], 
         RowBox[{"Symmetrize", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"gamma", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"Z", "[", 
              RowBox[{
               RowBox[{"LI", "[", "l", "]"}], ",", 
               RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b$"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"gamma", "[", 
              RowBox[{"b$", ",", "a1"}], "]"}], 
             RowBox[{"Z", "[", 
              RowBox[{
               RowBox[{"LI", "[", "l", "]"}], ",", 
               RowBox[{"LI", "[", "m", "]"}], ",", "a2", ",", "a"}], 
              "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a1", ",", "a2", ",", "a"}], "}"}]}], "]"}]}]}]}], "]"}], 
     "/.", 
     RowBox[{"b$", "\[Rule]", "b"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cd", "[", "b_", "]"}], "[", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l_", "]"}], ",", 
     RowBox[{"LI", "[", "m_", "]"}], ",", 
     RowBox[{"a1_", "?", "AIndexQ"}], ",", 
     RowBox[{"a2_", "?", "AIndexQ"}], ",", 
     RowBox[{"a___", "?", "AIndexQ"}]}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "b$", "}"}], ",", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", "=", 
         RowBox[{"1", "+", "1", "+", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}], ",", "a1", ",", "a2", ",", "a", ",", 
          "b$"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "+", "s"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "-", "s", "+", "1"}], ")"}], "/", "2"}], 
         RowBox[{"Symmetrize", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"gamma", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"X", "[", 
              RowBox[{
               RowBox[{"LI", "[", "l", "]"}], ",", 
               RowBox[{"LI", "[", "m", "]"}], ",", "a", ",", "b$"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"gamma", "[", 
              RowBox[{"b$", ",", "a1"}], "]"}], 
             RowBox[{"X", "[", 
              RowBox[{
               RowBox[{"LI", "[", "l", "]"}], ",", 
               RowBox[{"LI", "[", "m", "]"}], ",", "a2", ",", "a"}], 
              "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a1", ",", "a2", ",", "a"}], "}"}]}], "]"}]}]}]}], "]"}], 
     "/.", 
     RowBox[{"b$", "\[Rule]", "b"}]}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Pure-spin harmonics", "Subsubsection"],

Cell["Normalization factor:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffK", "[", 
   RowBox[{"l_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Infinity", "/;", 
   RowBox[{"s", ">", "l"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffK", "[", 
   RowBox[{"l_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "l"}], "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", "Pi"}], ")"}]}], "/", 
     RowBox[{"2", "^", "s"}]}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "+", "s"}], ")"}], "!"}], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "-", "s"}], ")"}], "!"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell["Asymptotics for large l+lp:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"coeffK", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "Lp", "+", "lpp"}], ")"}], "/", "2"}], ",", "s"}], 
      "]"}], 
     RowBox[{"coeffK", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "Lp", "+", "lpp"}], ")"}], "/", "2"}], ",", "sp"}],
       "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"L", ",", "Infinity", ",", "1"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "::", "\<\"esss\"\>"}], ":", 
  " ", "\<\"Essential singularity encountered in \
\\!\\(\[ExponentialE]\\^\\*InterpretationBox[\\(\\(\\(-\\(\\(\\(\\(\\(\\*\
InterpretationBox[StyleBox[\\(Log\\), Rule[AutoSpacing, False]], Log, \
Rule[Editable, False]]\\)\\)[\\(\\(2\\\\ \[ExponentialE]\\)\\)]\\)\\/\\(2\\/L\
\\)\\)\\)\\)\\) + \\*InterpretationBox[\\(\\(O[\\(\\(1\\/L\\)\\)]\\)\\^3\\), \
SeriesData[L, DirectedInfinity[1], List[], -1, 3, 1], Rule[Editable, \
False]]\\), SeriesData[L, DirectedInfinity[1], List[Times[Rational[-1, 2], \
Log[Times[2, E]]]], -1, 3, 1], Rule[Editable, False]]\\). \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"Series::esss\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "::", "\<\"esss\"\>"}], ":", 
  " ", "\<\"Essential singularity encountered in \
\\!\\(\[ExponentialE]\\^\\*InterpretationBox[\\(\\(\\(-\\(\\(\\(\\(\\(\\*\
InterpretationBox[StyleBox[\\(Log\\), Rule[AutoSpacing, False]], Log, \
Rule[Editable, False]]\\)\\)[\\(\\(2\\\\ \[ExponentialE]\\)\\)]\\)\\/\\(2\\/L\
\\)\\)\\)\\)\\) + \\*InterpretationBox[\\(\\(O[\\(\\(1\\/L\\)\\)]\\)\\^3\\), \
SeriesData[L, DirectedInfinity[1], List[], -1, 3, 1], Rule[Editable, \
False]]\\), SeriesData[L, DirectedInfinity[1], List[Times[Rational[-1, 2], \
Log[Times[2, E]]]], -1, 3, 1], Rule[Editable, False]]\\). \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"Series::esss\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "::", "\<\"esss\"\>"}], ":", 
  " ", "\<\"Essential singularity encountered in \
\\!\\(\[ExponentialE]\\^\\*InterpretationBox[\\(\\(\\(-\\(\\(\\(\\(\\(\\*\
InterpretationBox[StyleBox[\\(Log\\), Rule[AutoSpacing, False]], Log, \
Rule[Editable, False]]\\)\\)[\\(\\(2\\\\ \[ExponentialE]\\)\\)]\\)\\/\\(2\\/L\
\\)\\)\\)\\)\\) + \\*InterpretationBox[\\(\\(O[\\(\\(1\\/L\\)\\)]\\)\\^3\\), \
SeriesData[L, DirectedInfinity[1], List[], -1, 3, 1], Rule[Editable, \
False]]\\), SeriesData[L, DirectedInfinity[1], List[Times[Rational[-1, 2], \
Log[Times[2, E]]]], -1, 3, 1], Rule[Editable, False]]\\). \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"Series::esss\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], ":", 
  " ", "\<\"Further output of \\!\\(Series :: \\\"esss\\\"\\) will be \
suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     SuperscriptBox["L", 
      RowBox[{"2", " ", "s"}]], " ", 
     RowBox[{"(", 
      InterpretationBox[
       RowBox[{
        FractionBox[
         SuperscriptBox["2", 
          RowBox[{
           RowBox[{"-", "2"}], "-", 
           RowBox[{"3", " ", "s"}]}]], 
         FractionBox["1", "L"]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", 
           FractionBox["1", "L"], "]"}], "0"],
         SeriesData[L, 
          DirectedInfinity[1], {}, -2, 0, 2],
         Editable->False]}],
       SeriesData[L, 
        DirectedInfinity[1], {2^(-2 - 3 s)}, -2, 0, 2],
       Editable->False], ")"}]}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["L", 
      RowBox[{"2", " ", "sp"}]], " ", 
     RowBox[{"(", 
      InterpretationBox[
       RowBox[{
        FractionBox[
         SuperscriptBox["2", 
          RowBox[{
           RowBox[{"-", "2"}], "-", 
           RowBox[{"3", " ", "sp"}]}]], 
         FractionBox["1", "L"]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", 
           FractionBox["1", "L"], "]"}], "0"],
         SeriesData[L, 
          DirectedInfinity[1], {}, -2, 0, 2],
         Editable->False]}],
       SeriesData[L, 
        DirectedInfinity[1], {2^(-2 - 3 sp)}, -2, 0, 2],
       Editable->False], ")"}]}]]}], "\[Pi]"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerExpand", "[", "%", "]"}], "//", "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["L", 
   RowBox[{"s", "+", "sp"}]], " ", 
  RowBox[{"(", 
   InterpretationBox[
    RowBox[{
     FractionBox[
      SuperscriptBox["2", 
       RowBox[{
        RowBox[{"-", "2"}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"s", "+", "sp"}], ")"}]}], "2"]}]], 
      FractionBox["\[Pi]", "L"]], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", 
        FractionBox["1", "L"], "]"}], "0"],
      SeriesData[L, 
       DirectedInfinity[1], {}, -2, 0, 2],
      Editable->False]}],
    SeriesData[L, 
     DirectedInfinity[1], {2^(-2 + Rational[-3, 2] (s + sp))/Pi}, -2, 0, 2],
    Editable->False], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Normal", "[", "%", "]"}], "//", "FullSimplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["2", 
    RowBox[{
     RowBox[{"-", "2"}], "-", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"s", "+", "sp"}], ")"}]}], "2"]}]], " ", 
   SuperscriptBox["L", 
    RowBox[{"1", "+", "s", "+", "sp"}]]}], "\[Pi]"]], "Output"]
}, Open  ]],

Cell["The pure-spin harmonics are:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PureSpin", "[", 
    RowBox[{"l_", ",", "1", ",", "mlabel_"}], "]"}], "[", "inds___", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "inds", "}"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"coeffK", "[", 
      RowBox[{"l", ",", "s"}], "]"}], 
     RowBox[{"calD", "[", 
      RowBox[{
       RowBox[{"LI", "@", "l"}], ",", 
       RowBox[{"LI", "@", "s"}], ",", 
       RowBox[{"LI", "@", "mlabel"}]}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", "s"}], " ", 
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{"m", "/@", 
        RowBox[{"{", "inds", "}"}]}], ")"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PureSpin", "[", 
    RowBox[{"l_", ",", 
     RowBox[{"-", "1"}], ",", "mlabel_"}], "]"}], "[", "inds___", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "inds", "}"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"coeffK", "[", 
      RowBox[{"l", ",", "s"}], "]"}], 
     RowBox[{"calD", "[", 
      RowBox[{
       RowBox[{"LI", "@", "l"}], ",", 
       RowBox[{"LI", "@", 
        RowBox[{"-", "s"}]}], ",", 
       RowBox[{"LI", "@", "mlabel"}]}], "]"}], 
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{"mbar", "/@", 
        RowBox[{"{", "inds", "}"}]}], ")"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
Note that both PureSpin[-1] and PureSpin[+1] with no indices are equal to the \
scalar spherical harmonics.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j", "=", "5"}], ",", 
      RowBox[{"m", "=", "2"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"j", ",", "1", ",", "m"}], "]"}], "[", "]"}], ",", 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"j", ",", 
           RowBox[{"-", "1"}], ",", "m"}], "]"}], "[", "]"}]}], "}"}], "-", 
      RowBox[{"SphericalHarmonicY", "[", 
       RowBox[{"j", ",", "m", ",", 
        RowBox[{"\[Theta]", "[", "]"}], ",", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}], "/.", "calDRule"}]}], "]"}], 
  "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j", "=", "4"}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"-", "1"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"j", ",", "1", ",", "m"}], "]"}], "[", "]"}], ",", 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"j", ",", 
           RowBox[{"-", "1"}], ",", "m"}], "]"}], "[", "]"}]}], "}"}], "-", 
      RowBox[{"SphericalHarmonicY", "[", 
       RowBox[{"j", ",", "m", ",", 
        RowBox[{"\[Theta]", "[", "]"}], ",", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}], "/.", "calDRule"}]}], "]"}], 
  "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Relations among them", "Subsubsection"],

Cell[BoxData[
 RowBox[{"ZXToY", ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{
       RowBox[{"LI", "[", "l_", "]"}], ",", 
       RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"PureSpin", "[", 
       RowBox[{"l", ",", "1", ",", "m"}], "]"}], "[", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{
       RowBox[{"LI", "[", "l_", "]"}], ",", 
       RowBox[{"LI", "[", "m_", "]"}], ",", "inds__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{
      RowBox[{
       RowBox[{"PureSpin", "[", 
        RowBox[{"l", ",", "1", ",", "m"}], "]"}], "[", "inds", "]"}], "+", 
      RowBox[{
       RowBox[{"PureSpin", "[", 
        RowBox[{"l", ",", 
         RowBox[{"-", "1"}], ",", "m"}], "]"}], "[", "inds", "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"LI", "[", "l_", "]"}], ",", 
       RowBox[{"LI", "[", "m_", "]"}], ",", "inds__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"I", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l", ",", "1", ",", "m"}], "]"}], "[", "inds", "]"}], "-", 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "m"}], "]"}], "[", "inds", "]"}]}], 
       ")"}]}]}]}], "}"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"paper1", "=", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l", "]"}], ",", 
     RowBox[{"LI", "[", "m", "]"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"l", "^", "2"}], "+", "l", "+", "2"}], ")"}], "/", "4"}], 
    RowBox[{"gamma", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "c"}], "]"}], "[", 
     RowBox[{"Z", "[", 
      RowBox[{
       RowBox[{"LI", "[", "l", "]"}], ",", 
       RowBox[{"LI", "[", "m", "]"}]}], "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"l", "+", "2"}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l", "-", "1"}], ")"}], "/", "2"}], " ", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gamma", "[", 
        RowBox[{
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "a"}]}], "]"}], 
       RowBox[{
        RowBox[{"cd", "[", 
         RowBox[{"-", "b"}], "]"}], "[", 
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "b"}]}], "}"}]}], "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "cb", "  "],
        AutoSpacing->False],
       gamma[-c, -b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "a"}], 
         RowBox[{"lm", " "}]],
        AutoSpacing->False],
       Z[
        LI[l], 
        LI[m], -a],
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Gamma]", "ca", "  "],
        AutoSpacing->False],
       gamma[-c, -a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"lm", " "}]],
        AutoSpacing->False],
       Z[
        LI[l], 
        LI[m], -b],
       Editable->False]}]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False], "+", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "2"]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", "ab", "  "],
     AutoSpacing->False],
    gamma[-a, -b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "c"}], 
      RowBox[{"lm", " "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c],
    Editable->False]}], "+", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", 
     RowBox[{"  ", "abc"}], 
     RowBox[{"lm", "   "}]],
    AutoSpacing->False],
   Z[
    LI[l], 
    LI[m], -a, -b, -c],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplification", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"cd", "[", 
     RowBox[{"-", "c"}], "]"}], "@", 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "b"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "a"}], "]"}], "@", 
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{"LI", "[", "l", "]"}], ",", 
        RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], "-", "paper1"}], 
  "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"paper2", "=", 
   RowBox[{
    RowBox[{"Z", "[", 
     RowBox[{
      RowBox[{"LI", "[", "l", "]"}], ",", 
      RowBox[{"LI", "[", "m", "]"}], ",", 
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "]"}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l", "^", "2"}], "+", "l", "+", "6"}], ")"}], "/", "6"}], 
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "b"}]}], "]"}], 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "c"}], "]"}], "@", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l", "]"}], ",", 
         RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], "-", 
    RowBox[{"Symmetrize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "3"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "2"}], ")"}], "/", "6"}], 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "d"}]}], "]"}], 
        RowBox[{
         RowBox[{"cd", "[", 
          RowBox[{"-", "b"}], "]"}], "@", 
         RowBox[{
          RowBox[{"cd", "[", 
           RowBox[{"-", "a"}], "]"}], "@", 
          RowBox[{"Z", "[", 
           RowBox[{
            RowBox[{"LI", "[", "l", "]"}], ",", 
            RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], "+", 
       RowBox[{"l", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}], "/", "3"}], 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "a"}]}], "]"}], 
        RowBox[{
         RowBox[{"cd", "[", 
          RowBox[{"-", "b"}], "]"}], "@", 
         RowBox[{
          RowBox[{"cd", "[", 
           RowBox[{"-", "d"}], "]"}], "@", 
          RowBox[{"Z", "[", 
           RowBox[{
            RowBox[{"LI", "[", "l", "]"}], ",", 
            RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "3"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "2"}], ")"}], "/", "3"}], 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"-", "d"}], ",", 
          RowBox[{"-", "a"}]}], "]"}], 
        RowBox[{
         RowBox[{"cd", "[", 
          RowBox[{"-", "c"}], "]"}], "@", 
         RowBox[{
          RowBox[{"cd", "[", 
           RowBox[{"-", "b"}], "]"}], "@", 
          RowBox[{"Z", "[", 
           RowBox[{
            RowBox[{"LI", "[", "l", "]"}], ",", 
            RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "3"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}], "l", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "2"}], ")"}], "/", "12"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{
             RowBox[{"-", "c"}], ",", 
             RowBox[{"-", "a"}]}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{
             RowBox[{"-", "b"}], ",", 
             RowBox[{"-", "d"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{
              RowBox[{"-", "c"}], ",", 
              RowBox[{"-", "d"}]}], "]"}], "/", "2"}]}]}], ")"}], 
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "b"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplification", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"cd", "[", 
     RowBox[{"-", "d"}], "]"}], "@", 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "c"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "a"}], "]"}], "@", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l", "]"}], ",", 
         RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}]}], "-", "paper2"}], 
  "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["More checks (this are full expansions, brute force):", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"STFPart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "c"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "a"}], "]"}], "@", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l", "]"}], ",", 
         RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}], ",", "gamma"}], "]"}], 
  "//", "ContractMetric"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "abc"}], 
      RowBox[{"lm", "   "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -b, -c],
    Editable->False], "6"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "acb"}], 
      RowBox[{"lm", "   "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -c, -b],
    Editable->False], "6"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bac"}], 
      RowBox[{"lm", "   "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -a, -c],
    Editable->False], "6"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bca"}], 
      RowBox[{"lm", "   "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -c, -a],
    Editable->False], "6"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cab"}], 
      RowBox[{"lm", "   "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -a, -b],
    Editable->False], "6"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cba"}], 
      RowBox[{"lm", "   "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -b, -a],
    Editable->False], "6"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Simplification"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["Z", 
    RowBox[{"  ", "abc"}], 
    RowBox[{"lm", "   "}]],
   AutoSpacing->False],
  Z[
   LI[l], 
   LI[m], -a, -b, -c],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"STFPart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "d"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "c"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "b"}], "]"}], "@", 
       RowBox[{
        RowBox[{"cd", "[", 
         RowBox[{"-", "a"}], "]"}], "@", 
        RowBox[{"Z", "[", 
         RowBox[{
          RowBox[{"LI", "[", "l", "]"}], ",", 
          RowBox[{"LI", "[", "m", "]"}]}], "]"}]}]}]}]}], ",", "gamma"}], 
   "]"}], "//", "ContractMetric"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "abcd"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -b, -c, -d],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "abdc"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -b, -d, -c],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "acbd"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -c, -b, -d],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "acdb"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -c, -d, -b],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "adbc"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -d, -b, -c],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "adcb"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -a, -d, -c, -b],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bacd"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -a, -c, -d],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "badc"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -a, -d, -c],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bcad"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -c, -a, -d],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bcda"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -c, -d, -a],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bdac"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -d, -a, -c],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "bdca"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -b, -d, -c, -a],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cabd"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -a, -b, -d],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cadb"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -a, -d, -b],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cbad"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -b, -a, -d],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cbda"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -b, -d, -a],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cdab"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -d, -a, -b],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "cdba"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -c, -d, -b, -a],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "dabc"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -d, -a, -b, -c],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "dacb"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -d, -a, -c, -b],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "dbac"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -d, -b, -a, -c],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "dbca"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -d, -b, -c, -a],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "dcab"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -d, -c, -a, -b],
    Editable->False], "24"], "+", 
  FractionBox[
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "dcba"}], 
      RowBox[{"lm", "    "}]],
     AutoSpacing->False],
    Z[
     LI[l], 
     LI[m], -d, -c, -b, -a],
    Editable->False], "24"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Simplification"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["Z", 
    RowBox[{"  ", "abcd"}], 
    RowBox[{"lm", "    "}]],
   AutoSpacing->False],
  Z[
   LI[l], 
   LI[m], -a, -b, -c, -d],
  Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Explicit expressions", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"spherical", "/:", 
   RowBox[{"CNumbersOf", "[", 
    RowBox[{"spherical", ",", "TangentS2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cartesian", "/:", 
   RowBox[{"CNumbersOf", "[", 
    RowBox[{"cartesian", ",", "TangentS2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"HarmonicComponent", "[", "expr_", "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"ToValues", "[", 
    RowBox[{
     RowBox[{"expr", "/.", "ZXToY"}], "/.", "calDRule"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell["Components of tensors can be directly obtained:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}],
    Editable->False], ",", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {3, -spherical}],
    Editable->False]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "16"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", "\[Pi]"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"4", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "32"]}], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", "\[Pi]"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"9", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    X[
     LI[4], 
     LI[1], {2, -spherical}],
    Editable->False], ",", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    X[
     LI[4], 
     LI[1], {3, -spherical}],
    Editable->False]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "32"]}], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", "\[Pi]"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"9", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["3", "16"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", "\[Pi]"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"4", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
However, derivatives must be computed with care. For example:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cd", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "spherical"}]}], "}"}], "]"}], "[", 
  RowBox[{
   RowBox[{"cd", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"-", "spherical"}]}], "}"}], "]"}], "[", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["Z", 
    RowBox[{"  ", 
     RowBox[{
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]], ":", 
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]]}]}], 
    RowBox[{"41", "   "}]],
   AutoSpacing->False],
  cd[{3, -spherical}][
   Z[
    LI[4], 
    LI[1], {3, -spherical}]],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "32"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"9", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}]}]], "Output"]
}, Open  ]],

Cell["\<\
That is not a component of the second derivative of a scalar harmonic:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "a"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "a"}], "]"}], "[", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "[", 
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{"LI", "[", "4", "]"}], ",", 
        RowBox[{"LI", "[", "1", "]"}]}], "]"}], "]"}], "]"}]}], "]"}], "//", 
  "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "10"}], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "+", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", 
     RowBox[{"  ", 
      StyleBox[
       RowBox[{"3", "3"}],
       FontColor->RGBColor[1, 0, 0]]}], 
     RowBox[{"41", "  "}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[1], {3, -spherical}, {3, -spherical}],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "8"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"15", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "3"]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "The reason is the way ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 "  understands component derivatives:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cd", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "spherical"}]}], "}"}], "]"}], "[", 
  RowBox[{
   RowBox[{"cd", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"-", "spherical"}]}], "}"}], "]"}], "[", 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["Z", 
    RowBox[{"  ", 
     RowBox[{
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]], ":", 
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]]}]}], 
    RowBox[{"41", "   "}]],
   AutoSpacing->False],
  cd[{3, -spherical}][
   Z[
    LI[4], 
    LI[1], {3, -spherical}]],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SeparateBasis", "[", "AIndex", "]"}], "[", 
  RowBox[{"%", ",", 
   RowBox[{"IndicesOf", "[", "spherical", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "a"}]],
    AutoSpacing->False],
   Basis[{3, -spherical}, a],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"D", ",", 
          StyleBox["\[ScriptCapitalD]",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], 
        RowBox[{" ", 
         RowBox[{"a", 
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]]}]}], 
        RowBox[{"b", "  "}]],
       AutoSpacing->False],
      ChristoffelcdPDspherical[b, -a, {3, -spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", 
        RowBox[{"  ", "b"}], 
        RowBox[{"41", " "}]],
       AutoSpacing->False],
      Z[
       LI[4], 
       LI[1], -b],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "b"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, b],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "10"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Gamma]", "ba", "  "],
          AutoSpacing->False],
         gamma[-b, -a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["Z", "  ", "41"],
          AutoSpacing->False],
         Z[
          LI[4], 
          LI[1]],
         Editable->False]}], "+", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["Z", 
          RowBox[{"  ", "ba"}], 
          RowBox[{"41", "  "}]],
         AutoSpacing->False],
        Z[
         LI[4], 
         LI[1], -b, -a],
        Editable->False]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SeparateBasis", "[", "spherical", "]"}], "[", "%", "]"}], "//", 
  "Expand"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "10"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["e",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {e, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["f",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {f, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["c",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, {c, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["d",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, {d, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["c",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{-c, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["d",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{-d, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox[
       RowBox[{"f", "e"}],
       FontColor->RGBColor[1, 0, 0]], "  "],
     AutoSpacing->False],
    gamma[{-f, -spherical}, {-e, -spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["f",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {f, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", "  "}], 
      RowBox[{" ", 
       StyleBox["f1",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {f1, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["c",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, {c, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["d",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, {d, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["c",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{-c, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["e",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{-e, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"D", ",", 
        StyleBox["\[ScriptCapitalD]",
         FontColor->RGBColor[1, 0, 0]]}], "]"}], 
      RowBox[{" ", 
       StyleBox[
        RowBox[{"f", "d"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{
       StyleBox["e",
        FontColor->RGBColor[1, 0, 0]], "  "}]],
     AutoSpacing->False],
    ChristoffelcdPDspherical[{
     e, spherical}, {-f, -spherical}, {-d, -spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["f1",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "  "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {-f1, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["e",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {e, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["f",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {f, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["c",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, {c, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", 
       StyleBox["d",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, {d, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["c",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{-c, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["d",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{-d, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"f", "e"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "  "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {-f, -spherical}, {-e, -spherical}],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "TraceBasisDummy"}], "//", "ToValues"}], "//", 
  "Expand"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "10"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "-", 
  RowBox[{"10", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Cot",
      AutoSpacing->False],
     Cot,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Cos",
      AutoSpacing->False],
     Cos,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Cot",
      AutoSpacing->False],
     Cot,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {3, -spherical}],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{2, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Cos",
      AutoSpacing->False],
     Cos,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {3, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "  "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}, {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "3"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "  "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}, {3, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"3", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "  "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {3, -spherical}, {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"a", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-a, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{"b", " "}], 
      RowBox[{" ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Basis[-b, {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "a"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["e", 
      RowBox[{
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]], " "}], 
      RowBox[{" ", "b"}]],
     AutoSpacing->False],
    Basis[{3, -spherical}, b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"3", "3"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "  "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {3, -spherical}, {3, -spherical}],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "512"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["3",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "a"}]],
    AutoSpacing->False],
   Basis[{3, -spherical}, a],
   Editable->False], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Csc",
     AutoSpacing->False],
    Csc,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{"a", " "}], 
        RowBox[{" ", 
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]]}]],
       AutoSpacing->False],
      Basis[-a, {3, spherical}],
      Editable->False], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{"b", " "}], 
           RowBox[{" ", 
            StyleBox["3",
             FontColor->RGBColor[1, 0, 0]]}]],
          AutoSpacing->False],
         Basis[-b, {3, spherical}],
         Editable->False], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["e", 
              RowBox[{
               StyleBox["2",
                FontColor->RGBColor[1, 0, 0]], " "}], 
              RowBox[{" ", "b"}]],
             AutoSpacing->False],
            Basis[{2, -spherical}, b],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"9", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               InterpretationBox[
                StyleBox[
                 SubsuperscriptBox["\[Theta]", "", ""],
                 AutoSpacing->False],
                \[Theta][],
                Editable->False], "]"}]}], "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"3", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["e", 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], " "}], 
              RowBox[{" ", "b"}]],
             AutoSpacing->False],
            Basis[{3, -spherical}, b],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               StyleBox["Sin",
                AutoSpacing->False],
               Sin,
               Editable->False], "[", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox["\[Theta]", "", ""],
                AutoSpacing->False],
               \[Theta][],
               Editable->False], "]"}], "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"3", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{"b", " "}], 
           RowBox[{" ", 
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]]}]],
          AutoSpacing->False],
         Basis[-b, {2, spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["e", 
              RowBox[{
               StyleBox["2",
                FontColor->RGBColor[1, 0, 0]], " "}], 
              RowBox[{" ", "b"}]],
             AutoSpacing->False],
            Basis[{2, -spherical}, b],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               StyleBox["Cos",
                AutoSpacing->False],
               Cos,
               Editable->False], "[", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox["\[Theta]", "", ""],
                AutoSpacing->False],
               \[Theta][],
               Editable->False], "]"}], "+", 
             RowBox[{"8", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"3", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}], "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"5", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"3", " ", "\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["e", 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], " "}], 
              RowBox[{" ", "b"}]],
             AutoSpacing->False],
            Basis[{3, -spherical}, b],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               InterpretationBox[
                StyleBox[
                 SubsuperscriptBox["\[Theta]", "", ""],
                 AutoSpacing->False],
                \[Theta][],
                Editable->False], "]"}]}], "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"3", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}],
     "+", 
    RowBox[{"16", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{"a", " "}], 
        RowBox[{" ", 
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]]}]],
       AutoSpacing->False],
      Basis[-a, {2, spherical}],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "b"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, b],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{"b", " "}], 
           RowBox[{" ", 
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]]}]],
          AutoSpacing->False],
         Basis[-b, {2, spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}], "+", 
          RowBox[{"18", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "-", 
          RowBox[{"35", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"5", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{"b", " "}], 
           RowBox[{" ", 
            StyleBox["3",
             FontColor->RGBColor[1, 0, 0]]}]],
          AutoSpacing->False],
         Basis[-b, {3, spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}], "+", 
          RowBox[{"6", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "-", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"5", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell["Or in other words:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HarmonicComponent", "[", 
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "1", "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["3", "32"]}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"9", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "32"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"9", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "a"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "a"}], "]"}], "[", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "[", 
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{"LI", "[", "4", "]"}], ",", 
        RowBox[{"LI", "[", "1", "]"}]}], "]"}], "]"}], "]"}]}], "]"}], "//", 
  "ToValues"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox["Z", 
    RowBox[{"  ", 
     StyleBox[
      RowBox[{"3", "2"}],
      FontColor->RGBColor[1, 0, 0]]}], 
    RowBox[{"41", "  "}]],
   AutoSpacing->False],
  Z[
   LI[4], 
   LI[1], {3, -spherical}, {2, -spherical}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["9", "16"], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{"5", "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "2"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cd", "[", 
   RowBox[{"-", "a"}], "]"}], "[", 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   SubsuperscriptBox[
    RowBox[{"\[CapitalGamma]", "[", 
     RowBox[{"D", ",", 
      StyleBox["\[ScriptCapitalD]",
       FontColor->RGBColor[1, 0, 0]]}], "]"}], 
    RowBox[{" ", 
     RowBox[{"a", 
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]]}]}], 
    RowBox[{"b", "  "}]],
   AutoSpacing->False],
  ChristoffelcdPDspherical[b, -a, {2, -spherical}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "a"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "b"}], "]"}], "[", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"LI", "[", "4", "]"}], ",", 
       RowBox[{"LI", "[", "2", "]"}], ",", 
       RowBox[{"-", "a"}]}], "]"}], "]"}]}], "]"}], "//", 
  "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["9", "16"]}], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "2"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "a"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "c"}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "a"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "[", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "c"}], "]"}], "[", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "4", "]"}], ",", 
         RowBox[{"LI", "[", "1", "]"}]}], "]"}], "]"}], "]"}]}]}], "]"}], "//",
   "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "16"], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"81", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}]}], "+", 
    RowBox[{"35", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "3"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "a"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "b"}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "spherical"}]}], "}"}], ",", "c"}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "a"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "[", 
      RowBox[{"X", "[", 
       RowBox[{
        RowBox[{"LI", "[", "4", "]"}], ",", 
        RowBox[{"LI", "[", "1", "]"}], ",", 
        RowBox[{"-", "c"}]}], "]"}], "]"}]}]}], "]"}], "//", 
  "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["9", "16"]}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", "\[Pi]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}], "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"4", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "3"]}]], "Output"]
}, Open  ]],

Cell["New example:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "3", "]"}], ",", "a", ",", "b"}], "]"}], 
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "3", "]"}], ",", 
    RowBox[{"-", "a"}], ",", "c"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "a", " "}], 
     RowBox[{"43", " ", "c"}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[3], -a, c],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "    ", 
     RowBox[{"43", "ab"}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[3], a, b],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", 
  RowBox[{"SeparateBasis", "[", "spherical", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{"a", " "}], 
     RowBox[{" ", 
      StyleBox["d",
       FontColor->RGBColor[1, 0, 0]]}]],
    AutoSpacing->False],
   Basis[-a, {d, spherical}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["e",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "c"}]],
    AutoSpacing->False],
   Basis[{-e, -spherical}, c],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["f",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "a"}]],
    AutoSpacing->False],
   Basis[{-f, -spherical}, a],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["f1",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{"  ", "b"}]],
    AutoSpacing->False],
   Basis[{-f1, -spherical}, b],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", 
      StyleBox["d",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{"43", " ", 
      StyleBox["e",
       FontColor->RGBColor[1, 0, 0]]}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[3], {-d, -spherical}, {e, spherical}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "     ", 
     RowBox[{"43", 
      StyleBox["f",
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox["f1",
       FontColor->RGBColor[1, 0, 0]]}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[3], {f, spherical}, {f1, spherical}],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ContractBasis", "[", 
  RowBox[{"%", ",", "AIndex"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "c"}]],
    AutoSpacing->False],
   Basis[{-a, -spherical}, c],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["e",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "b"}]],
    AutoSpacing->False],
   Basis[{-e, -spherical}, b],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", 
      StyleBox["d",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{"43", " ", 
      StyleBox["a",
       FontColor->RGBColor[1, 0, 0]]}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[3], {-d, -spherical}, {a, spherical}],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "    ", 
     RowBox[{"43", 
      StyleBox["d",
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox["e",
       FontColor->RGBColor[1, 0, 0]]}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[3], {d, spherical}, {e, spherical}],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", "\[Pi]"}]], 
  RowBox[{"(", 
   RowBox[{"2835", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["a",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", "c"}]],
      AutoSpacing->False],
     Basis[{-a, -spherical}, c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["e", 
       RowBox[{
        StyleBox["e",
         FontColor->RGBColor[1, 0, 0]], " "}], 
       RowBox[{" ", "b"}]],
      AutoSpacing->False],
     Basis[{-e, -spherical}, b],
     Editable->False], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         FractionBox[
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "2"], "]"}], "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}]}], ")"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["m", " ", 
          StyleBox["a",
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        m[{a, spherical}],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["m", 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 0]], " "],
         AutoSpacing->False],
        m[{-d, -spherical}],
        Editable->False]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}]}], ")"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox[
          OverscriptBox["m", "_"], " ", 
          StyleBox["a",
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        mbar[{a, spherical}],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox[
          OverscriptBox["m", "_"], 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 0]], " "],
         AutoSpacing->False],
        mbar[{-d, -spherical}],
        Editable->False], " ", 
       SuperscriptBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         FractionBox[
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "2"], "]"}], "4"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         FractionBox[
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "2"], "]"}], "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}]}], ")"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["m", " ", 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        m[{d, spherical}],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["m", " ", 
          StyleBox["e",
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        m[{e, spherical}],
        Editable->False]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}]}], ")"}], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox[
          OverscriptBox["m", "_"], " ", 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        mbar[{d, spherical}],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox[
          OverscriptBox["m", "_"], " ", 
          StyleBox["e",
           FontColor->RGBColor[1, 0, 0]]],
         AutoSpacing->False],
        mbar[{e, spherical}],
        Editable->False], " ", 
       SuperscriptBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         FractionBox[
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False], "2"], "]"}], "4"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "TraceBasisDummy"}], "//", "ToValues"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2835", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"6", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", "c"}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, c],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", "b"}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, b],
       Editable->False]}], "-", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["2",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", "b"}]],
        AutoSpacing->False],
       Basis[{2, -spherical}, b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["e", 
         RowBox[{
          StyleBox["3",
           FontColor->RGBColor[1, 0, 0]], " "}], 
         RowBox[{" ", "c"}]],
        AutoSpacing->False],
       Basis[{3, -spherical}, c],
       Editable->False]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "5"]}], 
  RowBox[{"64", " ", "\[Pi]"}]]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Pure-orbital harmonics", "Subsubsection"],

Cell["\<\
Here we show that the Cartesian components of the pure-orbital harmonics are \
eigenfunctions of the Laplacian, but not of the z component of angular \
momentum. Note that this form for the Laplacian is only valid on scalars:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LaplacianOnScalars", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"\[Theta]", "[", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "]"}]}], "]"}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "]"}], "]"}], "/", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "]"}], "]"}]}], 
    RowBox[{"D", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"\[Theta]", "[", "]"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"\[Phi]", "[", "]"}], ",", 
      RowBox[{"\[Phi]", "[", "]"}]}], "]"}], "/", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "]"}], "]"}], "^", "2"}]}]}]}]], "Input"],

Cell["Note that we use Separate twice:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "SeparateBasis"}]], "Input"],

Cell[BoxData["\<\"SeparateBasis[basis][expr, indices] expands indices of \
objects in expr into products of Basis objects and the original objects, \
using contractions of indices specified by basis. When basis is AIndex or is \
not given, abstract indices are used. The list of indices can be supplied in \
different ways, using IndicesOf[selectors], a list of g-indices with head \
IndexList or a single g-index. See the documentation for IndicesOf for a \
complete list of possible selectors.\"\>"], "Print",
 CellTags->"Info3467290051-1079711"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplacian", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateBasis", "[", "spherical", "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SeparateBasis", "[", "spherical", "]"}], "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DummyToBasis", "[", "spherical", "]"}], "[", 
          RowBox[{"ContractBasis", "[", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"a", ",", "b"}], "]"}], 
            RowBox[{
             RowBox[{"cd", "[", 
              RowBox[{"-", "a"}], "]"}], "[", 
             RowBox[{
              RowBox[{"cd", "[", 
               RowBox[{"-", "b"}], "]"}], "[", "expr", "]"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"IndicesOf", "[", "Free", "]"}]}], "]"}], ",", 
       RowBox[{"IndicesOf", "[", "Free", "]"}]}], "]"}], "//", 
     "TraceBasisDummy"}], "//", "ToValues"}], "//", "Simplify"}]}]], "Input"],

Cell["Definition:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PureOrbital", "[", 
    RowBox[{"j_", ",", "l_", ",", "m_"}], "]"}], "[", "inds__", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "inds", "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ClebschGordan", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"m", "-", "mp"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "mp"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "m"}], "}"}]}], "]"}], 
       RowBox[{"SphericalHarmonicY", "[", 
        RowBox[{"l", ",", 
         RowBox[{"m", "-", "mp"}], ",", 
         RowBox[{"\[Theta]", "[", "]"}], ",", 
         RowBox[{"\[Phi]", "[", "]"}]}], "]"}], 
       RowBox[{"Orbitalt", "[", 
        RowBox[{
         RowBox[{"LI", "[", "mp", "]"}], ",", "inds"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"mp", ",", 
        RowBox[{"-", "s"}], ",", "s"}], "}"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PureOrbital", "[", 
     RowBox[{"4", ",", "3", ",", 
      RowBox[{"-", "2"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "cartesian"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "cartesian"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "cartesian"}]}], "}"}]}], "]"}], "//", "ToValues"}], "//",
   "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Phi]", "", ""],
             AutoSpacing->False],
            \[Phi][],
            Editable->False]}]]}]}], ")"}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}], ")"}], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}]}], 
  RowBox[{"8", " ", 
   SqrtBox[
    RowBox[{"22", " ", "\[Pi]"}]]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", "12"}]], "Output"]
}, Open  ]],

Cell["We have these two orbital harmonics:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"O1", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j", "=", "4"}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"-", "2"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"j", 
          RowBox[{"(", 
           RowBox[{"j", "+", "1"}], ")"}]}], "]"}], 
        RowBox[{"Sqrt", "[", 
         RowBox[{"j", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "j"}], "+", "1"}], ")"}]}], "]"}], 
        RowBox[{
         RowBox[{"PureOrbital", "[", 
          RowBox[{"j", ",", 
           RowBox[{"j", "+", "1"}], ",", "m"}], "]"}], "[", "c", "]"}], 
        RowBox[{"identity", "[", 
         RowBox[{"d", ",", 
          RowBox[{"-", "c"}]}], "]"}]}], "//", "ContractBasis"}], "//", 
      "ToValues"}], "//", "Simplify"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "48"]}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"8", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"20", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{1, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"O2", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j", "=", "4"}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"-", "2"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"j", 
          RowBox[{"(", 
           RowBox[{"j", "+", "1"}], ")"}]}], "]"}], 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "+", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "j"}], "+", "1"}], ")"}]}], "]"}], 
        RowBox[{
         RowBox[{"PureOrbital", "[", 
          RowBox[{"j", ",", 
           RowBox[{"j", "-", "1"}], ",", "m"}], "]"}], "[", "c", "]"}], 
        RowBox[{"identity", "[", 
         RowBox[{"d", ",", 
          RowBox[{"-", "c"}]}], "]"}]}], "//", "ContractBasis"}], "//", 
      "ToValues"}], "//", "Simplify"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "24"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], " "}], 
           RowBox[{" ", "d"}]],
          AutoSpacing->False],
         Basis[{2, -spherical}, d],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{
            StyleBox["1",
             FontColor->RGBColor[1, 0, 0]], " "}], 
           RowBox[{" ", "d"}]],
          AutoSpacing->False],
         Basis[{1, -spherical}, d],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
which add up to a spin harmonic (note that the radial part cancels)\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"newZ", "=", 
  RowBox[{
   RowBox[{"O1", "+", "O2"}], "//", "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "16"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"newZ", "-", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{"LI", "[", "4", "]"}], ",", 
        RowBox[{"LI", "[", 
         RowBox[{"-", "2"}], "]"}], ",", "c"}], "]"}], 
      RowBox[{"identity", "[", 
       RowBox[{"d", ",", 
        RowBox[{"-", "c"}]}], "]"}]}]}], "//", "ContractBasis"}], "//", 
   "HarmonicComponent"}], "//", "Simplify"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["which has the correct geometric Laplacian:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gamma", "[", 
    RowBox[{"a", ",", "b"}], "]"}], 
   RowBox[{
    RowBox[{"cd", "[", 
     RowBox[{"-", "a"}], "]"}], "@", 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "b"}], "]"}], "@", 
     RowBox[{"Z", "[", 
      RowBox[{
       RowBox[{"LI", "[", "4", "]"}], ",", 
       RowBox[{"LI", "[", 
        RowBox[{"-", "2"}], "]"}], ",", "c"}], "]"}]}]}]}], "//", 
  "ContractMetric"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "19"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "   ", 
     RowBox[{"4", "-", 
      RowBox[{"2", "c"}]}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[-2], c],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gamma", "[", 
     RowBox[{"a", ",", "b"}], "]"}], 
    RowBox[{
     RowBox[{"cd", "[", 
      RowBox[{"-", "a"}], "]"}], "@", 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "b"}], "]"}], "@", 
      RowBox[{"Z", "[", 
       RowBox[{
        RowBox[{"LI", "[", "l", "]"}], ",", 
        RowBox[{"LI", "[", "m", "]"}], ",", "c"}], "]"}]}]}]}], "//", 
   "ContractMetric"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False], "+", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "2"]}], ")"}]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "   ", "lmc"],
    AutoSpacing->False],
   Z[
    LI[l], 
    LI[m], c],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{"a", ",", "b"}], "]"}], 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "a"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "b"}], "]"}], "@", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l", "]"}], ",", 
         RowBox[{"LI", "[", "m", "]"}], ",", "c", ",", "d"}], "]"}]}]}]}], "//",
     "ContractMetric"}], "//", "Simplification"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "4"}], "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False], "+", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "2"]}], ")"}]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "    ", "lmcd"],
    AutoSpacing->False],
   Z[
    LI[l], 
    LI[m], c, d],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{"a", ",", "b"}], "]"}], 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "a"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "b"}], "]"}], "@", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l", "]"}], ",", 
         RowBox[{"LI", "[", "m", "]"}], ",", "c", ",", "d", ",", "e"}], 
        "]"}]}]}]}], "//", "ContractMetric"}], "//", "Simplification"}], "//",
   "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "9"}], "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False], "+", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "2"]}], ")"}]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "     ", "lmcde"],
    AutoSpacing->False],
   Z[
    LI[l], 
    LI[m], c, d, e],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{"a", ",", "b"}], "]"}], 
     RowBox[{
      RowBox[{"cd", "[", 
       RowBox[{"-", "a"}], "]"}], "@", 
      RowBox[{
       RowBox[{"cd", "[", 
        RowBox[{"-", "b"}], "]"}], "@", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l", "]"}], ",", 
         RowBox[{"LI", "[", "m", "]"}], ",", "c", ",", "d", ",", "e", ",", 
         "f"}], "]"}]}]}]}], "//", "ContractMetric"}], "//", 
   "Simplification"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     InterpretationBox[
      StyleBox["l",
       AutoSpacing->False],
      l,
      Editable->False], "+", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], "2"]}], ")"}]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "      ", "lmcdef"],
    AutoSpacing->False],
   Z[
    LI[l], 
    LI[m], c, d, e, f],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Laplacian", "[", "newZ", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["57", "16"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "+", 
   RowBox[{"19", " ", "newZ"}]}], "//", "Simplify"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Let us study the tangential part:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"O1tangential", "=", 
  RowBox[{
   RowBox[{"O1", "/.", 
    RowBox[{
     RowBox[{"Basis", "[", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Rule]", "0"}]}], "//",
    "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "48"]}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"8", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"20", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{1, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"O2tangential", "=", 
  RowBox[{
   RowBox[{"O2", "/.", 
    RowBox[{
     RowBox[{"Basis", "[", 
      RowBox[{"_", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "\[Rule]", "0"}]}], "//",
    "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "24"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], " "}], 
           RowBox[{" ", "d"}]],
          AutoSpacing->False],
         Basis[{2, -spherical}, d],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["e", 
           RowBox[{
            StyleBox["1",
             FontColor->RGBColor[1, 0, 0]], " "}], 
           RowBox[{" ", "d"}]],
          AutoSpacing->False],
         Basis[{1, -spherical}, d],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
The following expressions have changed and now are far more complicated. In \
particular the sums should yield zero. It must be related to the issue of \
whether the cnumbers of the bases are {1,2,3} or {2,3}. Removing the \
Christoffel terms containing a component 1 and removing the result in the \
direction 1 we get zero again:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Laplacian", "[", "O1tangential", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "48"]}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Csc",
     AutoSpacing->False],
    Csc,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "80"}], " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"152", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"50", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["3",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"532", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"35", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["3",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"15", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"2", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "+", 
          RowBox[{"21", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"15", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"2", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{2, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "+", 
       RowBox[{"20", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"2", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{2, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "-", 
       RowBox[{"35", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"2", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{2, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "+", 
       RowBox[{"100", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"3", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["3",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{3, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "+", 
       RowBox[{"140", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"3", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["3",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{3, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
           1, -spherical}]],
         Editable->False]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"17", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "40"}], " ", "\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"3", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"5", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"2", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}], "+", 
             RowBox[{"35", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"4", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "38"}], " ", "\[ImaginaryI]"}], "+", 
             RowBox[{"5", " ", 
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False], "]"}], "2"], " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"2", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["2",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{2, -spherical}][
                
                ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
                 1, -spherical}]],
               Editable->False]}], "+", 
             RowBox[{"5", " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"3", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["3",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{3, -spherical}][
                
                ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
                 1, -spherical}]],
               Editable->False]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "+", 
   RowBox[{"19", " ", "O1tangential"}]}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "96"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Csc",
     AutoSpacing->False],
    Csc,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "152"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{1, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "3"]}], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"2", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "-", 
          RowBox[{"63", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"3", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False], "]"}], "2"], " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"2", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["2",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["2",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{2, -spherical}][
                
                ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
                 1, -spherical}]],
               Editable->False]}], "+", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox[
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"D", ",", 
                  StyleBox["\[ScriptCapitalD]",
                   FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                RowBox[{" ", 
                 RowBox[{
                  StyleBox[
                   RowBox[{"3", "1"}],
                   FontColor->RGBColor[1, 0, 0]], ":", 
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]]}]}], 
                RowBox[{
                 StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]], "    "}]],
               AutoSpacing->False],
              cd[{3, -spherical}][
               
               ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
                1, -spherical}]],
              Editable->False]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"17", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"3", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"2", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}], "+", 
             RowBox[{"70", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"4", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False], "]"}], "2"], " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"2", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["2",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{2, -spherical}][
                
                ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
                 1, -spherical}]],
               Editable->False]}], "+", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox[
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"D", ",", 
                  StyleBox["\[ScriptCapitalD]",
                   FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                RowBox[{" ", 
                 RowBox[{
                  StyleBox[
                   RowBox[{"3", "1"}],
                   FontColor->RGBColor[1, 0, 0]], ":", 
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]]}]}], 
                RowBox[{
                 StyleBox["3",
                  FontColor->RGBColor[1, 0, 0]], "    "}]],
               AutoSpacing->False],
              cd[{3, -spherical}][
               
               ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
                1, -spherical}]],
              Editable->False]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{
   RowBox[{"ChristoffelcdPDspherical", "[", 
    RowBox[{"___", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "_"}], "}"}], ",", "___"}], "]"}], "\[Rule]", 
   "0"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["95", "12"]}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["1",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "d"}]],
    AutoSpacing->False],
   Basis[{1, -spherical}, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{"5", "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "2"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Laplacian", "[", "O2tangential", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "48"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Csc",
     AutoSpacing->False],
    Csc,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "16"}], " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"38", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"10", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["3",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"133", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"7", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["3",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"2", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "+", 
          RowBox[{"63", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"2", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{2, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"2", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{2, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "-", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"2", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["2",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{2, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "+", 
       RowBox[{"20", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"3", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["3",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{3, -spherical}][
          ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
           1, -spherical}]],
         Editable->False]}], "+", 
       RowBox[{"28", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            RowBox[{
             StyleBox[
              RowBox[{"3", "1"}],
              FontColor->RGBColor[1, 0, 0]], ":", 
             StyleBox["3",
              FontColor->RGBColor[1, 0, 0]]}]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "    "}]],
          AutoSpacing->False],
         cd[{3, -spherical}][
          
          ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
           1, -spherical}]],
         Editable->False]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"17", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"3", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"2", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}], "+", 
             RowBox[{"35", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"4", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"19", " ", "\[ImaginaryI]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False], "]"}], "2"], " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"2", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["2",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{2, -spherical}][
                
                ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
                 1, -spherical}]],
               Editable->False]}], "+", 
             RowBox[{"2", " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"3", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["3",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{3, -spherical}][
                
                ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
                 1, -spherical}]],
               Editable->False]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "+", 
   RowBox[{"19", " ", "O2tangential"}]}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "96"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Csc",
     AutoSpacing->False],
    Csc,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Theta]", "", ""],
     AutoSpacing->False],
    \[Theta][],
    Editable->False], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"152", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{1, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "3"]}], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["2",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{2, -spherical}, d],
      Editable->False], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "16"}], " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"2", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "+", 
          RowBox[{"63", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"3", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Sin",
              AutoSpacing->False],
             Sin,
             Editable->False], "[", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False], "]"}], "2"], " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"2", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["2",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["2",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{2, -spherical}][
                
                ChristoffelcdPDspherical[{2, spherical}, {2, -spherical}, {
                 1, -spherical}]],
               Editable->False]}], "+", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox[
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"D", ",", 
                  StyleBox["\[ScriptCapitalD]",
                   FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                RowBox[{" ", 
                 RowBox[{
                  StyleBox[
                   RowBox[{"3", "1"}],
                   FontColor->RGBColor[1, 0, 0]], ":", 
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]]}]}], 
                RowBox[{
                 StyleBox["2",
                  FontColor->RGBColor[1, 0, 0]], "    "}]],
               AutoSpacing->False],
              cd[{3, -spherical}][
               
               ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
                1, -spherical}]],
              Editable->False]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["e", 
        RowBox[{
         StyleBox["3",
          FontColor->RGBColor[1, 0, 0]], " "}], 
        RowBox[{" ", "d"}]],
       AutoSpacing->False],
      Basis[{3, -spherical}, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"D", ",", 
             StyleBox["\[ScriptCapitalD]",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], 
           RowBox[{" ", 
            StyleBox[
             RowBox[{"3", "1"}],
             FontColor->RGBColor[1, 0, 0]]}], 
           RowBox[{
            StyleBox["2",
             FontColor->RGBColor[1, 0, 0]], "  "}]],
          AutoSpacing->False],
         ChristoffelcdPDspherical[{2, spherical}, {3, -spherical}, {
          1, -spherical}],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"17", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False], "]"}]}], "+", 
          RowBox[{"7", " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            RowBox[{"3", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "\[ImaginaryI]", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"3", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"D", ",", 
                StyleBox["\[ScriptCapitalD]",
                 FontColor->RGBColor[1, 0, 0]]}], "]"}], 
              RowBox[{" ", 
               StyleBox[
                RowBox[{"2", "1"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              RowBox[{
               StyleBox["3",
                FontColor->RGBColor[1, 0, 0]], "  "}]],
             AutoSpacing->False],
            
            ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
             1, -spherical}],
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}], "+", 
             RowBox[{"70", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Sin",
                 AutoSpacing->False],
                Sin,
                Editable->False], "[", 
               RowBox[{"4", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"7", " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["Cos",
                 AutoSpacing->False],
                Cos,
                Editable->False], "[", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox[
                  SubsuperscriptBox["\[Theta]", "", ""],
                  AutoSpacing->False],
                 \[Theta][],
                 Editable->False], "]"}], "2"], " ", 
              InterpretationBox[
               StyleBox[
                SubsuperscriptBox[
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"D", ",", 
                   StyleBox["\[ScriptCapitalD]",
                    FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                 RowBox[{" ", 
                  RowBox[{
                   StyleBox[
                    RowBox[{"2", "1"}],
                    FontColor->RGBColor[1, 0, 0]], ":", 
                   StyleBox["2",
                    FontColor->RGBColor[1, 0, 0]]}]}], 
                 RowBox[{
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]], "    "}]],
                AutoSpacing->False],
               cd[{2, -spherical}][
                
                ChristoffelcdPDspherical[{3, spherical}, {2, -spherical}, {
                 1, -spherical}]],
               Editable->False]}], "+", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox[
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"D", ",", 
                  StyleBox["\[ScriptCapitalD]",
                   FontColor->RGBColor[1, 0, 0]]}], "]"}], 
                RowBox[{" ", 
                 RowBox[{
                  StyleBox[
                   RowBox[{"3", "1"}],
                   FontColor->RGBColor[1, 0, 0]], ":", 
                  StyleBox["3",
                   FontColor->RGBColor[1, 0, 0]]}]}], 
                RowBox[{
                 StyleBox["3",
                  FontColor->RGBColor[1, 0, 0]], "    "}]],
               AutoSpacing->False],
              cd[{3, -spherical}][
               
               ChristoffelcdPDspherical[{3, spherical}, {3, -spherical}, {
                1, -spherical}]],
              Editable->False]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{
   RowBox[{"ChristoffelcdPDspherical", "[", 
    RowBox[{"___", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "_"}], "}"}], ",", "___"}], "]"}], "\[Rule]", 
   "0"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["95", "12"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Phi]", "", ""],
      AutoSpacing->False],
     \[Phi][],
     Editable->False]}]], " ", 
  SqrtBox[
   FractionBox["5", 
    RowBox[{"2", " ", "\[Pi]"}]]], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["e", 
     RowBox[{
      StyleBox["1",
       FontColor->RGBColor[1, 0, 0]], " "}], 
     RowBox[{" ", "d"}]],
    AutoSpacing->False],
   Basis[{1, -spherical}, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{"5", "+", 
    RowBox[{"7", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{
    InterpretationBox[
     StyleBox["Sin",
      AutoSpacing->False],
     Sin,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], "2"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{"l", 
    RowBox[{"(", 
     RowBox[{"l", "+", "1"}], ")"}]}], "-", 
   RowBox[{"s", "^", "2"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox["l",
    AutoSpacing->False],
   l,
   Editable->False], "+", 
  SuperscriptBox[
   InterpretationBox[
    StyleBox["l",
     AutoSpacing->False],
    l,
    Editable->False], "2"], "-", 
  SuperscriptBox["s", "2"]}]], "Output"]
}, Open  ]],

Cell["Now we study the Laplacian acting on the scalar components:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"basis", "[", "spherical", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Basis", "[", 
      RowBox[{
       RowBox[{"-", "d"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "spherical"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"Basis", "[", 
      RowBox[{
       RowBox[{"-", "d"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "spherical"}], "}"}]}], "]"}], ",", 
     RowBox[{"Basis", "[", 
      RowBox[{
       RowBox[{"-", "d"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "spherical"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basis", "[", "cartesian", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "d"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "cartesian"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "d"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "cartesian"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "[", 
     RowBox[{
      RowBox[{"-", "d"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "cartesian"}], "}"}]}], "]"}]}], "}"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"O1", " ", 
    RowBox[{"basis", "[", "spherical", "]"}]}], "//", "ContractBasis"}], "//",
   "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["5", "12"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"]}], ",", 
   RowBox[{
    FractionBox["1", "12"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        RowBox[{"4", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "20"}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"34", "-", 
       RowBox[{"87", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"35", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"7", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "11"}], "-", 
       RowBox[{"28", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"O2", " ", 
    RowBox[{"basis", "[", "spherical", "]"}]}], "//", "ContractBasis"}], "//",
   "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["5", "12"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"]}], ",", 
   RowBox[{
    FractionBox["5", "24"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["5", "24"]}], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "20"}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"34", "-", 
       RowBox[{"87", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"35", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"7", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "11"}], "-", 
       RowBox[{"28", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"newZ", " ", 
    RowBox[{"basis", "[", "spherical", "]"}]}], "//", "ContractBasis"}], "//",
   "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    FractionBox["3", "16"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        RowBox[{"4", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "8"]}], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox["Power",
     AutoSpacing->False],
    Power,
    Editable->False], "::", "\<\"infy\"\>"}], ":", 
  " ", "\<\"Infinite expression \\!\\(1\\/0\\) encountered. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Power::infy\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Infinity]", "::", "\<\"indet\"\>"}], ":", 
  " ", "\<\"Indeterminate expression \\!\\(0\\\\ ComplexInfinity\\) \
encountered. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::indet\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Indeterminate", ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"34", "-", 
       RowBox[{"87", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"35", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"7", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"2", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "11"}], "-", 
       RowBox[{"28", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Csc",
         AutoSpacing->False],
        Csc,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Theta]", "", ""],
            AutoSpacing->False],
           \[Theta][],
           Editable->False]}], "]"}]}]}], ")"}]}]]}], "}"}]], "Output"]
}, Open  ]],

Cell["Cartesian components:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"O1", " ", 
     RowBox[{"basis", "[", "cartesian", "]"}]}], "//", "ContractBasis"}], "//",
    "ToValues"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "96"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "18"}], " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "-", 
         RowBox[{"35", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"63", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"5", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "96"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "18"}], " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "-", 
         RowBox[{"35", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"63", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"5", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["7", "8"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "30"}], ",", 
   RowBox[{"-", "30"}], ",", 
   RowBox[{"-", "30"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"O2", " ", 
     RowBox[{"basis", "[", "cartesian", "]"}]}], "//", "ContractBasis"}], "//",
    "ToValues"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["5", "24"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"8", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{"2", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{"2", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["5", "24"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{"2", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{"2", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["5", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "12"}], ",", 
   RowBox[{"-", "12"}], ",", 
   RowBox[{"-", "12"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"newZ", " ", 
     RowBox[{"basis", "[", "cartesian", "]"}]}], "//", "ContractBasis"}], "//",
    "ToValues"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "16"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False], "]"}], "2"], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"9", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "-", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["3", "16"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"3", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"2", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{"4", " ", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Theta]", "", ""],
              AutoSpacing->False],
             \[Theta][],
             Editable->False]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Sin",
          AutoSpacing->False],
         Sin,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Phi]", "", ""],
          AutoSpacing->False],
         \[Phi][],
         Editable->False], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "8"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SqrtBox[
     FractionBox["5", 
      RowBox[{"2", " ", "\[Pi]"}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LaplacianOnScalars", "[", "%", "]"}], "/", "%"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "-", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"21", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "-", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"14", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Phi]", "", ""],
             AutoSpacing->False],
            \[Phi][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "+", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"21", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "+", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "-", 
         RowBox[{"28", " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "-", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"40", " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Phi]", "", ""],
             AutoSpacing->False],
            \[Phi][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"28", " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "+", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{
        FractionBox["7", "2"], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"4", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"5", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], "+", 
       RowBox[{"6", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "+", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{
        FractionBox["7", "2"], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"4", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "+", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"7", " ", "\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"10", " ", "\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], "+", 
       RowBox[{"7", " ", "\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "+", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"10", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "28"}], " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "-", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "-", 
         RowBox[{"40", " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Phi]", "", ""],
             AutoSpacing->False],
            \[Phi][],
            Editable->False], "]"}]}], "-", 
         RowBox[{"28", " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Cos",
             AutoSpacing->False],
            Cos,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "+", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "-", 
         RowBox[{"20", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "-", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "-", 
         RowBox[{"21", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "-", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"14", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Phi]", "", ""],
             AutoSpacing->False],
            \[Phi][],
            Editable->False], "]"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "+", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}], "+", 
         RowBox[{"21", " ", 
          RowBox[{
           InterpretationBox[
            StyleBox["Sin",
             AutoSpacing->False],
            Sin,
            Editable->False], "[", 
           RowBox[{
            RowBox[{"4", " ", 
             InterpretationBox[
              StyleBox[
               SubsuperscriptBox["\[Theta]", "", ""],
               AutoSpacing->False],
              \[Theta][],
              Editable->False]}], "+", 
            InterpretationBox[
             StyleBox[
              SubsuperscriptBox["\[Phi]", "", ""],
              AutoSpacing->False],
             \[Phi][],
             Editable->False]}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "14"}], " ", "\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"20", " ", "\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], "-", 
       RowBox[{"14", " ", "\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Cos",
           AutoSpacing->False],
          Cos,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "+", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"12", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "-", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"4", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"10", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Phi]", "", ""],
           AutoSpacing->False],
          \[Phi][],
          Editable->False], "]"}]}], "+", 
       RowBox[{"12", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "+", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}], "+", 
       RowBox[{"7", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Sin",
           AutoSpacing->False],
          Sin,
          Editable->False], "[", 
         RowBox[{
          RowBox[{"4", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "+", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[Phi]", "", ""],
            AutoSpacing->False],
           \[Phi][],
           Editable->False]}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"30", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"7", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Cos",
            AutoSpacing->False],
           Cos,
           Editable->False], "[", 
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["\[Theta]", "", ""],
             AutoSpacing->False],
            \[Theta][],
            Editable->False]}], "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"7", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}]]}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["5. Products of harmonics", "Subsection"],

Cell[CellGroupData[{

Cell["Products of calDs", "Subsubsection"],

Cell["This checks that the formula in the paper is correct:", "Text"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"ClebschGordan", "::", "phy"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j1", "=", "4"}], ",", 
      RowBox[{"m1p", "=", "1"}], ",", 
      RowBox[{"m1", "=", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"j2", "=", "6"}], ",", 
      RowBox[{"m2p", "=", 
       RowBox[{"-", "2"}]}], ",", 
      RowBox[{"m2", "=", "4"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"calDEdmonds", "[", 
        RowBox[{"j1", ",", "m1p", ",", "m1"}], "]"}], "[", 
       RowBox[{"alpha", ",", "beta", ",", "gamma"}], "]"}], 
      RowBox[{
       RowBox[{"calDEdmonds", "[", 
        RowBox[{"j2", ",", "m2p", ",", "m2"}], "]"}], "[", 
       RowBox[{"alpha", ",", "beta", ",", "gamma"}], "]"}]}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ClebschGordan", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j1", ",", "m1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j2", ",", "m2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"m1", "+", "m2"}]}], "}"}]}], "]"}], 
        RowBox[{"ClebschGordan", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j1", ",", "m1p"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j2", ",", "m2p"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"m1p", "+", "m2p"}]}], "}"}]}], "]"}], 
        RowBox[{
         RowBox[{"calDEdmonds", "[", 
          RowBox[{"j", ",", 
           RowBox[{"m1p", "+", "m2p"}], ",", 
           RowBox[{"m1", "+", "m2"}]}], "]"}], "[", 
         RowBox[{"alpha", ",", "beta", ",", "gamma"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"j1", "-", "j2"}], "]"}], ",", 
         RowBox[{"j1", "+", "j2"}]}], "}"}]}], "]"}]}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Products of PureSpins", "Subsubsection"],

Cell["\<\
Product coefficients. We do not want to define tensors, but need to state how \
the main functions act on them:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{"coeffE", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s_", ",", "l_", ",", "m_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sp_", ",", "lp_", ",", "mp_"}], "}"}], ",", "lpp_"}], "]"}], 
   "]"}], ":=", 
  RowBox[{"Subsuperscript", "[", 
   RowBox[{"\"\<E\>\"", ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"ToString", "[", "s", "]"}], ",", "\"\<,\>\"", ",", 
      RowBox[{"ToString", "[", "l", "]"}], ",", "\"\<,\>\"", ",", 
      RowBox[{"ToString", "[", "m", "]"}], ",", "\"\<;\>\"", ",", 
      RowBox[{"ToString", "[", "lpp", "]"}]}], "]"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"ToString", "[", "sp", "]"}], ",", "\"\<,\>\"", ",", 
      RowBox[{"ToString", "[", "lp", "]"}], ",", "\"\<,\>\"", ",", 
      RowBox[{"ToString", "[", "mp", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffE", "/:", 
   RowBox[{"FindIndices", "[", 
    RowBox[{"coeffE", "[", "___", "]"}], "]"}], "=", 
   RowBox[{"IndexList", "[", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"_", "?", "FirstDerQ"}], "[", 
    RowBox[{"coeffE", "[", "__", "]"}], "]"}], "^=", "0"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IsIndexOf", "[", 
    RowBox[{
     RowBox[{"coeffE", "[", "___", "]"}], ",", "__"}], "]"}], "^:=", 
   "False"}], ";"}]], "Input",
 InitializationCell->True],

Cell["Substitution rule:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coeffERule", "=", 
  RowBox[{
   RowBox[{"coeffE", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s_", ",", "l_", ",", "m_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sp_", ",", "lp_", ",", "mp_"}], "}"}], ",", "lpp_"}], "]"}], 
   "\[RuleDelayed]", 
   RowBox[{
    RowBox[{"coeffK", "[", 
     RowBox[{"lp", ",", 
      RowBox[{"Abs", "[", "sp", "]"}]}], "]"}], 
    RowBox[{
     RowBox[{"coeffK", "[", 
      RowBox[{"l", ",", 
       RowBox[{"Abs", "[", "s", "]"}]}], "]"}], "/", 
     RowBox[{"coeffK", "[", 
      RowBox[{"lpp", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"s", "+", "sp"}], "]"}]}], "]"}]}], 
    RowBox[{"ClebschGordan", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lp", ",", "mp"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "m"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lpp", ",", 
        RowBox[{"m", "+", "mp"}]}], "}"}]}], "]"}], 
    RowBox[{"ClebschGordan", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lp", ",", "sp"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "s"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lpp", ",", 
        RowBox[{"s", "+", "sp"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"s_,l_,m_;lpp_\"\>", "\<\"sp_,lp_,mp_\"\
\>"],
   Subsuperscript["E", "s_,l_,m_;lpp_", "sp_,lp_,mp_"],
   Editable->False], "\[RuleDelayed]", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"coeffK", "[", 
     RowBox[{"lpp", ",", 
      RowBox[{
       InterpretationBox[
        StyleBox["Abs",
         AutoSpacing->False],
        Abs,
        Editable->False], "[", 
       RowBox[{"s", "+", "sp"}], "]"}]}], "]"}]], 
   RowBox[{
    RowBox[{"coeffK", "[", 
     RowBox[{"lp", ",", 
      RowBox[{
       InterpretationBox[
        StyleBox["Abs",
         AutoSpacing->False],
        Abs,
        Editable->False], "[", "sp", "]"}]}], "]"}], " ", 
    RowBox[{"coeffK", "[", 
     RowBox[{
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False], ",", 
      RowBox[{
       InterpretationBox[
        StyleBox["Abs",
         AutoSpacing->False],
        Abs,
        Editable->False], "[", "s", "]"}]}], "]"}], " ", 
    RowBox[{"ClebschGordan", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lp", ",", "mp"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         StyleBox["l",
          AutoSpacing->False],
         l,
         Editable->False], ",", "m"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lpp", ",", 
        RowBox[{"m", "+", "mp"}]}], "}"}]}], "]"}], " ", 
    RowBox[{"ClebschGordan", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lp", ",", "sp"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         StyleBox["l",
          AutoSpacing->False],
         l,
         Editable->False], ",", "s"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lpp", ",", 
        RowBox[{"s", "+", "sp"}]}], "}"}]}], "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell["Scalar case:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coeffE", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "l", ",", "m"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "lp", ",", "mp"}], "}"}], ",", "lpp"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ClebschGordan", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lp", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lpp", ",", "0"}], "}"}]}], "]"}], 
      RowBox[{"ClebschGordan", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lp", ",", "mp"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lpp", ",", 
          RowBox[{"m", "+", "mp"}]}], "}"}]}], "]"}]}], ")"}]}], "/.", 
   "coeffERule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False]}], "+", 
     RowBox[{"4", " ", "lp"}]}]], " ", 
   SqrtBox[
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      InterpretationBox[
       StyleBox["l",
        AutoSpacing->False],
       l,
       Editable->False]}]}]], " ", 
   SqrtBox[
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "lp"}]}]]}], 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{"\[Pi]", "+", 
     RowBox[{"2", " ", "lpp", " ", "\[Pi]"}]}]]}]]], "Output"]
}, Open  ]],

Cell["\<\
Mathematica knows how to expand factorials near Infinity (Stirling expansion)\
\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"Gamma", "[", 
     RowBox[{"x", "+", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "Infinity", ",", "1"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "::", "\<\"esss\"\>"}], ":", 
  " ", "\<\"Essential singularity encountered in \
\\!\\(\[ExponentialE]\\^\\*InterpretationBox[\\(\\(\\(-\\(\\(1\\/\\(1\\/x\\)\\\
)\\)\\)\\) + \\*InterpretationBox[\\(\\(O[\\(\\(1\\/x\\)\\)]\\)\\^3\\), \
SeriesData[x, DirectedInfinity[1], List[], -1, 3, 1], Rule[Editable, \
False]]\\), SeriesData[x, DirectedInfinity[1], List[-1], -1, 3, 1], \
Rule[Editable, False]]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Series::esss\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "::", "\<\"esss\"\>"}], ":", 
  " ", "\<\"Essential singularity encountered in \
\\!\\(\[ExponentialE]\\^\\*InterpretationBox[\\(\\(\\(-\\(\\(1\\/x\\)\\)\\)\\)\
 + \\*InterpretationBox[\\(\\(O[x]\\)\\^3\\), SeriesData[x, 0, List[], -1, 3, \
1], Rule[Editable, False]]\\), SeriesData[x, 0, List[-1], -1, 3, 1], \
Rule[Editable, False]]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Series::esss\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "::", "\<\"esss\"\>"}], ":", 
  " ", "\<\"Essential singularity encountered in \
\\!\\(\[ExponentialE]\\^\\*InterpretationBox[\\(\\(\\(-\\(\\(1\\/\\(1\\/x\\)\\\
)\\)\\)\\) + \\*InterpretationBox[\\(\\(O[\\(\\(1\\/x\\)\\)]\\)\\^3\\), \
SeriesData[x, DirectedInfinity[1], List[], -1, 3, 1], Rule[Editable, \
False]]\\), SeriesData[x, DirectedInfinity[1], List[-1], -1, 3, 1], \
Rule[Editable, False]]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Series::esss\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], ":", 
  " ", "\<\"Further output of \\!\\(Series :: \\\"esss\\\"\\) will be \
suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "x"}]], " ", 
  SuperscriptBox["x", "x"], " ", 
  RowBox[{"(", 
   InterpretationBox[
    RowBox[{
     FractionBox[
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], 
      SqrtBox[
       FractionBox["1", "x"]]], "+", 
     InterpretationBox[
      SqrtBox[
       RowBox[{"O", "[", 
        FractionBox["1", "x"], "]"}]],
      SeriesData[x, 
       DirectedInfinity[1], {}, -1, 1, 2],
      Editable->False]}],
    SeriesData[x, 
     DirectedInfinity[1], {(2 Pi)^Rational[1, 2]}, -1, 1, 2],
    Editable->False], ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
Expansion of the prefactor of the E coefficients for large L:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"coeffK", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "Lp", "+", "lpp"}], ")"}], "/", "2"}], ",", "sp"}],
       "]"}], 
     RowBox[{"coeffK", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "Lp", "+", "lpp"}], ")"}], "/", "2"}], ",", "s"}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"L", ",", "Infinity", ",", "1"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     SuperscriptBox["L", 
      RowBox[{"2", " ", "s"}]], " ", 
     RowBox[{"(", 
      InterpretationBox[
       RowBox[{
        FractionBox[
         SuperscriptBox["2", 
          RowBox[{
           RowBox[{"-", "2"}], "-", 
           RowBox[{"3", " ", "s"}]}]], 
         FractionBox["1", "L"]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", 
           FractionBox["1", "L"], "]"}], "0"],
         SeriesData[L, 
          DirectedInfinity[1], {}, -2, 0, 2],
         Editable->False]}],
       SeriesData[L, 
        DirectedInfinity[1], {2^(-2 - 3 s)}, -2, 0, 2],
       Editable->False], ")"}]}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["L", 
      RowBox[{"2", " ", "sp"}]], " ", 
     RowBox[{"(", 
      InterpretationBox[
       RowBox[{
        FractionBox[
         SuperscriptBox["2", 
          RowBox[{
           RowBox[{"-", "2"}], "-", 
           RowBox[{"3", " ", "sp"}]}]], 
         FractionBox["1", "L"]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", 
           FractionBox["1", "L"], "]"}], "0"],
         SeriesData[L, 
          DirectedInfinity[1], {}, -2, 0, 2],
         Editable->False]}],
       SeriesData[L, 
        DirectedInfinity[1], {2^(-2 - 3 sp)}, -2, 0, 2],
       Editable->False], ")"}]}]]}], "\[Pi]"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerExpand", "[", "%", "]"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["L", 
   RowBox[{"s", "+", "sp"}]], " ", 
  RowBox[{"(", 
   InterpretationBox[
    RowBox[{
     FractionBox[
      SuperscriptBox["2", 
       RowBox[{
        RowBox[{"-", "2"}], "-", 
        FractionBox[
         RowBox[{"3", " ", "s"}], "2"], "-", 
        FractionBox[
         RowBox[{"3", " ", "sp"}], "2"]}]], 
      FractionBox["\[Pi]", "L"]], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", 
        FractionBox["1", "L"], "]"}], "0"],
      SeriesData[L, 
       DirectedInfinity[1], {}, -2, 0, 2],
      Editable->False]}],
    SeriesData[L, 
     DirectedInfinity[1], {
     2^(-2 + Rational[-3, 2] s + Rational[-3, 2] sp)/Pi}, -2, 0, 2],
    Editable->False], ")"}]}]], "Output"]
}, Open  ]],

Cell["Checks of the formulas in the paper:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"lp", "=", "3"}], ",", 
      RowBox[{"mp", "=", "2"}], ",", 
      RowBox[{"l", "=", "3"}], ",", 
      RowBox[{"mlabel", "=", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PureSpin", "[", 
        RowBox[{"lp", ",", "1", ",", "mp"}], "]"}], "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
      RowBox[{
       RowBox[{"PureSpin", "[", 
        RowBox[{"l", ",", "1", ",", "mlabel"}], "]"}], "[", 
       RowBox[{"d", ",", "e", ",", "f"}], "]"}]}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coeffE", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "lp", ",", "mp"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "l", ",", "mlabel"}], "}"}], ",", "j"}], "]"}], 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"mp", "+", "mlabel"}]}], "]"}], "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"lp", "-", "l"}], "]"}], ",", "6"}], "]"}], ",", 
         RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", "330"],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[3], 
        LI[0]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", "332"],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[3], 
        LI[2]],
       Editable->False]}], "-", 
     RowBox[{"4", " ", 
      SqrtBox[
       RowBox[{"3003", " ", "\[Pi]"}]], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", "662"],
        AutoSpacing->False],
       calD[
        LI[6], 
        LI[6], 
        LI[2]],
       Editable->False], " ", 
      InterpretationBox[
       SubsuperscriptBox["\<\"E\"\>", "\<\"3,3,2;6\"\>", "\<\"3,3,0\"\>"],
       Subsuperscript["E", "3,3,2;6", "3,3,0"],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "a"],
     AutoSpacing->False],
    m[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "c"],
     AutoSpacing->False],
    m[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "d"],
     AutoSpacing->False],
    m[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "e"],
     AutoSpacing->False],
    m[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "f"],
     AutoSpacing->False],
    m[f],
    Editable->False]}], 
  RowBox[{"2", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", "330"],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[3], 
        LI[0]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", "332"],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[3], 
        LI[2]],
       Editable->False]}], "-", 
     RowBox[{"14", " ", 
      SqrtBox[
       FractionBox["2", "33"]], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", "662"],
        AutoSpacing->False],
       calD[
        LI[6], 
        LI[6], 
        LI[2]],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "a"],
     AutoSpacing->False],
    m[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "c"],
     AutoSpacing->False],
    m[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "d"],
     AutoSpacing->False],
    m[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "e"],
     AutoSpacing->False],
    m[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "f"],
     AutoSpacing->False],
    m[f],
    Editable->False]}], 
  RowBox[{"2", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "calDRule"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"lp", "=", "3"}], ",", 
      RowBox[{"mp", "=", 
       RowBox[{"-", "2"}]}], ",", 
      RowBox[{"l", "=", "3"}], ",", 
      RowBox[{"mlabel", "=", 
       RowBox[{"-", "1"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PureSpin", "[", 
        RowBox[{"lp", ",", 
         RowBox[{"-", "1"}], ",", "mp"}], "]"}], "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
      RowBox[{
       RowBox[{"PureSpin", "[", 
        RowBox[{"l", ",", 
         RowBox[{"-", "1"}], ",", "mlabel"}], "]"}], "[", 
       RowBox[{"d", ",", "e", ",", "f"}], "]"}]}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coeffE", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3"}], ",", "lp", ",", "mp"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3"}], ",", "l", ",", "mlabel"}], "}"}], ",", "j"}], 
         "]"}], 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"j", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"mp", "+", "mlabel"}]}], "]"}], "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"lp", "-", "l"}], "]"}], ",", "6"}], "]"}], ",", 
         RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"3", "-", "3", "-", "2"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[-3], 
        LI[-2]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"3", "-", "3", "-", "1"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[-3], 
        LI[-1]],
       Editable->False]}], "-", 
     RowBox[{"4", " ", 
      SqrtBox[
       RowBox[{"3003", " ", "\[Pi]"}]], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"6", "-", "6", "-", "3"}]],
        AutoSpacing->False],
       calD[
        LI[6], 
        LI[-6], 
        LI[-3]],
       Editable->False], " ", 
      InterpretationBox[
       SubsuperscriptBox["\<\"E\"\>", "\<\"-3,3,-2;6\"\>", "\<\"-3,3,-1\"\>"],
       
       Subsuperscript["E", "-3,3,-2;6", "-3,3,-1"],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "a"],
     AutoSpacing->False],
    mbar[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "c"],
     AutoSpacing->False],
    mbar[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "d"],
     AutoSpacing->False],
    mbar[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "e"],
     AutoSpacing->False],
    mbar[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "f"],
     AutoSpacing->False],
    mbar[f],
    Editable->False]}], 
  RowBox[{"2", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"3", "-", "3", "-", "2"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[-3], 
        LI[-2]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"3", "-", "3", "-", "1"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[-3], 
        LI[-1]],
       Editable->False]}], "-", 
     FractionBox[
      RowBox[{"21", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"6", "-", "6", "-", "3"}]],
         AutoSpacing->False],
        calD[
         LI[6], 
         LI[-6], 
         LI[-3]],
        Editable->False]}], 
      SqrtBox["22"]]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "a"],
     AutoSpacing->False],
    mbar[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "c"],
     AutoSpacing->False],
    mbar[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "d"],
     AutoSpacing->False],
    mbar[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "e"],
     AutoSpacing->False],
    mbar[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "f"],
     AutoSpacing->False],
    mbar[f],
    Editable->False]}], 
  RowBox[{"2", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "calDRule"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lp", "=", "3"}], ",", 
        RowBox[{"mp", "=", 
         RowBox[{"-", "2"}]}], ",", 
        RowBox[{"l", "=", "5"}], ",", 
        RowBox[{"mlabel", "=", 
         RowBox[{"-", "3"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"lp", ",", 
           RowBox[{"-", "1"}], ",", "mp"}], "]"}], "[", 
         RowBox[{"a", ",", "b"}], "]"}], 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l", ",", "1", ",", "mlabel"}], "]"}], "[", 
         RowBox[{"c", ",", "d", ",", "e", ",", "f"}], "]"}]}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeffE", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "lp", ",", "mp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "l", ",", "mlabel"}], "}"}], ",", "j"}], "]"}], 
          RowBox[{
           RowBox[{"PureSpin", "[", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"mp", "+", "mlabel"}]}], "]"}], "[", 
           RowBox[{"e", ",", "f"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"mbar", "[", "a", "]"}]}], 
            RowBox[{"m", "[", "c", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"mbar", "[", "b", "]"}]}], 
            RowBox[{"m", "[", "d", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"lp", "-", "l"}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}], "]"}], "//", 
    "Expand"}], ",", 
   RowBox[{"{", 
    RowBox[{"epsilongamma", "[", "__", "]"}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Pi]"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"630", " ", 
       SqrtBox["33"], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"3", "-", "2", "-", "2"}]],
         AutoSpacing->False],
        calD[
         LI[3], 
         LI[-2], 
         LI[-2]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"54", "-", "3"}]],
         AutoSpacing->False],
        calD[
         LI[5], 
         LI[4], 
         LI[-3]],
        Editable->False]}], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"5", " ", "\[Pi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["6"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"22", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[2], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;2\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;2", "4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{
          SqrtBox["42"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"32", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[3], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;3\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;3", "4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"9", " ", 
          SqrtBox["2"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"42", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[4], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;4\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;4", "4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{
          SqrtBox["462"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"52", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[5], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;5\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;5", "4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["273"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"62", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[6], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;6\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;6", "4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"18", " ", 
          SqrtBox["7"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"72", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[7], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;7\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;7", "4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"6", " ", 
          SqrtBox["119"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"82", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[8], 
            LI[2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-2,3,-2;8\"\>", \
"\<\"4,5,-3\"\>"],
           Subsuperscript["E", "-2,3,-2;8", "4,5,-3"],
           Editable->False]}]}], ")"}]}]}], ")"}], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "c"],
      AutoSpacing->False],
     m[c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "d"],
      AutoSpacing->False],
     m[d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "e"],
      AutoSpacing->False],
     m[e],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "f"],
      AutoSpacing->False],
     m[f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "a"],
      AutoSpacing->False],
     mbar[a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"72", " ", 
      SqrtBox["55"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"52", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[5], 
        LI[2], 
        LI[-5]],
       Editable->False]}], "+", 
     RowBox[{"364", " ", 
      SqrtBox["33"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"3", "-", "2", "-", "2"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[-2], 
        LI[-2]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"54", "-", "3"}]],
        AutoSpacing->False],
       calD[
        LI[5], 
        LI[4], 
        LI[-3]],
       Editable->False]}], "+", 
     RowBox[{"156", " ", 
      SqrtBox["10"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"62", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[6], 
        LI[2], 
        LI[-5]],
       Editable->False]}], "-", 
     RowBox[{"33", " ", 
      SqrtBox["3"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"72", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[7], 
        LI[2], 
        LI[-5]],
       Editable->False]}], "-", 
     RowBox[{"9", " ", 
      SqrtBox["195"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"82", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[8], 
        LI[2], 
        LI[-5]],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "c"],
     AutoSpacing->False],
    m[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "d"],
     AutoSpacing->False],
    m[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "e"],
     AutoSpacing->False],
    m[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "f"],
     AutoSpacing->False],
    m[f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "a"],
     AutoSpacing->False],
    mbar[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False]}], 
  RowBox[{"52", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "calDRule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lp", "=", "3"}], ",", 
        RowBox[{"mp", "=", 
         RowBox[{"-", "2"}]}], ",", 
        RowBox[{"l", "=", "5"}], ",", 
        RowBox[{"mlabel", "=", 
         RowBox[{"-", "3"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"lp", ",", "1", ",", "mp"}], "]"}], "[", 
         RowBox[{"a", ",", "b"}], "]"}], 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "mlabel"}], "]"}], "[", 
         RowBox[{"c", ",", "d", ",", "e", ",", "f"}], "]"}]}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeffE", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "lp", ",", "mp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "l", ",", "mlabel"}], "}"}], ",", 
            "j"}], "]"}], 
          RowBox[{
           RowBox[{"PureSpin", "[", 
            RowBox[{"j", ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"mp", "+", "mlabel"}]}], "]"}], "[", 
           RowBox[{"e", ",", "f"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"m", "[", "a", "]"}]}], 
            RowBox[{"mbar", "[", "c", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"m", "[", "b", "]"}]}], 
            RowBox[{"mbar", "[", "d", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"lp", "-", "l"}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}], "]"}], "//", 
    "Expand"}], ",", 
   RowBox[{"{", 
    RowBox[{"epsilongamma", "[", "__", "]"}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Pi]"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"630", " ", 
       SqrtBox["33"], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"32", "-", "2"}]],
         AutoSpacing->False],
        calD[
         LI[3], 
         LI[2], 
         LI[-2]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"5", "-", "4", "-", "3"}]],
         AutoSpacing->False],
        calD[
         LI[5], 
         LI[-4], 
         LI[-3]],
        Editable->False]}], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"5", " ", "\[Pi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["6"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"2", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[2], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;2\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;2", "-4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{
          SqrtBox["42"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"3", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[3], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;3\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;3", "-4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"9", " ", 
          SqrtBox["2"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"4", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[4], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;4\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;4", "-4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{
          SqrtBox["462"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"5", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[5], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;5\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;5", "-4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["273"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"6", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[6], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;6\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;6", "-4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"18", " ", 
          SqrtBox["7"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"7", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[7], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;7\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;7", "-4,5,-3"],
           Editable->False]}], "+", 
         RowBox[{"6", " ", 
          SqrtBox["119"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"8", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[8], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"2,3,-2;8\"\>", \
"\<\"-4,5,-3\"\>"],
           Subsuperscript["E", "2,3,-2;8", "-4,5,-3"],
           Editable->False]}]}], ")"}]}]}], ")"}], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "a"],
      AutoSpacing->False],
     m[a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "c"],
      AutoSpacing->False],
     mbar[c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "d"],
      AutoSpacing->False],
     mbar[d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "e"],
      AutoSpacing->False],
     mbar[e],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "f"],
      AutoSpacing->False],
     mbar[f],
     Editable->False]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"364", " ", 
      SqrtBox["33"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"32", "-", "2"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[2], 
        LI[-2]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"5", "-", "4", "-", "3"}]],
        AutoSpacing->False],
       calD[
        LI[5], 
        LI[-4], 
        LI[-3]],
       Editable->False]}], "-", 
     RowBox[{"72", " ", 
      SqrtBox["55"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"5", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[5], 
        LI[-2], 
        LI[-5]],
       Editable->False]}], "+", 
     RowBox[{"156", " ", 
      SqrtBox["10"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"6", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[6], 
        LI[-2], 
        LI[-5]],
       Editable->False]}], "+", 
     RowBox[{"33", " ", 
      SqrtBox["3"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"7", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[7], 
        LI[-2], 
        LI[-5]],
       Editable->False]}], "-", 
     RowBox[{"9", " ", 
      SqrtBox["195"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"8", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[8], 
        LI[-2], 
        LI[-5]],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "a"],
     AutoSpacing->False],
    m[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "c"],
     AutoSpacing->False],
    mbar[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "d"],
     AutoSpacing->False],
    mbar[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "e"],
     AutoSpacing->False],
    mbar[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "f"],
     AutoSpacing->False],
    mbar[f],
    Editable->False]}], 
  RowBox[{"52", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "calDRule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lp", "=", "5"}], ",", 
        RowBox[{"mp", "=", 
         RowBox[{"-", "2"}]}], ",", 
        RowBox[{"l", "=", "3"}], ",", 
        RowBox[{"mlabel", "=", 
         RowBox[{"-", "3"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"lp", ",", 
           RowBox[{"-", "1"}], ",", "mp"}], "]"}], "[", 
         RowBox[{"a", ",", "b", ",", "e", ",", "f"}], "]"}], 
        RowBox[{
         RowBox[{"PureSpin", "[", 
          RowBox[{"l", ",", "1", ",", "mlabel"}], "]"}], "[", 
         RowBox[{"c", ",", "d"}], "]"}]}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeffE", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "lp", ",", "mp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "l", ",", "mlabel"}], "}"}], ",", "j"}], "]"}], 
          RowBox[{
           RowBox[{"PureSpin", "[", 
            RowBox[{"j", ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"mp", "+", "mlabel"}]}], "]"}], "[", 
           RowBox[{"e", ",", "f"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"mbar", "[", "a", "]"}]}], 
            RowBox[{"m", "[", "c", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"mbar", "[", "b", "]"}]}], 
            RowBox[{"m", "[", "d", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"lp", "-", "l"}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}], "]"}], "//", 
    "Expand"}], ",", 
   RowBox[{"{", 
    RowBox[{"epsilongamma", "[", "__", "]"}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Pi]"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"630", " ", 
       SqrtBox["33"], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"32", "-", "3"}]],
         AutoSpacing->False],
        calD[
         LI[3], 
         LI[2], 
         LI[-3]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[GothicCapitalD]", "   ", 
          RowBox[{"5", "-", "4", "-", "2"}]],
         AutoSpacing->False],
        calD[
         LI[5], 
         LI[-4], 
         LI[-2]],
        Editable->False]}], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"5", " ", "\[Pi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["6"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"2", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[2], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;2\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;2", "2,3,-3"],
           Editable->False]}], "+", 
         RowBox[{
          SqrtBox["42"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"3", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[3], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;3\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;3", "2,3,-3"],
           Editable->False]}], "+", 
         RowBox[{"9", " ", 
          SqrtBox["2"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"4", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[4], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;4\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;4", "2,3,-3"],
           Editable->False]}], "+", 
         RowBox[{
          SqrtBox["462"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"5", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[5], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;5\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;5", "2,3,-3"],
           Editable->False]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["273"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"6", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[6], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;6\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;6", "2,3,-3"],
           Editable->False]}], "+", 
         RowBox[{"18", " ", 
          SqrtBox["7"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"7", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[7], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;7\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;7", "2,3,-3"],
           Editable->False]}], "+", 
         RowBox[{"6", " ", 
          SqrtBox["119"], " ", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["\[GothicCapitalD]", "   ", 
             RowBox[{"8", "-", "2", "-", "5"}]],
            AutoSpacing->False],
           calD[
            LI[8], 
            LI[-2], 
            LI[-5]],
           Editable->False], " ", 
          InterpretationBox[
           
           SubsuperscriptBox["\<\"E\"\>", "\<\"-4,5,-2;8\"\>", \
"\<\"2,3,-3\"\>"],
           Subsuperscript["E", "-4,5,-2;8", "2,3,-3"],
           Editable->False]}]}], ")"}]}]}], ")"}], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "c"],
      AutoSpacing->False],
     m[c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "d"],
      AutoSpacing->False],
     m[d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "a"],
      AutoSpacing->False],
     mbar[a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "e"],
      AutoSpacing->False],
     mbar[e],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "f"],
      AutoSpacing->False],
     mbar[f],
     Editable->False]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"45", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"182", " ", 
      SqrtBox["33"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"32", "-", "3"}]],
        AutoSpacing->False],
       calD[
        LI[3], 
        LI[2], 
        LI[-3]],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"5", "-", "4", "-", "2"}]],
        AutoSpacing->False],
       calD[
        LI[5], 
        LI[-4], 
        LI[-2]],
       Editable->False]}], "+", 
     RowBox[{"18", " ", 
      SqrtBox["55"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"5", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[5], 
        LI[-2], 
        LI[-5]],
       Editable->False]}], "-", 
     RowBox[{"78", " ", 
      SqrtBox["10"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"6", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[6], 
        LI[-2], 
        LI[-5]],
       Editable->False]}], "+", 
     RowBox[{"99", " ", 
      SqrtBox["3"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"7", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[7], 
        LI[-2], 
        LI[-5]],
       Editable->False]}], "-", 
     RowBox[{"3", " ", 
      SqrtBox["195"], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[GothicCapitalD]", "   ", 
         RowBox[{"8", "-", "2", "-", "5"}]],
        AutoSpacing->False],
       calD[
        LI[8], 
        LI[-2], 
        LI[-5]],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "c"],
     AutoSpacing->False],
    m[c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "d"],
     AutoSpacing->False],
    m[d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "a"],
     AutoSpacing->False],
    mbar[a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "e"],
     AutoSpacing->False],
    mbar[e],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "f"],
     AutoSpacing->False],
    mbar[f],
    Editable->False]}], 
  RowBox[{"26", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "calDRule"}], "//", "Simplify"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Products of X and Z", "Subsubsection"],

Cell["\<\
Now we implement the final product formula. We first define the TTensor can \
calTTensor tensors with even number of indices (note that the a,b indices are \
reorganized in the paper):\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TTensor", "[", "1", "]"}], "[", 
    RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", 
     RowBox[{"Length", "[", "ainds", "]"}]}], 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{"mbar", "/@", "ainds"}], ")"}]}], 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{"m", "/@", "binds"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TTensor", "[", 
     RowBox[{"-", "1"}], "]"}], "[", 
    RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", 
     RowBox[{"Length", "[", "ainds", "]"}]}], 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{"m", "/@", "ainds"}], ")"}]}], 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{"mbar", "/@", "binds"}], ")"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calTTensor", "[", "sign_", "]"}], "[", 
    RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"TTensor", "[", 
        RowBox[{"-", "1"}], "]"}], "[", 
       RowBox[{"ainds", ",", "binds"}], "]"}], "+", 
      RowBox[{"sign", "  ", 
       RowBox[{
        RowBox[{"TTensor", "[", "1", "]"}], "[", 
        RowBox[{"ainds", ",", "binds"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"calTTensor", "[", "sign_", "]"}], "[", 
   RowBox[{"ainds_List", ",", "binds_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "^", 
    RowBox[{"Length", "[", "ainds", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sign", " ", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"mbar", "/@", "ainds"}], ")"}]}], 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"m", "/@", "binds"}], ")"}]}]}], "+", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"m", "/@", "ainds"}], ")"}]}], 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"mbar", "/@", "binds"}], ")"}]}]}]}], ")"}], "/", 
    "2"}]}]}]], "Input",
 Evaluatable->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"calTTensor", "[", 
   RowBox[{"-", "1"}], "]"}], "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "c", ",", "e"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "d", ",", "f"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "b"],
       AutoSpacing->False],
      m[b],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "d"],
       AutoSpacing->False],
      m[d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "f"],
       AutoSpacing->False],
      m[f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "a"],
       AutoSpacing->False],
      mbar[a],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "c"],
       AutoSpacing->False],
      mbar[c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "e"],
       AutoSpacing->False],
      mbar[e],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "a"],
       AutoSpacing->False],
      m[a],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "c"],
       AutoSpacing->False],
      m[c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "e"],
       AutoSpacing->False],
      m[e],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "b"],
       AutoSpacing->False],
      mbar[b],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "d"],
       AutoSpacing->False],
      mbar[d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "f"],
       AutoSpacing->False],
      mbar[f],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell["and the rule is:", "Text"],

Cell[BoxData[
 RowBox[{"ProductRule", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tp", ":", 
         RowBox[{"(", 
          RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"LI", "[", "lp_", "]"}], ",", 
        RowBox[{"LI", "[", "mp_", "]"}], ",", "a___"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", ":", 
         RowBox[{"(", 
          RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"LI", "[", "l_", "]"}], ",", 
        RowBox[{"LI", "[", "mlabel_", "]"}], ",", "b___"}], "]"}]}], 
     "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sp", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "a", "}"}], "]"}]}], ",", 
          RowBox[{"s", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], ",", "ab", ",", "aa", ",", 
          "sigma", ",", "sigmap", ",", "coeff", ",", "coeffp"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"coeffp", ",", "sigmap"}], "}"}], "=", 
          RowBox[{"Switch", "[", 
           RowBox[{"tp", ",", "Z", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
            RowBox[{"{", 
             RowBox[{"I", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"coeff", ",", "sigma"}], "}"}], "=", 
          RowBox[{"Switch", "[", 
           RowBox[{"t", ",", "Z", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
            RowBox[{"{", 
             RowBox[{"I", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ab", "=", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", "s"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"aa", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{
             RowBox[{"-", "sp"}], "+", "s"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rest", "  ", "coeffp", " ", "coeff", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"s", "===", "0"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sp", "===", "0"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
          RowBox[{"Sum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"coeffE", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"sp", ",", "lp", ",", "mp"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "l", ",", "mlabel"}], "}"}], ",", "lpp"}], 
               "]"}], 
              RowBox[{"calZ", "[", 
               RowBox[{
                RowBox[{"LI", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"l", "+", "lp", "-", "lpp"}], ")"}]}], "sigma", 
                  " ", "sigmap"}], "]"}], ",", 
                RowBox[{"LI", "[", "lpp", "]"}], ",", 
                RowBox[{"LI", "[", 
                 RowBox[{"mp", "+", "mlabel"}], "]"}], ",", "a", ",", "b"}], 
               "]"}]}], "+", 
             RowBox[{"sigma", " ", 
              RowBox[{"coeffE", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"sp", ",", "lp", ",", "mp"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "s"}], ",", "l", ",", "mlabel"}], "}"}], ",", 
                "lpp"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"calTTensor", "[", 
                   RowBox[{"+", "1"}], "]"}], "[", 
                  RowBox[{"aa", ",", 
                   RowBox[{"{", "b", "}"}]}], "]"}], 
                 RowBox[{"calZ", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "lp", "-", "lpp"}], ")"}]}], "sigma", 
                    " ", "sigmap"}], "]"}], ",", 
                   RowBox[{"LI", "[", "lpp", "]"}], ",", 
                   RowBox[{"LI", "[", 
                    RowBox[{"mp", "+", "mlabel"}], "]"}], ",", "ab"}], 
                  "]"}]}], "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"calTTensor", "[", 
                   RowBox[{"-", "1"}], "]"}], "[", 
                  RowBox[{"aa", ",", 
                   RowBox[{"{", "b", "}"}]}], "]"}], 
                 RowBox[{"calZ", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "lp", "-", "lpp"}], ")"}]}]}], "sigma", 
                    " ", "sigmap"}], "]"}], ",", 
                   RowBox[{"LI", "[", "lpp", "]"}], ",", 
                   RowBox[{"LI", "[", 
                    RowBox[{"mp", "+", "mlabel"}], "]"}], ",", "ab"}], 
                  "]"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"lpp", ",", 
              RowBox[{"Abs", "[", 
               RowBox[{"lp", "-", "l"}], "]"}], ",", 
              RowBox[{"lp", "+", "l"}]}], "}"}]}], "]"}]}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], "\[GreaterEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}]}]}]}], ",", 
    RowBox[{
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "l_", "]"}], ",", 
         RowBox[{"LI", "[", "mlabel_", "]"}]}], "]"}], "^", "2"}]}], 
     "\[RuleDelayed]", "\[IndentingNewLine]", 
     RowBox[{"rest", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coeffE", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "l", ",", "mlabel"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "l", ",", "mlabel"}], "}"}], ",", "lpp"}], 
          "]"}], 
         RowBox[{"Z", "[", 
          RowBox[{
           RowBox[{"LI", "[", "lpp", "]"}], ",", 
           RowBox[{"LI", "[", 
            RowBox[{"2", "mlabel"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"lpp", ",", "0", ",", 
          RowBox[{"2", "l"}]}], "}"}]}], "]"}]}]}]}], "}"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
This is the formal (non-expanding) form. It is exactly the previous rule, \
without the Sum command. Note the special case for a square of a harmonic. \
Note also that this rule multiplies Z's and X's, but not calZ's.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FormalProductRule", "[", "lc_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ta", ":", 
         RowBox[{"(", 
          RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"LI", "[", "la_", "]"}], ",", 
        RowBox[{"LI", "[", "ma_", "]"}], ",", "a___"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tb", ":", 
         RowBox[{"(", 
          RowBox[{"Z", "|", "X"}], ")"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"LI", "[", "lb_", "]"}], ",", 
        RowBox[{"LI", "[", "mb_", "]"}], ",", "b___"}], "]"}]}], 
     "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sa", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "a", "}"}], "]"}]}], ",", 
          RowBox[{"sb", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], ",", "sigmaa", ",", "sigmab", 
          ",", "coeffa", ",", "coeffb", ",", "indicesA", ",", "indicesZ"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"coeffa", ",", "sigmaa"}], "}"}], "=", 
          RowBox[{"Switch", "[", 
           RowBox[{"ta", ",", "Z", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
            RowBox[{"{", 
             RowBox[{"I", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"coeffb", ",", "sigmab"}], "}"}], "=", 
          RowBox[{"Switch", "[", 
           RowBox[{"tb", ",", "Z", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", "X", ",", 
            RowBox[{"{", 
             RowBox[{"I", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indicesZ", "=", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"{", "a", "}"}], ",", "sb"}], "]"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indicesA", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"sb", "-", "sa"}]}], "]"}]}], ";", 
         RowBox[{"rest", "  ", "coeffa", " ", "coeffb", "  ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sa", "===", "0"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sb", "===", "0"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"coeffE", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"sa", ",", "la", ",", "ma"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"sb", ",", "lb", ",", "mb"}], "}"}], ",", "lc"}], 
              "]"}], 
             RowBox[{"calZ", "[", 
              RowBox[{
               RowBox[{"LI", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"lb", "+", "la", "-", "lc"}], ")"}]}], "sigmaa", 
                 " ", "sigmab"}], "]"}], ",", 
               RowBox[{"LI", "[", "lc", "]"}], ",", 
               RowBox[{"LI", "[", 
                RowBox[{"ma", "+", "mb"}], "]"}], ",", "a", ",", "b"}], 
              "]"}]}], "+", 
            RowBox[{"sigmab", " ", 
             RowBox[{"coeffE", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"sa", ",", "la", ",", "ma"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "sb"}], ",", "lb", ",", "mb"}], "}"}], ",", 
               "lc"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"calTTensor", "[", 
                  RowBox[{"+", "1"}], "]"}], "[", 
                 RowBox[{"indicesA", ",", 
                  RowBox[{"{", "b", "}"}]}], "]"}], 
                RowBox[{"calZ", "[", 
                 RowBox[{
                  RowBox[{"LI", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"lb", "+", "la", "-", "lc"}], ")"}]}], "sigmaa", 
                    " ", "sigmab"}], "]"}], ",", 
                  RowBox[{"LI", "[", "lc", "]"}], ",", 
                  RowBox[{"LI", "[", 
                   RowBox[{"ma", "+", "mb"}], "]"}], ",", "indicesZ"}], 
                 "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"calTTensor", "[", 
                  RowBox[{"-", "1"}], "]"}], "[", 
                 RowBox[{"indicesA", ",", 
                  RowBox[{"{", "b", "}"}]}], "]"}], 
                RowBox[{"calZ", "[", 
                 RowBox[{
                  RowBox[{"LI", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"lb", "+", "la", "-", "lc"}], ")"}]}]}], "sigmaa",
                     " ", "sigmab"}], "]"}], ",", 
                  RowBox[{"LI", "[", "lc", "]"}], ",", 
                  RowBox[{"LI", "[", 
                   RowBox[{"ma", "+", "mb"}], "]"}], ",", "indicesZ"}], 
                 "]"}]}]}], ")"}]}]}], ")"}]}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], "\[GreaterEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}]}]}]}], ",", 
    RowBox[{
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{"LI", "[", "la_", "]"}], ",", 
         RowBox[{"LI", "[", "ma_", "]"}]}], "]"}], "^", "2"}]}], 
     "\[RuleDelayed]", "\[IndentingNewLine]", 
     RowBox[{"rest", "  ", 
      RowBox[{"coeffE", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "la", ",", "ma"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "la", ",", "ma"}], "}"}], ",", "lc"}], "]"}], 
      RowBox[{
       RowBox[{"calZ", "[", 
        RowBox[{
         RowBox[{"LI", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "lc"}], ")"}]}], "]"}], ",", 
         RowBox[{"LI", "[", "lc", "]"}], ",", 
         RowBox[{"LI", "[", 
          RowBox[{"2", "ma"}], "]"}]}], "]"}], "/", "2"}]}]}]}], 
   "}"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
It is important to note that when both harmonics have the same labels la and \
ma then the E-coefficients vanish for odd lc, which ranges from 0 to 2la \
through even integers. In order to make that point clearer we have used calZ \
/ 2 instead of Z in the last expression, because calZ vanishes for odd l, but \
Z doesn't.\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection"],

Cell["Example1:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", 
      RowBox[{"-", "1"}], "]"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "3", "]"}], ",", 
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"-", "d"}], ",", 
     RowBox[{"-", "e"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "de"}], 
     RowBox[{"32", "  "}]],
    AutoSpacing->False],
   X[
    LI[3], 
    LI[2], -d, -e],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "abc"}], 
     RowBox[{"4", "-", "1", "   "}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[-1], -a, -b, -c],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "[", "expr_", "]"}], ":=", 
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"c", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"d", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"e", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "expr"}], 
   "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{
   RowBox[{"expression", "//", "comp"}], "//", 
   "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"945", " ", 
   SqrtBox[
    FractionBox["21", "2"]], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Cos",
      AutoSpacing->False],
     Cos,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Theta]", "", ""],
      AutoSpacing->False],
     \[Theta][],
     Editable->False], "]"}], " ", 
   RowBox[{
    InterpretationBox[
     StyleBox["Cos",
      AutoSpacing->False],
     Cos,
     Editable->False], "[", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False]}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"]}], 
  RowBox[{"32", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "/.", "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;6", "2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "abcde"}], 
      RowBox[{"61", "     "}]],
     AutoSpacing->False],
    X[
     LI[6], 
     LI[1], -a, -b, -c, -d, -e],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"11", " "}]],
        AutoSpacing->False],
       X[
        LI[1], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"11", " "}]],
        AutoSpacing->False],
       Z[
        LI[1], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"21", " "}]],
        AutoSpacing->False],
       X[
        LI[2], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"21", " "}]],
        AutoSpacing->False],
       Z[
        LI[2], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"31", " "}]],
        AutoSpacing->False],
       X[
        LI[3], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"31", " "}]],
        AutoSpacing->False],
       Z[
        LI[3], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"41", " "}]],
        AutoSpacing->False],
       X[
        LI[4], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"41", " "}]],
        AutoSpacing->False],
       Z[
        LI[4], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"51", " "}]],
        AutoSpacing->False],
       X[
        LI[5], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"51", " "}]],
        AutoSpacing->False],
       Z[
        LI[5], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"61", " "}]],
        AutoSpacing->False],
       X[
        LI[6], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"61", " "}]],
        AutoSpacing->False],
       Z[
        LI[6], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", "d", " "],
            AutoSpacing->False],
           m[-d],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "c"}], 
         RowBox[{"71", " "}]],
        AutoSpacing->False],
       X[
        LI[7], 
        LI[1], -c],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "e", " "],
           AutoSpacing->False],
          m[-e],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "b", " "],
           AutoSpacing->False],
          mbar[-b],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "b", " "],
           AutoSpacing->False],
          m[-b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "e", " "],
           AutoSpacing->False],
          mbar[-e],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "c"}], 
         RowBox[{"71", " "}]],
        AutoSpacing->False],
       Z[
        LI[7], 
        LI[1], -c],
       Editable->False]}]}], ")"}]}], "-", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;5", "2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "abcde"}], 
      RowBox[{"51", "     "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], -a, -b, -c, -d, -e],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;7", "2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "abcde"}], 
      RowBox[{"71", "     "}]],
     AutoSpacing->False],
    Z[
     LI[7], 
     LI[1], -a, -b, -c, -d, -e],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//", "comp"}], "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"21", " "}]],
     AutoSpacing->False],
    X[
     LI[2], 
     LI[1], {2, -spherical}],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", " "}]],
     AutoSpacing->False],
    X[
     LI[4], 
     LI[1], {2, -spherical}],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"61", " "}]],
     AutoSpacing->False],
    X[
     LI[6], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;6", "2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2", "2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"61", "     "}]],
     AutoSpacing->False],
    X[
     LI[6], 
     LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
     2, -spherical}, {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"11", " "}]],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"31", " "}]],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"51", " "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"71", " "}]],
     AutoSpacing->False],
    Z[
     LI[7], 
     LI[1], {2, -spherical}],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;5", "2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2", "2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"51", "     "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
     2, -spherical}, {2, -spherical}],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;7", "2,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2", "2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"71", "     "}]],
     AutoSpacing->False],
    Z[
     LI[7], 
     LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
     2, -spherical}, {2, -spherical}],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["7", "16"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["35", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"21", " "}]],
     AutoSpacing->False],
    X[
     LI[2], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  FractionBox[
   RowBox[{"85", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", 
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     X[
      LI[6], 
      LI[1], {2, -spherical}],
     Editable->False]}], 
   RowBox[{"16", " ", 
    SqrtBox[
     RowBox[{"13", " ", "\[Pi]"}]]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", 
        StyleBox[
         RowBox[{"2", "2", "2", "2", "2"}],
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{"61", "     "}]],
      AutoSpacing->False],
     X[
      LI[6], 
      LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
      2, -spherical}, {2, -spherical}],
     Editable->False]}], 
   RowBox[{"24", " ", 
    SqrtBox[
     RowBox[{"13", " ", "\[Pi]"}]]}]], "+", 
  RowBox[{
   FractionBox["45", "16"], " ", 
   SqrtBox[
    FractionBox["7", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"11", " "}]],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[1], {2, -spherical}],
    Editable->False]}], "-", 
  FractionBox[
   RowBox[{"35", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", 
        StyleBox["2",
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     Z[
      LI[3], 
      LI[1], {2, -spherical}],
     Editable->False]}], 
   RowBox[{"11", " ", 
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]]}]], "+", 
  RowBox[{
   FractionBox["25", "208"], " ", 
   SqrtBox[
    FractionBox["385", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"51", " "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["18", "143"], " ", 
   SqrtBox[
    FractionBox["5", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"71", " "}]],
     AutoSpacing->False],
    Z[
     LI[7], 
     LI[1], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["25", "312"], " ", 
   SqrtBox[
    FractionBox["35", 
     RowBox[{"11", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2", "2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"51", "     "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
     2, -spherical}, {2, -spherical}],
    Editable->False]}], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", 
        StyleBox[
         RowBox[{"2", "2", "2", "2", "2"}],
         FontColor->RGBColor[1, 0, 0]]}], 
       RowBox[{"71", "     "}]],
      AutoSpacing->False],
     Z[
      LI[7], 
      LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
      2, -spherical}, {2, -spherical}],
     Editable->False]}], 
   RowBox[{"143", " ", 
    SqrtBox[
     RowBox[{"5", " ", "\[Pi]"}]]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"%", "//", "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"945", " ", 
   SqrtBox[
    FractionBox["21", "2"]], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "+", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"3", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"]}], 
  RowBox[{"64", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Compare total timings:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"HarmonicComponent", "[", 
   RowBox[{"comp", "[", "expression", "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.016666000000000736`", " ", "Second"}], ",", 
   FractionBox[
    RowBox[{"945", " ", 
     SqrtBox[
      FractionBox["21", "2"]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Phi]", "", ""],
         AutoSpacing->False],
        \[Phi][],
        Editable->False]}]], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{"32", " ", "\[Pi]"}]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"HarmonicComponent", "[", 
   RowBox[{
    RowBox[{"ToValues", "@", 
     RowBox[{"comp", "[", 
      RowBox[{"expression", "/.", "ProductRule"}], "]"}]}], "/.", 
    "coeffERule"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.12999200000000144`", " ", "Second"}], ",", 
   FractionBox[
    RowBox[{"945", " ", 
     SqrtBox[
      FractionBox["21", "2"]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Phi]", "", ""],
         AutoSpacing->False],
        \[Phi][],
        Editable->False]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"3", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       InterpretationBox[
        StyleBox["Sin",
         AutoSpacing->False],
        Sin,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}], "2"]}], 
    RowBox[{"64", " ", "\[Pi]"}]]}], "}"}]], "Output"]
}, Open  ]],

Cell["Example2. There is a contracted index", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "4", "]"}], ",", 
     RowBox[{"LI", "[", 
      RowBox[{"-", "1"}], "]"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "3", "]"}], ",", 
     RowBox[{"LI", "[", "2", "]"}], ",", "b", ",", 
     RowBox[{"-", "d"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"   ", "d"}], 
     RowBox[{"32", "b", " "}]],
    AutoSpacing->False],
   X[
    LI[3], 
    LI[2], b, -d],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "cab"}], 
     RowBox[{"4", "-", "1", "   "}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[-1], -c, -a, -b],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "[", "expr_", "]"}], ":=", 
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"c", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"d", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "expr"}], 
   "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{
   RowBox[{"expression", "//", "comp"}], "//", 
   "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"315", " ", 
   SqrtBox[
    FractionBox["21", "2"]], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], "+", 
     RowBox[{"20", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"5", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"]}], 
  RowBox[{"256", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "/.", "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"11", " "}]],
        AutoSpacing->False],
       X[
        LI[1], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"11", " "}]],
        AutoSpacing->False],
       Z[
        LI[1], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"21", " "}]],
        AutoSpacing->False],
       X[
        LI[2], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"21", " "}]],
        AutoSpacing->False],
       Z[
        LI[2], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"31", " "}]],
        AutoSpacing->False],
       X[
        LI[3], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"31", " "}]],
        AutoSpacing->False],
       Z[
        LI[3], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"41", " "}]],
        AutoSpacing->False],
       X[
        LI[4], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"41", " "}]],
        AutoSpacing->False],
       Z[
        LI[4], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"51", " "}]],
        AutoSpacing->False],
       X[
        LI[5], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"51", " "}]],
        AutoSpacing->False],
       Z[
        LI[5], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"61", " "}]],
        AutoSpacing->False],
       X[
        LI[6], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"61", " "}]],
        AutoSpacing->False],
       Z[
        LI[6], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
    Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           StyleBox[
            SubsuperscriptBox["m", " ", "b"],
            AutoSpacing->False],
           m[b],
           Editable->False]}], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["X", 
         RowBox[{"  ", "b"}], 
         RowBox[{"71", " "}]],
        AutoSpacing->False],
       X[
        LI[7], 
        LI[1], -b],
       Editable->False]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "b"],
           AutoSpacing->False],
          m[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "d", " "],
           AutoSpacing->False],
          m[-d],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "a", " "],
           AutoSpacing->False],
          mbar[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "c", " "],
           AutoSpacing->False],
          mbar[-c],
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "a", " "],
           AutoSpacing->False],
          m[-a],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", "c", " "],
           AutoSpacing->False],
          m[-c],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], " ", "b"],
           AutoSpacing->False],
          mbar[b],
          Editable->False], " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox[
            OverscriptBox["m", "_"], "d", " "],
           AutoSpacing->False],
          mbar[-d],
          Editable->False]}]}], ")"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["Z", 
         RowBox[{"  ", "b"}], 
         RowBox[{"71", " "}]],
        AutoSpacing->False],
       Z[
        LI[7], 
        LI[1], -b],
       Editable->False]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//", "comp"}], "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"11", " "}]],
      AutoSpacing->False],
     X[
      LI[1], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"11", " "}]],
      AutoSpacing->False],
     X[
      LI[1], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"21", " "}]],
      AutoSpacing->False],
     X[
      LI[2], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"21", " "}]],
      AutoSpacing->False],
     X[
      LI[2], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     X[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     X[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"41", " "}]],
      AutoSpacing->False],
     X[
      LI[4], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"41", " "}]],
      AutoSpacing->False],
     X[
      LI[4], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"51", " "}]],
      AutoSpacing->False],
     X[
      LI[5], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"51", " "}]],
      AutoSpacing->False],
     X[
      LI[5], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     X[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     X[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"71", " "}]],
      AutoSpacing->False],
     X[
      LI[7], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"71", " "}]],
      AutoSpacing->False],
     X[
      LI[7], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"11", " "}]],
      AutoSpacing->False],
     Z[
      LI[1], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;1\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;1", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"11", " "}]],
      AutoSpacing->False],
     Z[
      LI[1], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"21", " "}]],
      AutoSpacing->False],
     Z[
      LI[2], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;2\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;2", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"21", " "}]],
      AutoSpacing->False],
     Z[
      LI[2], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     Z[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;3\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;3", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     Z[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"41", " "}]],
      AutoSpacing->False],
     Z[
      LI[4], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;4\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;4", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"41", " "}]],
      AutoSpacing->False],
     Z[
      LI[4], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"51", " "}]],
      AutoSpacing->False],
     Z[
      LI[5], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;5\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;5", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"51", " "}]],
      AutoSpacing->False],
     Z[
      LI[5], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     Z[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;6\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;6", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     Z[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"71", " "}]],
      AutoSpacing->False],
     Z[
      LI[7], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\<\"E\"\>", "\<\"3,4,-1;7\"\>", "\<\"-2,3,2\"\>"],
     Subsuperscript["E", "3,4,-1;7", "-2,3,2"],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"71", " "}]],
      AutoSpacing->False],
     Z[
      LI[7], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["45", "16"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["7", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"11", " "}]],
     AutoSpacing->False],
    X[
     LI[1], 
     LI[1], -b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["45", "16"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["7", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"11", " "}]],
     AutoSpacing->False],
    X[
     LI[1], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["7", "16"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["35", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"21", " "}]],
     AutoSpacing->False],
    X[
     LI[2], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["7", "16"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["35", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"21", " "}]],
     AutoSpacing->False],
    X[
     LI[2], 
     LI[1], -b],
    Editable->False]}], "-", 
  FractionBox[
   RowBox[{"35", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     X[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"22", " ", 
    SqrtBox["\[Pi]"]}]], "+", 
  FractionBox[
   RowBox[{"35", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     X[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"22", " ", 
    SqrtBox["\[Pi]"]}]], "+", 
  RowBox[{
   FractionBox["25", "208"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["385", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"51", " "}]],
     AutoSpacing->False],
    X[
     LI[5], 
     LI[1], -b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["25", "208"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["385", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"51", " "}]],
     AutoSpacing->False],
    X[
     LI[5], 
     LI[1], -b],
    Editable->False]}], "+", 
  FractionBox[
   RowBox[{"85", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     X[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"16", " ", 
    SqrtBox[
     RowBox[{"26", " ", "\[Pi]"}]]}]], "+", 
  FractionBox[
   RowBox[{"85", " ", "\[ImaginaryI]", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["X", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     X[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"16", " ", 
    SqrtBox[
     RowBox[{"26", " ", "\[Pi]"}]]}]], "+", 
  RowBox[{
   FractionBox["9", "143"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["10", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"71", " "}]],
     AutoSpacing->False],
    X[
     LI[7], 
     LI[1], -b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["9", "143"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["10", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["X", 
      RowBox[{"  ", "b"}], 
      RowBox[{"71", " "}]],
     AutoSpacing->False],
    X[
     LI[7], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["45", "16"], " ", 
   SqrtBox[
    FractionBox["7", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"11", " "}]],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["45", "16"], " ", 
   SqrtBox[
    FractionBox["7", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"11", " "}]],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["7", "16"], " ", 
   SqrtBox[
    FractionBox["35", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"21", " "}]],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1], -b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["7", "16"], " ", 
   SqrtBox[
    FractionBox["35", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"21", " "}]],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1], -b],
    Editable->False]}], "-", 
  FractionBox[
   RowBox[{"35", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     Z[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"22", " ", 
    SqrtBox["\[Pi]"]}]], "-", 
  FractionBox[
   RowBox[{"35", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"31", " "}]],
      AutoSpacing->False],
     Z[
      LI[3], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"22", " ", 
    SqrtBox["\[Pi]"]}]], "+", 
  RowBox[{
   FractionBox["25", "208"], " ", 
   SqrtBox[
    FractionBox["385", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"51", " "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["25", "208"], " ", 
   SqrtBox[
    FractionBox["385", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"51", " "}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[1], -b],
    Editable->False]}], "+", 
  FractionBox[
   RowBox[{"85", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["m", " ", "b"],
      AutoSpacing->False],
     m[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     Z[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"16", " ", 
    SqrtBox[
     RowBox[{"26", " ", "\[Pi]"}]]}]], "-", 
  FractionBox[
   RowBox[{"85", " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox[
       OverscriptBox["m", "_"], " ", "b"],
      AutoSpacing->False],
     mbar[b],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["Z", 
       RowBox[{"  ", "b"}], 
       RowBox[{"61", " "}]],
      AutoSpacing->False],
     Z[
      LI[6], 
      LI[1], -b],
     Editable->False]}], 
   RowBox[{"16", " ", 
    SqrtBox[
     RowBox[{"26", " ", "\[Pi]"}]]}]], "+", 
  RowBox[{
   FractionBox["9", "143"], " ", 
   SqrtBox[
    FractionBox["10", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["m", " ", "b"],
     AutoSpacing->False],
    m[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"71", " "}]],
     AutoSpacing->False],
    Z[
     LI[7], 
     LI[1], -b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["9", "143"], " ", 
   SqrtBox[
    FractionBox["10", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox[
      OverscriptBox["m", "_"], " ", "b"],
     AutoSpacing->False],
    mbar[b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "b"}], 
      RowBox[{"71", " "}]],
     AutoSpacing->False],
    Z[
     LI[7], 
     LI[1], -b],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"%", "//", "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"315", " ", 
   SqrtBox[
    FractionBox["21", "2"]], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["\[Theta]", "", ""],
         AutoSpacing->False],
        \[Theta][],
        Editable->False], "]"}]}], "+", 
     RowBox[{"20", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"5", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"]}], 
  RowBox[{"256", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Example 3. Equal numbers of indices:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"LI", "[", 
      RowBox[{"-", "1"}], "]"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"-", "d"}], ",", 
     RowBox[{"-", "e"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "ab"}], 
     RowBox[{"2", "-", "1", "  "}]],
    AutoSpacing->False],
   X[
    LI[2], 
    LI[-1], -a, -b],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "de"}], 
     RowBox[{"22", "  "}]],
    AutoSpacing->False],
   X[
    LI[2], 
    LI[2], -d, -e],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "[", "expr_", "]"}], ":=", 
  RowBox[{"ContractBasis", "[", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"d", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], 
    RowBox[{"Basis", "[", 
     RowBox[{"e", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "spherical"}]}], "}"}]}], "]"}], "expr"}], 
   "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{
   RowBox[{"comp", "[", "expression", "]"}], "//", 
   "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   RowBox[{"8", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "/.", "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;0\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;0", "-2,2,-1"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "d", " "],
        AutoSpacing->False],
       m[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "e", " "],
        AutoSpacing->False],
       m[-e],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "a", " "],
        AutoSpacing->False],
       mbar[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "b", " "],
        AutoSpacing->False],
       mbar[-b],
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "a", " "],
        AutoSpacing->False],
       m[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "b", " "],
        AutoSpacing->False],
       m[-b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "d", " "],
        AutoSpacing->False],
       mbar[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "e", " "],
        AutoSpacing->False],
       mbar[-e],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "01"],
     AutoSpacing->False],
    Z[
     LI[0], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;1\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;1", "-2,2,-1"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "d", " "],
        AutoSpacing->False],
       m[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "e", " "],
        AutoSpacing->False],
       m[-e],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "a", " "],
        AutoSpacing->False],
       mbar[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "b", " "],
        AutoSpacing->False],
       mbar[-b],
       Editable->False]}], "-", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "a", " "],
        AutoSpacing->False],
       m[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "b", " "],
        AutoSpacing->False],
       m[-b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "d", " "],
        AutoSpacing->False],
       mbar[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "e", " "],
        AutoSpacing->False],
       mbar[-e],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "11"],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;2\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;2", "-2,2,-1"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "d", " "],
        AutoSpacing->False],
       m[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "e", " "],
        AutoSpacing->False],
       m[-e],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "a", " "],
        AutoSpacing->False],
       mbar[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "b", " "],
        AutoSpacing->False],
       mbar[-b],
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "a", " "],
        AutoSpacing->False],
       m[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "b", " "],
        AutoSpacing->False],
       m[-b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "d", " "],
        AutoSpacing->False],
       mbar[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "e", " "],
        AutoSpacing->False],
       mbar[-e],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "21"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;3\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;3", "-2,2,-1"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "d", " "],
        AutoSpacing->False],
       m[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "e", " "],
        AutoSpacing->False],
       m[-e],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "a", " "],
        AutoSpacing->False],
       mbar[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "b", " "],
        AutoSpacing->False],
       mbar[-b],
       Editable->False]}], "-", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "a", " "],
        AutoSpacing->False],
       m[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "b", " "],
        AutoSpacing->False],
       m[-b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "d", " "],
        AutoSpacing->False],
       mbar[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "e", " "],
        AutoSpacing->False],
       mbar[-e],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "31"],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;4\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;4", "-2,2,-1"],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "d", " "],
        AutoSpacing->False],
       m[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "e", " "],
        AutoSpacing->False],
       m[-e],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "a", " "],
        AutoSpacing->False],
       mbar[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "b", " "],
        AutoSpacing->False],
       mbar[-b],
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "a", " "],
        AutoSpacing->False],
       m[-a],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["m", "b", " "],
        AutoSpacing->False],
       m[-b],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "d", " "],
        AutoSpacing->False],
       mbar[-d],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox[
         OverscriptBox["m", "_"], "e", " "],
        AutoSpacing->False],
       mbar[-e],
       Editable->False]}]}], ")"}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;4\"\>", "\<\"2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;4", "2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", "deab"}], 
      RowBox[{"41", "    "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], -d, -e, -a, -b],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//", "comp"}], "//", "ToValues"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;0\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;0", "-2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "01"],
     AutoSpacing->False],
    Z[
     LI[0], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;2\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;2", "-2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "21"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;4\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;4", "-2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;4\"\>", "\<\"2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;4", "2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "    "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
     2, -spherical}],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["3", "7"], " ", 
   SqrtBox[
    FractionBox["15", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "21"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "28"], " ", 
   SqrtBox[
    FractionBox["5", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "84"], " ", 
   SqrtBox[
    FractionBox["5", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox[
        RowBox[{"2", "2", "2", "2"}],
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"41", "    "}]],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1], {2, -spherical}, {2, -spherical}, {2, -spherical}, {
     2, -spherical}],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"%", "//", "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   RowBox[{"8", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Example 4. Equal numbers of indices and contracted indices:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"LI", "[", 
      RowBox[{"-", "1"}], "]"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"LI", "[", "2", "]"}], ",", "a", ",", "b"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"  ", "ab"}], 
     RowBox[{"2", "-", "1", "  "}]],
    AutoSpacing->False],
   X[
    LI[2], 
    LI[-1], -a, -b],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", "    ", 
     RowBox[{"22", "ab"}]],
    AutoSpacing->False],
   X[
    LI[2], 
    LI[2], a, b],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{"expression", "//", "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"15", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   RowBox[{"32", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "/.", "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;0\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;0", "-2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "01"],
     AutoSpacing->False],
    Z[
     LI[0], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{"2", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;2\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;2", "-2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "21"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{"2", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"2,2,2;4\"\>", "\<\"-2,2,-1\"\>"],
    Subsuperscript["E", "2,2,2;4", "-2,2,-1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["6", "7"], " ", 
   SqrtBox[
    FractionBox["30", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "21"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "7"], " ", 
   SqrtBox[
    FractionBox["5", "\[Pi]"]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "41"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[1]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"%", "//", "HarmonicComponent"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"15", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False], "]"}]}], "+", 
      RowBox[{
       InterpretationBox[
        StyleBox["Cos",
         AutoSpacing->False],
        Cos,
        Editable->False], "[", 
       RowBox[{"3", " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Theta]", "", ""],
          AutoSpacing->False],
         \[Theta][],
         Editable->False]}], "]"}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   RowBox[{"32", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Example 5, with scalar harmonics:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "3", "]"}], ",", 
     RowBox[{"LI", "[", "2", "]"}]}], "]"}], 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "3", "]"}], ",", 
     RowBox[{"LI", "[", "2", "]"}]}], "]"}]}], "/.", 
  "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;0\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;0", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "04"],
     AutoSpacing->False],
    Z[
     LI[0], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;1\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;1", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "14"],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;2\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;2", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "24"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;3\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;3", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "34"],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;4\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;4", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "44"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;5\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;5", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "54"],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,3,2;6\"\>", "\<\"0,3,2\"\>"],
    Subsuperscript["E", "0,3,2;6", "0,3,2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "64"],
     AutoSpacing->False],
    Z[
     LI[6], 
     LI[4]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "11"], " ", 
   SqrtBox[
    FractionBox["35", 
     RowBox[{"2", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "44"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[4]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["5", "11"], " ", 
   SqrtBox[
    FractionBox["14", 
     RowBox[{"13", " ", "\[Pi]"}]]], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "64"],
     AutoSpacing->False],
    Z[
     LI[6], 
     LI[4]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"105", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"4", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "4"]}], 
  RowBox[{"32", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SphericalHarmonicY", "[", 
   RowBox[{"3", ",", "2", ",", 
    RowBox[{"\[Theta]", "[", "]"}], ",", 
    RowBox[{"\[Phi]", "[", "]"}]}], "]"}], "^", "2"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"105", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"4", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "4"]}], 
  RowBox[{"32", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"%", "-", "%%"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Example 6, with an epsilon term:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "3", "]"}], ",", "a", ",", "b"}], "]"}], 
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "3", "]"}], ",", "c", ",", "d"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", "    ", 
     RowBox[{"43", "cd"}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[3], c, d],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "    ", 
     RowBox[{"43", "ab"}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[3], a, b],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;4\"\>", "\<\"2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;4", "2,4,3"],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["X", "      ", 
        RowBox[{"46", "abcd"}]],
       AutoSpacing->False],
      X[
       LI[4], 
       LI[6], a, b, c, d],
      Editable->False]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;6\"\>", "\<\"2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;6", "2,4,3"],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["X", "      ", 
        RowBox[{"66", "abcd"}]],
       AutoSpacing->False],
      X[
       LI[6], 
       LI[6], a, b, c, d],
      Editable->False]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;8\"\>", "\<\"2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;8", "2,4,3"],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["X", "      ", 
        RowBox[{"86", "abcd"}]],
       AutoSpacing->False],
      X[
       LI[8], 
       LI[6], a, b, c, d],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;0\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;0", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "06"],
       AutoSpacing->False],
      Z[
       LI[0], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;1\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;1", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "16"],
       AutoSpacing->False],
      Z[
       LI[1], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;2\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;2", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "26"],
       AutoSpacing->False],
      Z[
       LI[2], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;3\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;3", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "36"],
       AutoSpacing->False],
      Z[
       LI[3], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;4\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;4", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "46"],
       AutoSpacing->False],
      Z[
       LI[4], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;5\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;5", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "56"],
       AutoSpacing->False],
      Z[
       LI[5], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;6\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;6", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "66"],
       AutoSpacing->False],
      Z[
       LI[6], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;7\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;7", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "76"],
       AutoSpacing->False],
      Z[
       LI[7], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;8\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;8", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "d"],
          AutoSpacing->False],
         m[d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "b"],
          AutoSpacing->False],
         mbar[b],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "b"],
          AutoSpacing->False],
         m[b],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "d"],
          AutoSpacing->False],
         mbar[d],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "86"],
       AutoSpacing->False],
      Z[
       LI[8], 
       LI[6]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;5\"\>", "\<\"2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;5", "2,4,3"],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "      ", 
        RowBox[{"56", "abcd"}]],
       AutoSpacing->False],
      Z[
       LI[5], 
       LI[6], a, b, c, d],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;7\"\>", "\<\"2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;7", "2,4,3"],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "      ", 
        RowBox[{"76", "abcd"}]],
       AutoSpacing->False],
      Z[
       LI[7], 
       LI[6], a, b, c, d],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "Simplification"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "170"], " ", 
  SqrtBox[
   FractionBox["3", 
    RowBox[{"143", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"17", " ", 
     SqrtBox["7"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["X", "      ", 
        RowBox[{"66", "abcd"}]],
       AutoSpacing->False],
      X[
       LI[6], 
       LI[6], a, b, c, d],
      Editable->False]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["17"], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["X", "      ", 
           RowBox[{"86", "abcd"}]],
          AutoSpacing->False],
         X[
          LI[8], 
          LI[6], a, b, c, d],
         Editable->False]}], "-", 
       RowBox[{"15", " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["m", " ", "c"],
             AutoSpacing->False],
            m[c],
            Editable->False], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["m", " ", "d"],
             AutoSpacing->False],
            m[d],
            Editable->False], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              OverscriptBox["m", "_"], " ", "a"],
             AutoSpacing->False],
            mbar[a],
            Editable->False], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              OverscriptBox["m", "_"], " ", "b"],
             AutoSpacing->False],
            mbar[b],
            Editable->False]}], "-", 
          RowBox[{
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["m", " ", "a"],
             AutoSpacing->False],
            m[a],
            Editable->False], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["m", " ", "b"],
             AutoSpacing->False],
            m[b],
            Editable->False], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              OverscriptBox["m", "_"], " ", "c"],
             AutoSpacing->False],
            mbar[c],
            Editable->False], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox[
              OverscriptBox["m", "_"], " ", "d"],
             AutoSpacing->False],
            mbar[d],
            Editable->False]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"187", " ", 
           SqrtBox["7"], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["Z", "  ", "66"],
             AutoSpacing->False],
            Z[
             LI[6], 
             LI[6]],
            Editable->False]}], "-", 
          RowBox[{"56", " ", 
           SqrtBox["17"], " ", 
           InterpretationBox[
            StyleBox[
             SubsuperscriptBox["Z", "  ", "86"],
             AutoSpacing->False],
            Z[
             LI[8], 
             LI[6]],
            Editable->False]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//.", "mmbarRule"}], "//", "Simplification"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "170"], " ", 
  SqrtBox[
   FractionBox["3", 
    RowBox[{"143", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"17", " ", 
     SqrtBox["7"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["X", "      ", 
        RowBox[{"66", "abcd"}]],
       AutoSpacing->False],
      X[
       LI[6], 
       LI[6], a, b, c, d],
      Editable->False]}], "+", 
    RowBox[{"4", " ", 
     SqrtBox["17"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["X", "      ", 
        RowBox[{"86", "abcd"}]],
       AutoSpacing->False],
      X[
       LI[8], 
       LI[6], a, b, c, d],
      Editable->False]}], "+", 
    RowBox[{"15", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "bd"],
          AutoSpacing->False],
         epsilongamma[b, d],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Gamma]", "  ", "ac"],
          AutoSpacing->False],
         gamma[a, c],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ac"],
          AutoSpacing->False],
         epsilongamma[a, c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["\[Gamma]", "  ", "bd"],
          AutoSpacing->False],
         gamma[b, d],
         Editable->False]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"187", " ", 
        SqrtBox["7"], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["Z", "  ", "66"],
          AutoSpacing->False],
         Z[
          LI[6], 
          LI[6]],
         Editable->False]}], "-", 
       RowBox[{"56", " ", 
        SqrtBox["17"], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["Z", "  ", "86"],
          AutoSpacing->False],
         Z[
          LI[8], 
          LI[6]],
         Editable->False]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"-", "b"}], ",", 
       RowBox[{"-", "d"}]}], "]"}], "%"}], "//", "ContractMetric"}], "//", 
   "Simplification"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["9", "17"], " ", 
  SqrtBox[
   FractionBox["3", 
    RowBox[{"143", " ", "\[Pi]"}]]], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ac"],
    AutoSpacing->False],
   epsilongamma[a, c],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"187", " ", 
     SqrtBox["7"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "66"],
       AutoSpacing->False],
      Z[
       LI[6], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{"56", " ", 
     SqrtBox["17"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "86"],
       AutoSpacing->False],
      Z[
       LI[8], 
       LI[6]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "3", "]"}], ",", "a", ",", "b"}], "]"}], 
  RowBox[{"X", "[", 
   RowBox[{
    RowBox[{"LI", "[", "4", "]"}], ",", 
    RowBox[{"LI", "[", "3", "]"}], ",", "c", ",", 
    RowBox[{"-", "b"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", 
     RowBox[{"   ", "b"}], 
     RowBox[{"43", "c", " "}]],
    AutoSpacing->False],
   X[
    LI[4], 
    LI[3], c, -b],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "    ", 
     RowBox[{"43", "ab"}]],
    AutoSpacing->False],
   Z[
    LI[4], 
    LI[3], a, b],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "ProductRule"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;0\"\>", "\<\"-2,4,3\"\>"],
       Subsuperscript["E", "2,4,3;0", "-2,4,3"],
       Editable->False]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "06"],
       AutoSpacing->False],
      Z[
       LI[0], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;1\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;1", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "16"],
       AutoSpacing->False],
      Z[
       LI[1], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;2\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;2", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "26"],
       AutoSpacing->False],
      Z[
       LI[2], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;3\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;3", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "36"],
       AutoSpacing->False],
      Z[
       LI[3], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;4\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;4", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "46"],
       AutoSpacing->False],
      Z[
       LI[4], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;5\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;5", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "56"],
       AutoSpacing->False],
      Z[
       LI[5], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;6\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;6", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "66"],
       AutoSpacing->False],
      Z[
       LI[6], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;7\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;7", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "c"],
          AutoSpacing->False],
         m[c],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "76"],
       AutoSpacing->False],
      Z[
       LI[7], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\<\"E\"\>", "\<\"2,4,3;8\"\>", "\<\"-2,4,3\"\>"],
      Subsuperscript["E", "2,4,3;8", "-2,4,3"],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["m", " ", "c"],
           AutoSpacing->False],
          m[c],
          Editable->False]}], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "a"],
          AutoSpacing->False],
         mbar[a],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["m", " ", "a"],
          AutoSpacing->False],
         m[a],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox[
           OverscriptBox["m", "_"], " ", "c"],
          AutoSpacing->False],
         mbar[c],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "86"],
       AutoSpacing->False],
      Z[
       LI[8], 
       LI[6]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "Simplification"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["9", "17"]}], " ", "\[ImaginaryI]", " ", 
  SqrtBox[
   FractionBox["3", 
    RowBox[{"143", " ", "\[Pi]"}]]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "c"],
       AutoSpacing->False],
      m[c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "a"],
       AutoSpacing->False],
      mbar[a],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["m", " ", "a"],
       AutoSpacing->False],
      m[a],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox[
        OverscriptBox["m", "_"], " ", "c"],
       AutoSpacing->False],
      mbar[c],
      Editable->False]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"187", " ", 
     SqrtBox["7"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "66"],
       AutoSpacing->False],
      Z[
       LI[6], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{"56", " ", 
     SqrtBox["17"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "86"],
       AutoSpacing->False],
      Z[
       LI[8], 
       LI[6]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{
   RowBox[{"%", "//.", "mmbarRule"}], "//", "Simplification"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["9", "17"], " ", 
  SqrtBox[
   FractionBox["3", 
    RowBox[{"143", " ", "\[Pi]"}]]], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Epsilon]\[Gamma]", "  ", "ac"],
    AutoSpacing->False],
   epsilongamma[a, c],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"187", " ", 
     SqrtBox["7"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "66"],
       AutoSpacing->False],
      Z[
       LI[6], 
       LI[6]],
      Editable->False]}], "-", 
    RowBox[{"56", " ", 
     SqrtBox["17"], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["Z", "  ", "86"],
       AutoSpacing->False],
      Z[
       LI[8], 
       LI[6]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Example 7:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l1", "]"}], ",", 
     RowBox[{"LI", "[", "m1", "]"}], ",", "a"}], "]"}], 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l2", "]"}], ",", 
     RowBox[{"LI", "[", "m2", "]"}], ",", 
     RowBox[{"-", "a"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "   ", "l1m1a"],
    AutoSpacing->False],
   Z[
    LI[l1], 
    LI[m1], a],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", 
     RowBox[{"  ", "a"}], 
     RowBox[{"l2m2", " "}]],
    AutoSpacing->False],
   Z[
    LI[l2], 
    LI[m2], -a],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{"expression", "/.", 
   RowBox[{"FormalProductRule", "[", "l", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
      RowBox[{"    ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "l"}], " ", "+", " ", "l1", " ", "+", " ", "l2"}], "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "lm1"}], " ", "+", " ", "m2"}]}]}]],
     AutoSpacing->False],
    calZ[
     LI[(-1)^(-l + l1 + l2)], 
     LI[l], 
     LI[m1 + m2]],
    Editable->False]}], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"1,l1,m1;l\"\>", "\<\"-1,l2,m2\"\>"],
   Subsuperscript["E", "1,l1,m1;l", "-1,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1", "\[Rule]", "l2"}], ",", 
     RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
      RowBox[{"    ", 
       RowBox[{
        RowBox[{"-", "l"}], "\n", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "l2", " ", "m2"}]}]}]],
     AutoSpacing->False],
    calZ[
     LI[(-1)^(-l)], 
     LI[l], 
     LI[2 m2]],
    Editable->False]}], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"1,l2,m2;l\"\>", "\<\"-1,l2,m2\"\>"],
   Subsuperscript["E", "1,l2,m2;l", "-1,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"l1", "\[Rule]", "l2"}], ",", 
    RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", 
     RowBox[{"  ", "a"}], 
     RowBox[{"l2m2", " "}]],
    AutoSpacing->False],
   Z[
    LI[l2], 
    LI[m2], -a],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "   ", "l2m2a"],
    AutoSpacing->False],
   Z[
    LI[l2], 
    LI[m2], a],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"%", "/.", 
   RowBox[{"FormalProductRule", "[", "l", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
      RowBox[{"    ", 
       RowBox[{
        RowBox[{"-", "l"}], "\n", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "l2", " ", "m2"}]}]}]],
     AutoSpacing->False],
    calZ[
     LI[(-1)^(-l)], 
     LI[l], 
     LI[2 m2]],
    Editable->False]}], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"1,l2,m2;l\"\>", "\<\"-1,l2,m2\"\>"],
   Subsuperscript["E", "1,l2,m2;l", "-1,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Particular case:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraceBasisDummy", "[", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "2", "]"}], ",", 
     RowBox[{"LI", "[", "1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "spherical"}], "}"}]}], "]"}], 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "3", "]"}], ",", 
     RowBox[{"LI", "[", 
      RowBox[{"-", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "spherical"}]}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "   ", 
      RowBox[{"21", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1], {2, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["2",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"3", "-", "2", " "}]],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[-2], {2, -spherical}],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "   ", 
      RowBox[{"21", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}]],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[1], {3, spherical}],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", 
      RowBox[{"  ", 
       StyleBox["3",
        FontColor->RGBColor[1, 0, 0]]}], 
      RowBox[{"3", "-", "2", " "}]],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[-2], {3, -spherical}],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HarmonicComponent", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SqrtBox["7"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{"(", 
     RowBox[{"7", "+", 
      RowBox[{"6", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"4", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   RowBox[{"64", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"tmp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l1", "\[Rule]", "2"}], ",", 
      RowBox[{"m1", "\[Rule]", "1"}], ",", 
      RowBox[{"l2", "\[Rule]", "3"}], ",", 
      RowBox[{"m2", "\[Rule]", 
       RowBox[{"-", "2"}]}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "1", ",", "5"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"1,2,1;1\"\>", "\<\"-1,3,-2\"\>"],
    Subsuperscript["E", "1,2,1;1", "-1,3,-2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", 
      RowBox[{"1", "-", "1"}]],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[-1]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"1,2,1;3\"\>", "\<\"-1,3,-2\"\>"],
    Subsuperscript["E", "1,2,1;3", "-1,3,-2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", 
      RowBox[{"3", "-", "1"}]],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[-1]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"1,2,1;5\"\>", "\<\"-1,3,-2\"\>"],
    Subsuperscript["E", "1,2,1;5", "-1,3,-2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", 
      RowBox[{"5", "-", "1"}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[-1]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SqrtBox["7"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    RowBox[{"(", 
     RowBox[{"7", "+", 
      RowBox[{"6", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        RowBox[{"4", " ", 
         InterpretationBox[
          StyleBox[
           SubsuperscriptBox["\[Theta]", "", ""],
           AutoSpacing->False],
          \[Theta][],
          Editable->False]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}]}], 
   RowBox[{"64", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell["That is correct. However, here r1 and r2 are different:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l1", "]"}], ",", 
     RowBox[{"LI", "[", "m1", "]"}], ",", "a"}], "]"}], 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l2", "]"}], ",", 
     RowBox[{"LI", "[", "m2", "]"}], ",", 
     RowBox[{"-", "a"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["X", "   ", "l1m1a"],
    AutoSpacing->False],
   X[
    LI[l1], 
    LI[m1], a],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", 
     RowBox[{"  ", "a"}], 
     RowBox[{"l2m2", " "}]],
    AutoSpacing->False],
   Z[
    LI[l2], 
    LI[m2], -a],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{"expression", "/.", 
   RowBox[{"FormalProductRule", "[", "l", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
     RowBox[{"     ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "l"}], " ", "+", " ", "l1", " ", "+", " ", "l2"}], "\n", 
       
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]}], "lm1"}], " ", "+", " ", "m2"}]}]}]],
    AutoSpacing->False],
   calZ[
    LI[-(-1)^(-l + l1 + l2)], 
    LI[l], 
    LI[m1 + m2]],
   Editable->False], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"1,l1,m1;l\"\>", "\<\"-1,l2,m2\"\>"],
   Subsuperscript["E", "1,l1,m1;l", "-1,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{"tmp", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1", "\[Rule]", "l2"}], ",", 
     RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
     RowBox[{"     ", 
      RowBox[{
       RowBox[{"-", "l"}], "\n", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}]}], "l2", " ", "m2"}]}]}]],
    AutoSpacing->False],
   calZ[
    LI[-(-1)^(-l)], 
    LI[l], 
    LI[2 m2]],
   Editable->False], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"1,l2,m2;l\"\>", "\<\"-1,l2,m2\"\>"],
   Subsuperscript["E", "1,l2,m2;l", "-1,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"expression", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1", "\[Rule]", "l2"}], ",", 
     RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Particular case:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1", "\[Rule]", "l2"}], ",", 
     RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"l2", "\[Rule]", "2"}], ",", 
    RowBox[{"m2", "\[Rule]", "1"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
     RowBox[{"     ", 
      RowBox[{
       RowBox[{"-", "l"}], "\n", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}]}], "l2"}]}]}]],
    AutoSpacing->False],
   calZ[
    LI[-(-1)^(-l)], 
    LI[l], 
    LI[2]],
   Editable->False], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"1,2,1;l\"\>", "\<\"-1,2,1\"\>"],
   Subsuperscript["E", "1,2,1;l", "-1,2,1"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "0", ",", "4"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"1,2,1;1\"\>", "\<\"-1,2,1\"\>"],
    Subsuperscript["E", "1,2,1;1", "-1,2,1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "12"],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[2]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"1,2,1;3\"\>", "\<\"-1,2,1\"\>"],
    Subsuperscript["E", "1,2,1;3", "-1,2,1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "32"],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[2]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "coeffERule"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"coeffE", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "3"}], "}"}], ",", "l"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "0", ",", "6"}], "}"}]}], "]"}], "/.", 
  "coeffERule"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox[
     SqrtBox[
      FractionBox["6", "\[Pi]"]], "11"]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "22"], " ", 
    SqrtBox[
     FractionBox["7", 
      RowBox[{"13", " ", "\[Pi]"}]]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
This is due to the fact that coeffE[{s1,l1,m1},{s2,l2,m2},l] is zero for odd \
l when l1=l2 and either s1=s2 or m1=m2. This comes from the fact that \
CG[{l,m},{l,m},{lp,2m}] is zero for odd lp.\
\>", "Text"],

Cell["Example 8:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "=", 
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l1", "]"}], ",", 
     RowBox[{"LI", "[", "m1", "]"}]}], "]"}], 
   RowBox[{"Z", "[", 
    RowBox[{
     RowBox[{"LI", "[", "l2", "]"}], ",", 
     RowBox[{"LI", "[", "m2", "]"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "  ", "l1m1"],
    AutoSpacing->False],
   Z[
    LI[l1], 
    LI[m1]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "  ", "l2m2"],
    AutoSpacing->False],
   Z[
    LI[l2], 
    LI[m2]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{"%", "/.", 
   RowBox[{"FormalProductRule", "[", "l", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
     RowBox[{"    ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "l"}], " ", "+", " ", "l1", " ", "+", " ", "l2"}], "\n", 
       
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "lm1"}], " ", "+", " ", "m2"}]}]}]],
    AutoSpacing->False],
   calZ[
    LI[(-1)^(-l + l1 + l2)], 
    LI[l], 
    LI[m1 + m2]],
   Editable->False], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"0,l1,m1;l\"\>", "\<\"0,l2,m2\"\>"],
   Subsuperscript["E", "0,l1,m1;l", "0,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{"tmp", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1", "\[Rule]", "l2"}], ",", 
     RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
     RowBox[{"    ", 
      RowBox[{
       RowBox[{"-", "l"}], "\n", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "l2", " ", "m2"}]}]}]],
    AutoSpacing->False],
   calZ[
    LI[(-1)^(-l)], 
    LI[l], 
    LI[2 m2]],
   Editable->False], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"0,l2,m2;l\"\>", "\<\"0,l2,m2\"\>"],
   Subsuperscript["E", "0,l2,m2;l", "0,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"l1", "\[Rule]", "l2"}], ",", 
    RowBox[{"m1", "\[Rule]", "m2"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 SuperscriptBox[
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "  ", "l2m2"],
    AutoSpacing->False],
   Z[
    LI[l2], 
    LI[m2]],
   Editable->False], "2"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"%", "/.", 
   RowBox[{"FormalProductRule", "[", "l", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[GothicCapitalZ]", "   ", 
     RowBox[{"    ", 
      RowBox[{
       RowBox[{"-", "l"}], "\n", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "l2", " ", "m2"}]}]}]],
    AutoSpacing->False],
   calZ[
    LI[(-1)^(-l)], 
    LI[l], 
    LI[2 m2]],
   Editable->False], " ", 
  InterpretationBox[
   SubsuperscriptBox["\<\"E\"\>", "\<\"0,l2,m2;l\"\>", "\<\"0,l2,m2\"\>"],
   Subsuperscript["E", "0,l2,m2;l", "0,l2,m2"],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"r1", "-", "r2"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Particular case:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "2", "]"}], ",", 
    RowBox[{"LI", "[", "1", "]"}]}], "]"}], 
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "3", "]"}], ",", 
    RowBox[{"LI", "[", 
     RowBox[{"-", "2"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "  ", "21"],
    AutoSpacing->False],
   Z[
    LI[2], 
    LI[1]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "  ", 
     RowBox[{"3", "-", "2"}]],
    AutoSpacing->False],
   Z[
    LI[3], 
    LI[-2]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HarmonicComponent", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SqrtBox["7"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "3"]}], 
   RowBox[{"16", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"tmp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l1", "\[Rule]", "2"}], ",", 
      RowBox[{"m1", "\[Rule]", "1"}], ",", 
      RowBox[{"l2", "\[Rule]", "3"}], ",", 
      RowBox[{"m2", "\[Rule]", 
       RowBox[{"-", "2"}]}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "1", ",", "5"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,2,1;1\"\>", "\<\"0,3,-2\"\>"],
    Subsuperscript["E", "0,2,1;1", "0,3,-2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", 
      RowBox[{"1", "-", "1"}]],
     AutoSpacing->False],
    Z[
     LI[1], 
     LI[-1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,2,1;3\"\>", "\<\"0,3,-2\"\>"],
    Subsuperscript["E", "0,2,1;3", "0,3,-2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", 
      RowBox[{"3", "-", "1"}]],
     AutoSpacing->False],
    Z[
     LI[3], 
     LI[-1]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,2,1;5\"\>", "\<\"0,3,-2\"\>"],
    Subsuperscript["E", "0,2,1;5", "0,3,-2"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", 
      RowBox[{"5", "-", "1"}]],
     AutoSpacing->False],
    Z[
     LI[5], 
     LI[-1]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SqrtBox["7"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Phi]", "", ""],
        AutoSpacing->False],
       \[Phi][],
       Editable->False]}]], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Cos",
        AutoSpacing->False],
       Cos,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["Sin",
        AutoSpacing->False],
       Sin,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["\[Theta]", "", ""],
        AutoSpacing->False],
       \[Theta][],
       Editable->False], "]"}], "3"]}], 
   RowBox[{"16", " ", "\[Pi]"}]]}]], "Output"]
}, Open  ]],

Cell["That is correct. Another particular case:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "2", "]"}], ",", 
    RowBox[{"LI", "[", "1", "]"}]}], "]"}], 
  RowBox[{"Z", "[", 
   RowBox[{
    RowBox[{"LI", "[", "2", "]"}], ",", 
    RowBox[{"LI", "[", "1", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 SuperscriptBox[
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["Z", "  ", "21"],
    AutoSpacing->False],
   Z[
    LI[2], 
    LI[1]],
   Editable->False], "2"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HarmonicComponent", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"]}], 
  RowBox[{"8", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"tmp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l1", "\[Rule]", "2"}], ",", 
      RowBox[{"m1", "\[Rule]", "1"}], ",", 
      RowBox[{"l2", "\[Rule]", "2"}], ",", 
      RowBox[{"m2", "\[Rule]", "1"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "0", ",", "4"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,2,1;0\"\>", "\<\"0,2,1\"\>"],
    Subsuperscript["E", "0,2,1;0", "0,2,1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "02"],
     AutoSpacing->False],
    Z[
     LI[0], 
     LI[2]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,2,1;2\"\>", "\<\"0,2,1\"\>"],
    Subsuperscript["E", "0,2,1;2", "0,2,1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "22"],
     AutoSpacing->False],
    Z[
     LI[2], 
     LI[2]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\<\"E\"\>", "\<\"0,2,1;4\"\>", "\<\"0,2,1\"\>"],
    Subsuperscript["E", "0,2,1;4", "0,2,1"],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["Z", "  ", "42"],
     AutoSpacing->False],
    Z[
     LI[4], 
     LI[2]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", "coeffERule"}], "//", "HarmonicComponent"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Phi]", "", ""],
       AutoSpacing->False],
      \[Phi][],
      Editable->False]}]], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Cos",
       AutoSpacing->False],
      Cos,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Theta]", "", ""],
       AutoSpacing->False],
      \[Theta][],
      Editable->False], "]"}], "2"]}], 
  RowBox[{"8", " ", "\[Pi]"}]]], "Output"]
}, Open  ]],

Cell["That is correct too.", "Text"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dump", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`Harmonics`Private`\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TimeUsed", "[", "]"}]], "Input"],

Cell[BoxData["57.827614`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024"}], "/", "1000."}]], "Input"],

Cell[BoxData["28.498953125`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MaxMemoryUsed", "[", "]"}], "/", "1024"}], "/", 
  "1000."}]], "Input"],

Cell[BoxData["28.5114453125`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/projects/secondpt/mathematica/\>\"", 
  "]"}]], "Input"],

Cell[BoxData["\<\"/home/jmm/projects/secondpt/mathematica\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DumpSave", "[", "\"\<xPert_0.mx\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Exit", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<xPert_0.mx\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024"}], "/", "1000."}]], "Input"],

Cell[BoxData["14.5194296875`"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1016, 696},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
TrackCellChangeTimes->False,
Magnification->1,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]

