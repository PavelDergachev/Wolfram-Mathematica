Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Invar package",
 FontColor->RGBColor[1, 0, 0]]], "Title"],

Cell[TextData[StyleBox["Manipulation of the invariants of Riemann tensors",
 FontColor->RGBColor[0, 0, 1]]], "Subtitle"],

Cell[TextData[{
 StyleBox["Jos\[EAcute] M. Mart\[IAcute]n-Garc\[IAcute]a",
  FontSize->18],
 "     jose@xact.es\n\n",
 StyleBox["David Yllanes",
  FontSize->18],
 "     yllanes@xact.es\nUniversidad Complutense de Madrid\n\n",
 StyleBox["Renato Portugal",
  FontSize->18],
 "     \nLaborat\[OAcute]rio Nacional de Computa\[CCedilla]\[ATilde]o Cient\
\[IAcute]fica, Petr\[OAcute]polis, Brazil\n\n(c) 2006-2015, under GPL\n\n\
http://www.xact.es/\n\nhttp://groups.google.com/group/xAct"
}], "Subsubtitle"],

Cell[CellGroupData[{

Cell["Set up of the system", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Date", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2014", ",", "9", ",", "27", ",", "22", ",", "37", ",", 
   "43.23293`8.388389647147768"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xAct`Invar`$Version", "=", 
  RowBox[{"{", 
   RowBox[{"\"\<2.0.5\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"2013", ",", "7", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"2.0.5\"\>", ",", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "7", ",", "1"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xAct`Invar`$xTensorVersionExpected", "=", 
  RowBox[{"{", 
   RowBox[{"\"\<1.1.0\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"2013", ",", "9", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"1.1.0\"\>", ",", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "9", ",", "1"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "spell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "spell1"}], "]"}]}], "Input"],

Cell[CellGroupData[{

Cell["TODO", "Subsection"],

Cell["\<\
- Nondual invariants can be handled in any dimension, but so far dual \
invariants only work in dimension 4. Generalize that. Answer to Teake in the \
group (16 June 2011): \[OpenCurlyDoubleQuote]And I agree that the codes of \
Invar2 would require slight generalizations to be able to generate and deal \
with the databases for dual invariants in dimensions other than 4, for those \
cases in which it makes sense. I just had a look at Invar.m and I see that \
the
private function riemannof is the only place where dimension 4 is hardwired. \
The function InvSimplify has also the error message \
\[OpenCurlyDoubleQuote]Duals
are only handled in dimension 4.\[CloseCurlyDoubleQuote], which would have to \
be removed. Finally, some bookkeeping functions like MaxDualIndex would have to
take an additional dimension argument. I think that\[CloseCurlyQuote]s all.\
\[CloseCurlyDoubleQuote]\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["GPL", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Invar", ",", " ", 
    RowBox[{
    "a", " ", "free", " ", "package", " ", "for", " ", "simplification", " ", 
     "of", " ", "Riemann", " ", "invariants"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2006"}], "-", 
     RowBox[{"2015", " ", "Jose", " ", 
      RowBox[{"M", ".", " ", "Martin"}]}], "-", "Garcia"}], ",", " ", 
    RowBox[{
     RowBox[{"D", ".", " ", "Yllanes"}], " ", "and", " ", "Renato", " ", 
     "Portugal"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\[IndentingNewLine]", " ", 
      "it", " ", "under", " ", "the", " ", "terms", " ", "of", " ", "the", 
      " ", "GNU", " ", "General", " ", "Public", " ", "License", " ", "as", 
      " ", "published", "\[IndentingNewLine]", " ", "by", " ", "the", " ", 
      "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
      "License"}]}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", "\[IndentingNewLine]", " ", "MERCHANTABILITY", " ", "or", " ", 
      "FITNESS", " ", "FOR", " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", 
      "\[IndentingNewLine]", " ", "General", " ", "Public", " ", "License", 
      " ", "for", " ", "more", " ", 
      RowBox[{
      "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "You"}], 
      " ", "should", " ", "have", " ", "received", " ", "a", " ", "copy", " ",
       "of", " ", "the", " ", "GNU", " ", "General", " ", "Public", " ", 
      "License", "\[IndentingNewLine]", " ", "along", " ", "with", " ", 
      "this", " ", "program"}], ";", " ", 
     RowBox[{"if", " ", "not"}]}], ",", " ", 
    RowBox[{
    "write", " ", "to", " ", "the", " ", "Free", " ", "Software", 
     "\[IndentingNewLine]", " ", "Foundation"}], ",", " ", 
    RowBox[{"Inc", "."}], ",", " ", 
    RowBox[{
     RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
     RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
    RowBox[{
     RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", "\[IndentingNewLine]", 
    "  ", 
    RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Info package", "Subsection"],

Cell["\<\
(* :Title: Invar *)

(* :Authors: Jose M. Martin-Garcia, David Yllanes and Renato Portugal *)

(* :Summary: Free package for simplification of Riemann invariants *)

(* :Brief Discussion:
   - Based on xTensor.
   - There is a companion version for Maple (using Canon) by Renato
     Portugal.
   - Simplifies Riemann invariants (scalars formed from the Riemann
     tensor of a metric-compatible connection and its Levi-Civita
     connection) by using permutation group theory.
   - Multiterm symmetries (cyclic, Bianchi, commutation and
     dimension-dependent identities) have been solved in advance
     and stored in solution-files.
   - Works with Riemann, Ricci, RicciScalar, Weyl and TFRicci.
*)
  
(* :Context: xAct`Invar` *)

(* :Package Version: 2.0.5 *)

(* :Copyright: Jose M. Martin-Garcia and David Yllanes (2006-2015) *)

(* :History: 
\t- 22 Nov 2006 - Invar1
\t-  8 Feb 2008 - Invar2
*)

(* :Keywords: *)

(* :Source: Invar.nb *)

(* :Warning: *)

(* :Mathematica Version: 6.0 and later *)

(* :Limitations:
   - Handles algebraic invariants with up to seven Riemann tensors
     or dual invariants with up to five Riemann tensors
   - Handles differential invariants with up to twelve metric derivatives
     or dual invariants with up to eight metric derivatives *)\
\>", "Input",
 PageWidth->PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Begin package", "Subsection"],

Cell["Protect against multiple loading of the package:", "Text"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xAct`Invar`Private`InvarSymbols", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Names", "[", "\"\<xAct`Invar`*\>\"", "]"}], ",", 
         RowBox[{"Names", "[", "\"\<xAct`Invar`Private`*\>\"", "]"}]}], "]"}],
        ",", 
       RowBox[{
       "\"\<$Version\>\"", "|", "\"\<xAct`Invar`$Version\>\"", "|", 
        "\"\<$xTensorVersionExpected\>\"", "|", 
        "\"\<xAct`Invar`$xTensorVersionExpected\>\""}]}], "]"}]}], "}"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "/@", "xAct`Invar`Private`InvarSymbols"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Clear", "/@", "xAct`Invar`Private`InvarSymbols"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 InitializationCell->True],

Cell[TextData[{
 "Explicit (not hidden) import of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". QUESTION: Do we really need ExpressionManipulation?"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{"xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`Invar`\>\""}]}],
    "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["xAct`xCore`Private`$LastPackage"], "Input"],

Cell[BoxData["\<\"xAct`Invar`\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`Invar`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xTensor`\>\"", ",", "\"\<xAct`xPerm`\>\"", ",", 
     "\"\<xAct`xCore`\>\"", ",", "\"\<xAct`ExpressionManipulation`\>\""}], 
    "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.2\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "28"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.2", ", ", {2014, 9, 28}],
  
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2003-2014, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"Connecting to external mac executable...\"\>"], "Print"],

Cell[BoxData["\<\"Connection established.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.1.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "28"}], "}"}]}],
  SequenceForm[
  "Package xAct`xTensor`  version ", "1.1.1", ", ", {2014, 9, 28}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2002-2014, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"]
}, Open  ]],

Cell[BoxData["\<\"xAct`Invar`\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$ContextPath"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"xAct`Invar`\"\>", ",", "\<\"xAct`xTensor`\"\>", 
   ",", "\<\"xAct`xPerm`\"\>", ",", "\<\"xAct`xCore`\"\>", 
   ",", "\<\"xAct`ExpressionManipulation`\"\>", ",", "\<\"System`\"\>"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Check version of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". We simply compare dates:"
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"General", "::", "xTensorVersion"}], "=", 
   "\"\<Loaded xTensor version `1` but expected version `2` at least.\>\""}], 
  ";"}], "\n", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Not", "@", 
    RowBox[{"OrderedQ", "@", 
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"{", 
        RowBox[{"$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}], 
        "}"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"General", "::", "xTensorVersion"}], ",", 
      "xAct`xTensor`$Version", ",", "$xTensorVersionExpected"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "Input",
 InitializationCell->True],

Cell["Message:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`Invar`  version \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  "\"\<CopyRight (C) 2006-2015, J. M. Martin-Garcia, D. Yllanes and R. \
Portugal, under the General Public License.\>\"", "]"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`Invar`  version \"\>", 
   "\[InvisibleSpace]", "\<\"2.0.5\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "7", ",", "1"}], "}"}]}],
  SequenceForm["Package xAct`Invar`  version ", "2.0.5", ", ", {2013, 7, 1}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2006-2014, J. M. Martin-Garcia, D. Yllanes \
and R. Portugal, under the General Public License.\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We specify the context xAct`Invar` to avoid overriding the Disclaimer's of \
xTensor and xPerm. However we need to turn off the message General:shdw \
temporarily:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`Invar`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True],

Cell[TextData[{
 "If ",
 StyleBox["Invar",
  FontSlant->"Italic"],
 " is the last package begin read, print the GPL message:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`Invar`\>\""}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell["We already have these symbols:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "xAct`Invar`*"}]], "Input"],

Cell[BoxData[
 DynamicModuleBox[{Typeset`open$$ = True}, 
  PaneSelectorBox[{False->
   RowBox[{
    OpenerBox[Dynamic[Typeset`open$$],
     ImageSize->Small], 
    StyleBox["xAct`Invar`", "InfoHeading"]}], True->GridBox[{
     {
      RowBox[{
       OpenerBox[Dynamic[Typeset`open$$],
        ImageSize->Small], 
       StyleBox["xAct`Invar`", "InfoHeading"]}]},
     {GridBox[{
        {
         ButtonBox["Disclaimer",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info3620846296-2443270", {"Disclaimer", "xAct`Invar`"}},
          ButtonNote->"xAct`Invar`"], 
         ButtonBox["$Version",
          BaseStyle->"InformationLink",
          ButtonData:>{"Info3620846296-2443270", {"$Version", "xAct`Invar`"}},
          
          ButtonNote->"xAct`Invar`"], 
         ButtonBox["$xTensorVersionExpected",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info3620846296-2443270", {
            "$xTensorVersionExpected", "xAct`Invar`"}},
          ButtonNote->"xAct`Invar`"]}
       },
       DefaultBaseStyle->"InfoGrid",
       GridBoxItemSize->{"Columns" -> {{
            Scaled[0.31666666666666665`]}}}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}]}, 
   Dynamic[Typeset`open$$],
   ImageSize->Automatic]]], "Print", "InfoCell"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Public functions", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$InvarDirectory", "::", "usage"}], "=", 
   "\"\<$InvarDirectory is a global variable giving the directory in which \
the package file and the database can be found.\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "::", "usage"}], "=", 
   "\"\<InvarCases[s, d] returns the list of cases of order (number of metric \
derivatives) s and degree (number of Riemanns) d. InvarCases[s] returns the \
list of cases of order s. InvarCases[] returns the list of all cases handled \
by Invar (currently the 47 cases up to order 12 plus the algebraic case of \
degree 7).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "::", "usage"}], "=", 
   "\"\<InvarDualCases[s, d] returns the list of dual cases of order (number \
of metric derivatives) s and degree (number of Riemanns) d in dimension 4. \
InvarDualCases[s] returns the list of dual cases of order s. InvarDualCases[] \
returns the list of all dual cases handled by Invar (currently the 14 cases \
up to order 8 plus the algebraic case of degree 5).\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInv", "::", "usage"}], "=", 
   "\"\<RInv[g][c, r] denotes the Riemann invariant of case c and index r \
associated to the metric g.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInv", "::", "usage"}], "=", 
   "\"\<DualRInv[g][c, r] denotes the dual Riemann invariant of case c and \
index r associated to the metric g.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RPerm", "::", "usage"}], "=", 
   "\"\<RPerm[g][{c, ed}, perm] denotes a Riemann invariant of case c with ed \
epsilon tensors (both associated to metric g), after reordering the indices \
from a canonical order using permutation perm.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WInv", "::", "usage"}], "=", 
   "\"\<WInv[g][c, r] denotes the Weyl invariant of case c and index r \
associated to the metric g.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInv", "::", "usage"}], "=", 
   "\"\<DualWInv[g][c, r] denotes the dual Weyl invariant of case c and index \
r associated to the metric g.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WPerm", "::", "usage"}], "=", 
   "\"\<WPermRPerm[g][{Rd, ed}, perm] denotes a Weyl invariant  formed by Rd \
Weyl tensors and ed epsilon tensors, after reordering the indices from a \
canonical order using permutation perm. Contracted Weyls encode the Traceless \
Ricci tensor.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RToW", "::", "usage"}], "=", 
   "\"\<RToW[expr] transforms Riemann invariants into Weyl invariants in \
expression expr.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WToR", "::", "usage"}], "=", 
   "\"\<WToR[expr] transforms Weyl invariants into Riemann invariants in \
expression expr.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RToWRules", "::", "usage"}], "=", 
   "\"\<RToWRules[step, degree]\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RToWDualRules", "::", "usage"}], "=", 
   "\"\<RToWDualRules[step, degree]\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WToRRules", "::", "usage"}], "=", 
   "\"\<RToWRules[step, degree]\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WToRDualRules", "::", "usage"}], "=", 
   "\"\<RToWDualRules[step, degree]\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "::", "usage"}], "=", 
   "\"\<RInvs[step, case] gives all independent Riemann invariants at the \
given step (1, 2, 3, 4, 5 or 6) and the given case. Using RInvs[g] instead of \
RInvs we get the particularization of the invariants to metric g.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WInvs", "::", "usage"}], "=", 
   "\"\<WInvs[step, case] gives all independent Weyl invariants at the given \
step (1, 2, 3, 4, 5, 6) and the given case. Using WInvs[g] instead of WInvs \
we get the particularization of the invariants to metric g.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "::", "usage"}], "=", 
   "\"\<DualRInvs[step, case] gives all independent dual Riemann invariants \
at the given step (1, 2, 3, 4, 5 or 6) and the given case. Using DualRInvs[g] \
instead of RInvs we get the particularization of the dual invariants to \
metric g.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInvs", "::", "usage"}], "=", 
   "\"\<DualWInvs[step, case] gives all independent dual Weyl invariants at \
the given step (1, 2, 3, 4, 5 or 6) and the given case. Using DualWInvs[g] \
instead of WInvs we get the particularization of the dual invariants to \
metric g.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "::", "usage"}], "=", 
   "\"\<RInvRules[step, case] gives the list of rules to be used to simplify \
Riemann non-dual invariants of the given case at the given step.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WInvRules", "::", "usage"}], "=", 
   "\"\<WInvRules[step, case] gives the list of rules to be used to simplify \
Weyl non-dual invariants of the given case at the given step.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "::", "usage"}], "=", 
   "\"\<DualRInvRules[step, case] gives the list of rules to be used to \
simplify Riemann dual invariants of the given case at the given step.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInvRules", "::", "usage"}], "=", 
   "\"\<DualWInvRules[step, case] gives the list of rules to be used to \
simplify Weyl dual invariants of the given case at the given step.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RemoveRInvRules", "::", "usage"}], "=", 
   "\"\<RemoveRInvRules[step, case] removes the stored rules for the \
invariants of the given step and case.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveDualRInvRules", "::", "usage"}], "=", 
   "\"\<RemoveDualRInvRules[step, case] removes the stored rules for the dual \
invariants of the given step and case.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "::", "usage"}], "=", 
   "\"\<MaxIndex[step] gives the largest index of the non-dual invariants at \
the given step.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "::", "usage"}], "=", 
   "\"\<MaxDualIndex[step] gives the largest index of the dual invariants at \
the given step.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify", "::", "usage"}], "=", 
   "\"\<InvSimplify[expr, level] simplifies the invariants of the form \
inv[metric][case,count] in the expression expr, where inv is one of RInv, \
DualRInv, WInv, DualWInv. There are six possible levels of simplification: 1 \
means no simplification; 2 uses the cyclic identity; 3 uses the Bianchi \
identity; 4 commutes covariant derivatives; 5 uses dimensionally dependent \
(Lovelock type) identities and 6 reduces some non-dual invariants into \
products of dual invariants. The default level used in InvSimplify[expr] is \
$InvSimplifyLevel.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToPerm", "::", "usage"}], "=", 
   "\"\<InvToPerm[expr] converts all invariants in expr into their \
corresponding permutations with head RPerm or WPerm.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToRiemann", "::", "usage"}], "=", 
   "\"\<PermToRiemann[expr, cr] converts all permutations into their explicit \
tensor expressions. With cr=True contracted Riemann tensors are replaced by \
Ricci tensors. The default value used in PermToRiemann[expr] is \
$CurvatureRelations.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToRiemann", "::", "usage"}], "=", 
   "\"\<InvToRiemann[expr, cr] converts all invariants into their explicit \
tensor expressions. With cr=True contracted Riemann tensors are replaced by \
Ricci tensors. The default value used in InvToRiemann[expr] is \
$CurvatureRelations.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannToPerm", "::", "usage"}], "=", 
   "\"\<RiemannToPerm[expr, g] converts all Riemann scalars of metric g into \
their canonical permutations. If g is a list of metrics then the command is \
folded over the list. RiemannToPerm[expr] is automatically converted into \
RiemannToPerm[expr, $Metrics].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToInv", "::", "usage"}], "=", 
   "\"\<PermToInv[expr] converts all permutations in expr into their \
correspondent invariants. It is assumed that the permutations have been \
already canonicalized.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannToInv", "::", "usage"}], "=", 
   "\"\<RiemannToInv[expr, g] converts all Riemann scalars of metric g into \
their invariant form. If g is a list of metrics then the command is folded \
over the list. RiemannToInv[expr] is automatically converted into \
RiemannToInv[expr, $Metrics].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannSimplify", "::", "usage"}], "=", 
   "\"\<RiemannSimplify[expr, level, cr, g] simplifies the Riemann scalars of \
metric g using relations up to the given level (see usage message for \
InvSimplify). With cr=True contracted Riemann tensors are replaced by Ricci \
tensors. If g is a list of metrics then the command is folded over the list. \
RiemannSimplify[expr] uses the defaults $InvSimplifyLevel, \
$CurvatureRelations and $Metrics, respectively. See usage messages for those \
global variables.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dim", "::", "usage"}], "=", 
   "\"\<dim is a constant symbol used in the Invar rules to denote the \
dimension of a manifold.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigma", "::", "usage"}], "=", 
   "\"\<sigma is a constant symbol used in the Invar rules to denote the sign \
of the determinant of a metric.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$InvSimplifyLevel", "::", "usage"}], "=", 
   "\"\<$InvSimplifyLevel is a global variable specifying the default level \
of simplification in InvSimplify. Initially it is set to 6.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CurvatureRelations", "::", "usage"}], "=", 
   "\"\<$CurvatureRelations is a global variable specifying the default \
behaviour of contracted Riemann conversion in the functions PermToRiemann, \
InvToRiemann and RiemannSimplify.\>\""}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomRiemannMonomial", "::", "usage"}], "=", 
   "\"\<RandomRiemannMonomial[c, g] generates a random monomial of case c \
with Riemann tensors of the metric g. If not specified, g is taken to be the \
first metric in the list $Metrics.\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$ExpandedCommuteOrder12Q", "::", "usage"}], "=", 
   "\"\<$ExpandedRulesDiagonalQ is a Boolean global variable stating whether \
we want to use the expanded form for the Commute step of some hard cases of \
order 12. Its default value is False.\>\""}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Begin Private", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`Invar`Private`\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$InvarNames", "=", 
   RowBox[{"Names", "[", "\"\<xAct`Invar`*\>\"", "]"}]}], ";"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["sigma", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "sigma"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"sigma is a constant symbol used in the Invar rules to denote \
the sign of the determinant of a metric.\"\>", "MSG"]], "Print", "PrintUsage",
 
 CellTags->"Info3568108645-8679363"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$InvarNames", "=", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"DefConstantSymbol", "[", 
    RowBox[{"sigma", ",", 
     RowBox[{"PrintAs", "\[Rule]", "\"\<\[Sigma]\>\""}]}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefConstantSymbol", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"constant symbol \"\>", "\[InvisibleSpace]", 
   "sigma", "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefConstantSymbol, ": Defining ", "constant symbol ", 
   xAct`Invar`sigma, ". ", ""],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sigma", "/:", 
   RowBox[{"Power", "[", 
    RowBox[{"sigma", ",", 
     RowBox[{"_Integer", "?", "EvenQ"}]}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma", "/:", 
   RowBox[{"Power", "[", 
    RowBox[{"sigma", ",", 
     RowBox[{"_Integer", "?", "OddQ"}]}], "]"}], "=", "sigma"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma", "/:", 
   RowBox[{"Abs", "[", "sigma", "]"}], "=", "1"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "dim"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"dim is a constant symbol used in the Invar rules to denote the \
dimension of a manifold.\"\>", "MSG"]], "Print", "PrintUsage",
 CellTags->"Info3568108646-8679363"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$InvarNames", "=", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"DefConstantSymbol", "[", 
    RowBox[{"dim", ",", 
     RowBox[{"PrintAs", "->", "\"\<d\>\""}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefConstantSymbol", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"constant symbol \"\>", "\[InvisibleSpace]", 
   "dim", "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefConstantSymbol, ": Defining ", "constant symbol ", 
   xAct`Invar`dim, ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Main setup", "Subsection"],

Cell["Options:", "Text"],

Cell[CellGroupData[{

Cell[BoxData["$xpermQ"], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "CanonicalPerm", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"MathLink", "\[RuleDelayed]", "$xpermQ"}], ",", 
   RowBox[{"TimeVerbose", "\[Rule]", "False"}], ",", 
   RowBox[{"xPermVerbose", "\[Rule]", "False"}], ",", 
   RowBox[{"OrderedBase", "\[Rule]", "True"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "ToCanonical", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
   RowBox[{"Notation", "\[Rule]", "Images"}], ",", 
   RowBox[{"UseMetricOnVBundle", "\[Rule]", "All"}], ",", 
   RowBox[{"ExpandChristoffel", "\[Rule]", "False"}], ",", 
   RowBox[{"GivePerm", "\[Rule]", "False"}], ",", 
   RowBox[{"Method", "\[Rule]", "ChangeCovD"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSetOption", "[", 
   RowBox[{"ContractMetric", ",", 
    RowBox[{"AllowUpperDerivatives", "\[Rule]", "True"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell["Default values for the global values of the package:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$InvSimplifyLevel", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CurvatureRelations", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Nonstandard configuration:", "Text"],

Cell["These two are just aesthetical changes:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSet", "[", 
   RowBox[{"$PrePrint", ",", "ScreenDollarIndices"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSet", "[", 
   RowBox[{"$CovDFormat", ",", "\"\<Postfix\>\""}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
JMM 2011: This is not well designed as $CurvatureRelations is not directly \
related to CurvatureRelations as other options are. $CurvatureRelations is \
information for the Riemann simplification functions, while Invar currently \
requires the option CurvatureRelations to be False. The proper solution is \
twofold:
\t1) Rename $CurvatureRelations to something else.
\t2) Make Invar work properly independently of the value of the option \
CurvatureRelations. Same thing happens with $CommuteCovDsOnScalars.
Currently we just sent a few warning messages when loading the package.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSetOption", "[", 
   RowBox[{"DefCovD", ",", 
    RowBox[{"CurvatureRelations", "\[Rule]", "False"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReportSet", "[", 
   RowBox[{"$CommuteCovDsOnScalars", ",", "False"}], "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Formatting of invariants", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tostring", "[", "list_List", "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"ToString", "/@", "list"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tostring", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[BoxData["\<\"000\"\>"], "Output"]
}, Open  ]],

Cell["Invariants with metric:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"RInv", "[", "_", "]"}], "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<I\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"DualRInv", "[", "_", "]"}], "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<D\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"WInv", "[", "_", "]"}], "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<W\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"DualWInv", "[", "_", "]"}], "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<X\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Invariants without metric :", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"RInv", "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<I\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"DualRInv", "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<D\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"WInv", "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<W\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"DualWInv", "[", 
     RowBox[{"case_", ",", "index_"}], "]"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\"\<X\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"tostring", "[", "case", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInv", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", "100"}], "]"}], "^", 
  "2"}]], "Input"],

Cell[BoxData[
 SubsuperscriptBox["\<\"I\"\>", "\<\"013,100\"\>", "2"]], "Output"]
}, Open  ]],

Cell["Permutations RPerm and WPerm are not formatted.", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["Reading Invar files as rules", "Subsection"],

Cell["Switch to read the Weyl section of the package:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ReadWeyl", "=", "False"}], ";"}]], "Input",
 InitializationCell->True],

Cell["The installation directory of Invar:", "Text"],

Cell[CellGroupData[{

Cell[BoxData["$UserBaseDirectory"], "Input"],

Cell[BoxData["\<\"/Users/jose/Library/Mathematica\"\>"], "Output"]
}, Open  ]],

Cell["Default directory for the package :", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$InvarDirectory", "=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"$xActDirectory", ",", "\"\</Invar\>\""}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"/Users/jose/Library/Mathematica/Applications/xAct/Invar\"\>\
"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$DataBaseDir", "=", "\"\<Riemann/\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["RInvs", "Subsubsection"],

Cell["Backwards compatibility notation :", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Invariants", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RInv", "[", 
      RowBox[{"deg_Integer", ",", "index_"}], "]"}], ":=", 
     RowBox[{"RInv", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "index"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DualRInv", "[", 
      RowBox[{"deg_Integer", ",", "index_"}], "]"}], ":=", 
     RowBox[{"DualRInv", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "index"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Invariants", " ", "with", " ", "metric", " ", "argument"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RInv", "[", "metric_", "]"}], "[", 
      RowBox[{"deg_Integer", ",", "index_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RInv", "[", "metric", "]"}], "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "index"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DualRInv", "[", "metric_", "]"}], "[", 
      RowBox[{"deg_Integer", ",", "index_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"DualRInv", "[", "metric", "]"}], "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "index"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Independent", " ", "Riemann", " ", "invariants"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"step_Integer", ",", "deg_Integer", ",", "dim___"}], "]"}], ":=", 
     RowBox[{"RInvs", "[", 
      RowBox[{"step", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "dim"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"step_Integer", ",", "deg_Integer", ",", "dim___"}], "]"}], ":=", 
     RowBox[{"DualRInvs", "[", 
      RowBox[{"step", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "dim"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Lists", " ", "of", " ", "rules"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RInvRules", "[", 
      RowBox[{"step_", ",", "deg_Integer", ",", "dim___"}], "]"}], ":=", 
     RowBox[{"RInvRules", "[", 
      RowBox[{"step", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "dim"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualRInvRules", "[", 
      RowBox[{"step_", ",", "deg_Integer", ",", "dim___"}], "]"}], ":=", 
     RowBox[{"DualRInvRules", "[", 
      RowBox[{"step", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "deg", "}"}]}], "]"}], ",", "dim"}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "From", " ", "Riemann", " ", "to", " ", "Weyl", " ", "invariants"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"WInvs", "[", 
     RowBox[{"step_Integer", ",", "deg_", ",", "dim___"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"step", ",", "deg", ",", "dim"}], "]"}], "/.", 
     RowBox[{"RInv", "\[Rule]", "WInv"}]}]}], ";", 
   RowBox[{
    RowBox[{"DualWInvs", "[", 
     RowBox[{"step_Integer", ",", "deg_", ",", "dim___"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"step", ",", "deg", ",", "dim"}], "]"}], "/.", 
     RowBox[{"DualRInv", "\[Rule]", "DualWInv"}]}]}], ";"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
The lists of independent invariants could be protected. We define this \
alternative form of Set:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ProtSet", ",", "HoldFirst"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"head_", "[", "args___", "]"}], ",", "value_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prot", "=", 
       RowBox[{"Unprotect", "[", "head", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Set", "[", 
       RowBox[{
        RowBox[{"head", "[", "args", "]"}], ",", "value"}], "]"}], ";", 
      RowBox[{"Protect", "[", 
       RowBox[{"Evaluate", "[", "prot", "]"}], "]"}], ";", "value"}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["File names", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intercase", "[", "case_List", "]"}], ":=", 
   RowBox[{"StringJoin", "@", 
    RowBox[{"Insert", "[", 
     RowBox[{
      RowBox[{"ToString", "/@", "case"}], ",", "\"\<_\>\"", ",", 
      RowBox[{"List", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", 
         RowBox[{"Length", "[", "case", "]"}]}], "]"}]}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intercase", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[BoxData["\<\"0_1_3\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"filename", "[", 
    RowBox[{
     RowBox[{"step", ":", 
      RowBox[{"(", 
       RowBox[{"5", "|", "6"}], ")"}]}], ",", "case_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"filename", "[", 
     RowBox[{
      RowBox[{"ToString", "[", "step", "]"}], ",", "case"}], "]"}], "<>", 
    "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "dim", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filename", "[", 
    RowBox[{"step_", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<RInv-\>\"", ",", 
     RowBox[{"intercase", "[", "case", "]"}], ",", "\"\<-\>\"", ",", 
     RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"filename", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"RInv-0_1_3-3\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dualfilename", "[", 
    RowBox[{"5", ",", "case_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"dualfilename", "[", 
     RowBox[{"\"\<5\>\"", ",", "case"}], "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "dim", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dualfilename", "[", 
    RowBox[{"step_", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<DInv-\>\"", ",", 
     RowBox[{"intercase", "[", "case", "]"}], ",", "\"\<-\>\"", ",", 
     RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dualfilename", "[", 
  RowBox[{"5", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", "4"}], "]"}]], "Input"],

Cell[BoxData["\<\"DInv-0_1_3-5_4\"\>"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check the import of the files", "Subsubsection"],

Cell["Code contributed by Teake:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInv", "::", "nodatabase"}], "=", 
   "\"\<Can't find the Invar database. You can download it from \
http://www.xact.es/Invar/.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckImport", "[", "args__", "]"}], ":=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"Import", "[", "args", "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"RInv", "::", "nodatabase"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", 
     RowBox[{"Import", "::", "nffil"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Reading functions. Maple notation", "Subsubsection"],

Cell[TextData[{
 "The permutation files are written in Maple notation. We need a collection \
of functions to translate the data to a format that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " can understand. Note that the files are read without a metric argument."
}], "Text"],

Cell["\<\
Intermediate simple functions. This selects the first of a collection of \
positions:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"firstof", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstof", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "}"}], "]"}], ":=", "a"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstof", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", "__"}], "}"}], "]"}], ":=", 
   "a"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"positionof", "[", 
    RowBox[{"string_String", ",", "substring_String"}], "]"}], ":=", 
   RowBox[{"firstof", "@", 
    RowBox[{"StringPosition", "[", 
     RowBox[{"string", ",", "substring"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"movetofirst", "[", "0", "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"movetofirst", "[", "x_", "]"}], ":=", 
   RowBox[{"x", "+", "4"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Translation from brackets to braces for lists, and from equality to rules:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacebrackets", "[", "string_String", "]"}], ":=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{"string", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
      RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"replaceequal", "[", "string_String", "]"}], ":=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{"string", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<=\>\"", "\[Rule]", "\"\<->\>\""}], "}"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
This is the main conversion function. It only reads what is found to the \
right of := and removing the last character (always a colon).\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"readline", "[", "string_", "]"}], ":=", 
  RowBox[{"StringTake", "[", 
   RowBox[{"string", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"movetofirst", "@", 
       RowBox[{"positionof", "[", 
        RowBox[{"string", ",", "\"\< := \>\""}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"StringLength", "[", "string", "]"}], "-", "1"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell["Final reading functions, for Maple notation:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInvarPerms", "[", 
    RowBox[{"filename_", ",", "\"\<Maple\>\""}], "]"}], ":=", 
   RowBox[{"ToExpression", "/@", 
    RowBox[{"replacebrackets", "/@", 
     RowBox[{"readline", "/@", 
      RowBox[{"CheckImport", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"$InvarDirectory", ",", "\"\</\>\"", ",", "filename"}], 
         "]"}], ",", "\"\<Lines\>\""}], "]"}]}]}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInvarRules", "[", 
    RowBox[{"filename_", ",", "\"\<Maple\>\""}], "]"}], ":=", 
   RowBox[{"ToExpression", "/@", 
    RowBox[{"replaceequal", "/@", 
     RowBox[{"readline", "/@", 
      RowBox[{"CheckImport", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"$InvarDirectory", ",", "\"\</\>\"", ",", "filename"}], 
         "]"}], ",", "\"\<Lines\>\""}], "]"}]}]}]}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Reading functions. ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notation"
}], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInvarPerms", "[", 
    RowBox[{"filename_", ",", "\"\<Mathematica\>\""}], "]"}], ":=", 
   RowBox[{"ToExpression", "/@", 
    RowBox[{"CheckImport", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"$InvarDirectory", ",", "\"\</\>\"", ",", "filename"}], "]"}], 
      ",", "\"\<Lines\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInvarRules", "[", 
    RowBox[{"filename_", ",", "\"\<Mathematica\>\""}], "]"}], ":=", 
   RowBox[{"ToExpression", "/@", 
    RowBox[{"CheckImport", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"$InvarDirectory", ",", "\"\</\>\"", ",", "filename"}], "]"}], 
      ",", "\"\<Lines\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Removing rules", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RemoveRInvRules", "[", 
    RowBox[{"step_Integer", ",", "degree_Integer", ",", "dim___"}], "]"}], ":=", 
   RowBox[{"RemoveRInvRules", "[", 
    RowBox[{"step", ",", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "degree", "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveRInvRules", "[", 
    RowBox[{"step_Integer", ",", "case_List", ",", "dim___"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Unset", "[", 
      RowBox[{"DispatchRules", "[", 
       RowBox[{"RInv", ",", "step", ",", "case", ",", "dim"}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Unprotect", "[", "RInvRules", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Unset", "[", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"step", ",", "case", ",", "dim"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Protect", "[", "RInvRules", "]"}], ";"}], "\[IndentingNewLine]",
     ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveDualRInvRules", "[", 
    RowBox[{"step_Integer", ",", "degree_Integer", ",", "dim___"}], "]"}], ":=", 
   RowBox[{"RemoveDualRInvRules", "[", 
    RowBox[{"step", ",", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "degree", "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveDualRInvRules", "[", 
    RowBox[{"step_Integer", ",", "case_List", ",", "dim___"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Unset", "[", 
      RowBox[{"DispatchRules", "[", 
       RowBox[{"DualRInv", ",", "step", ",", "case", ",", "dim"}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Unprotect", "[", "DualRInvRules", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Unset", "[", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"step", ",", "case", ",", "dim"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Protect", "[", "DualRInvRules", "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric argument", "Subsubsection"],

Cell["\<\
We could have invariants associated to different metrics. Therefore the \
invariants need to carry a third argument specifying the metric:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addRdep", "[", 
   RowBox[{"Rule", "[", 
    RowBox[{
     RowBox[{"inv_", "[", 
      RowBox[{"case_", ",", "count_"}], "]"}], ",", "rhs_"}], "]"}], "]"}], ":=", 
  RowBox[{"Rule", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"inv", "[", "metric_", "]"}], "[", 
     RowBox[{"case", ",", "count"}], "]"}], ",", 
    RowBox[{"rhs", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RInv", "\[Rule]", 
        RowBox[{"RInv", "[", "metric", "]"}]}], ",", 
       RowBox[{"DualRInv", "\[Rule]", 
        RowBox[{"DualRInv", "[", "metric", "]"}]}], ",", 
       RowBox[{"WInv", "\[Rule]", 
        RowBox[{"WInv", "[", "metric", "]"}]}], ",", 
       RowBox[{"DualWInv", "\[Rule]", 
        RowBox[{"DualWInv", "[", "metric", "]"}]}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
The main idea is that we shall use the dispatched rules with the metric \
option for the actual simplification algorithm, but the normal (Nometric) \
rules to generate the files for the package.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"With", " ", "a", " ", "metric", " ", "argument"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RInvs", "[", "metric_", "]"}], "[", "args__", "]"}], ":=", 
     RowBox[{
      RowBox[{"RInvs", "[", "args", "]"}], "/.", 
      RowBox[{"RInv", "\[Rule]", 
       RowBox[{"RInv", "[", "metric", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{
      RowBox[{"WInvs", "[", "metric_", "]"}], "[", "args__", "]"}], ":=", 
     RowBox[{
      RowBox[{"WInvs", "[", "args", "]"}], "/.", 
      RowBox[{"WInv", "\[Rule]", 
       RowBox[{"WInv", "[", "metric", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DualRInvs", "[", "metric_", "]"}], "[", "args__", "]"}], ":=", 
     
     RowBox[{
      RowBox[{"DualRInvs", "[", "args", "]"}], "/.", 
      RowBox[{"DualRInv", "\[Rule]", 
       RowBox[{"DualRInv", "[", "metric", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DualWInvs", "[", "metric_", "]"}], "[", "args__", "]"}], ":=", 
     
     RowBox[{
      RowBox[{"DualWInvs", "[", "args", "]"}], "/.", 
      RowBox[{"DualWInv", "\[Rule]", 
       RowBox[{"DualWInv", "[", "metric", "]"}]}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Note that there is no confusion between both (metric and nometric) \
definitions because in one case RInvs has one argument, but in the other case \
it has two arguments.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$DefaultDim", ":=", 
   RowBox[{"DimOfVBundle", "@", 
    RowBox[{"VBundleOfMetric", "@", 
     RowBox[{"First", "@", "$Metrics"}]}]}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Cases", "Subsubsection"],

Cell[TextData[{
 "The function InvarCases contains the list of cases which are currently \
handled by ",
 StyleBox["Invar",
  FontSlant->"Italic"],
 ":"
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"InvarCases", "[", "order", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"order", ",", "2", ",", "14", ",", "2"}], "}"}]}], "]"}], ",",
      "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"order_Integer", "?", "EvenQ"}], "]"}], ":=", 
   RowBox[{"InvarCases", "[", 
    RowBox[{"order", ",", 
     RowBox[{"Reverse", "@", 
      RowBox[{"Range", "[", 
       RowBox[{"order", "/", "2"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{
      RowBox[{"order_Integer", "?", "EvenQ"}], ",", "list_List"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"InvarCases", "[", 
         RowBox[{"order", ",", "#"}], "]"}], "&"}], "/@", "list"}], ",", 
      "1"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", "14", "]"}], ":=", 
    RowBox[{"InvarCases", "[", 
     RowBox[{"14", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"4", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "2", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"4", ",", "2"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"6", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "4", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"6", ",", "2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"6", ",", "3"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"8", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "6", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"8", ",", "2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"8", ",", "3"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"8", ",", "4"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"10", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "8", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"10", ",", "2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"10", ",", "3"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"10", ",", "4"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"10", ",", "5"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"12", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "10", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"12", ",", "2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"12", ",", "3"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"12", ",", "4"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", 
    RowBox[{"12", ",", "5"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"12", ",", "6"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarCases", "[", 
     RowBox[{"14", ",", "7"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", "x_", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Invalid order \>\"", ",", "x"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarCases", "[", "args__", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Invar cannot work with the cases \>\"", ",", 
      RowBox[{"{", "args", "}"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvarCases", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "8", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", "10", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input"],

Cell[BoxData["48"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvarCases", "[", "10", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "8", "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvarCases", "[", 
  RowBox[{"10", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"indicesofcase", "[", "case_", "]"}], ":=", 
  RowBox[{
   RowBox[{"4", 
    RowBox[{"Length", "[", "case", "]"}]}], "+", 
   RowBox[{"Plus", "@@", "case"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factorial", "/@", 
  RowBox[{"(", 
   RowBox[{"indicesofcase", "/@", 
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "24", ",", "40320", ",", "720", ",", "479001600", ",", "3628800", ",", 
   "3628800", ",", "40320", ",", "20922789888000", ",", "87178291200", ",", 
   "87178291200", ",", "479001600", ",", "479001600", ",", "479001600", ",", 
   "3628800", ",", "2432902008176640000", ",", "6402373705728000", ",", 
   "6402373705728000", ",", "20922789888000", ",", "20922789888000", ",", 
   "20922789888000", ",", "20922789888000", ",", "87178291200", ",", 
   "87178291200", ",", "87178291200", ",", "87178291200", ",", "479001600", 
   ",", "620448401733239439360000", ",", "1124000727777607680000", ",", 
   "1124000727777607680000", ",", "2432902008176640000", ",", 
   "2432902008176640000", ",", "2432902008176640000", ",", 
   "2432902008176640000", ",", "2432902008176640000", ",", "6402373705728000",
    ",", "6402373705728000", ",", "6402373705728000", ",", "6402373705728000",
    ",", "6402373705728000", ",", "6402373705728000", ",", "6402373705728000",
    ",", "20922789888000", ",", "20922789888000", ",", "20922789888000", ",", 
   "20922789888000", ",", "20922789888000", ",", "87178291200"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plus", "@@", "%"}]], "Input"],

Cell[BoxData["622711058432047619006184"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", "%", "]"}]], "Input"],

Cell[BoxData["6.227110584320476`*^23"], "Output"]
}, Open  ]],

Cell["Almost Avogadro's number!", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"InvarDualCases", "[", "order", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"order", ",", "2", ",", "10", ",", "2"}], "}"}]}], "]"}], ",",
      "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"order_Integer", "?", "EvenQ"}], "]"}], ":=", 
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"order", ",", 
     RowBox[{"Reverse", "@", 
      RowBox[{"Range", "[", 
       RowBox[{"order", "/", "2"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", 
     RowBox[{
      RowBox[{"order_Integer", "?", "EvenQ"}], ",", "list_List"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"InvarDualCases", "[", 
         RowBox[{"order", ",", "#"}], "]"}], "&"}], "/@", "list"}], ",", 
      "1"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", "10", "]"}], ":=", 
    RowBox[{"InvarDualCases", "[", 
     RowBox[{"10", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"4", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "2", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", 
     RowBox[{"4", ",", "2"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"6", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "4", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"6", ",", "2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", 
     RowBox[{"6", ",", "3"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"8", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "6", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"8", ",", "2"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", 
    RowBox[{"8", ",", "3"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", 
     RowBox[{"8", ",", "4"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvarDualCases", "[", 
     RowBox[{"10", ",", "5"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", "x_", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Invalid order \>\"", ",", "x"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvarDualCases", "[", "args__", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Invar cannot work with the dual cases \>\"", ",", 
      RowBox[{"{", "args", "}"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvarDualCases", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input"],

Cell[BoxData["15"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Maximum degree and index", "Subsubsection"],

Cell["\<\
These are the numbers (directly copied from the files) of canonical \
invariants for each degree (not containing products):\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MaxIndex"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"MaxIndex[step] gives the largest index of the non-dual \
invariants at the given step.\"\>", "MSG"]], "Print", "PrintUsage",
 CellTags->"Info3568108732-8679363"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"n_Integer", "?", "Positive"}], "]"}], ":=", 
    RowBox[{"MaxIndex", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "n", "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "}"}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "0", "}"}], "]"}], ":=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], ":=", "3"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "2", "}"}], "]"}], ":=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ":=", "9"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}], "]"}], ":=", "12"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], ":=", "12"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "4", "}"}], "]"}], ":=", "12"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], ":=", "38"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2"}], "}"}], "]"}], ":=", "99"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}], "]"}], ":=", "125"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "4"}], "}"}], "]"}], ":=", "126"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], "]"}], ":=", "138"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], "]"}], ":=", "86"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "6", "}"}], "]"}], ":=", "105"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], ":=",
    "204"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], "]"}], ":=", 
   "1020"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "]"}], ":=", 
   "1749"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "4"}], "}"}], "]"}], ":=", "1473"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}], "]"}], ":=", "3099"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "2"}], "}"}], "]"}], ":=", "1622"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2"}], "}"}], "]"}], ":=", "1617"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "6"}], "}"}], "]"}], ":=", "1665"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "5"}], "}"}], "]"}], ":=", "1770"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], "]"}], ":=", "1746"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}], "]"}], ":=", "962"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "8", "}"}], "]"}], ":=", "1155"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
    "]"}], ":=", "1613"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], "]"}], ":=",
    "12722"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], "]"}], ":=",
    "27022"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], "]"}], ":=", 
   "19617"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], "]"}], ":=", 
   "60984"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], "]"}], ":=", 
   "30974"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "]"}], ":=", 
   "62465"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], ":=", 
   "5606"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "6"}], "}"}], "]"}], ":=", "25590"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "5"}], "}"}], "]"}], ":=", "53160"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "4"}], "}"}], "]"}], ":=", "52764"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "4"}], "}"}], "]"}], ":=", "27396"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "3", ",", "3"}], "}"}], "]"}], ":=", "27024"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], ":=", "54654"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "2"}], "}"}], "]"}], ":=", "9104"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "8"}], "}"}], "]"}], ":=", "25515"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "7"}], "}"}], "]"}], ":=", "26670"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "6"}], "}"}], "]"}], ":=", "26460"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "5"}], "}"}], "]"}], ":=", "26670"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", 
    RowBox[{"{", 
     RowBox[{"4", ",", "4"}], "}"}], "]"}], ":=", "13607"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", "10", "}"}], "]"}], ":=", "15120"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], "]"}], ":=", "16532"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "]"}], ":=", "217395"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxIndex", "[", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], "]"}], ":=", "3406747"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxIndex", "[", "case_", "]"}], ":=", 
   RowBox[{"Throw", "@", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Case \>\"", ",", "case", ",", "\"\< not included.\>\""}], 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allnonduals", "=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"MaxIndex", "/@", 
     RowBox[{"InvarCases", "[", "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData["640119"], "Output"]
}, Open  ]],

Cell["Duals.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", "n_Integer", "]"}], ":=", 
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "n", "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", "}"}], "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", "0", "}"}], "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], "=", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", "2", "}"}], "]"}], "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], "=", "27"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}], "]"}], "=", "58"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], "=", "36"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", "4", "}"}], "]"}], "=", "32"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], "=", "232"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2"}], "}"}], "]"}], "=", "967"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}], "]"}], "=", "1047"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "4"}], "}"}], "]"}], "=", "876"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], "]"}], "=", "920"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], "]"}], "=", "478"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", "6", "}"}], "]"}], "=", "435"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], 
    "=", "2582"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     "]"}], "=", "35090"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDualIndex", "[", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], "]"}], "=", "558323"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxDualIndex", "[", "case_", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Dual case\>\"", ",", " ", "case", ",", "\"\< not included.\>\""}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allduals", "=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"MaxDualIndex", "/@", 
     RowBox[{"InvarDualCases", "[", "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData["7698"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allnonduals", "+", "allduals"}]], "Input"],

Cell[BoxData["647817"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["More on RInvs", "Subsubsection"],

Cell["\<\
Construct Invs lists for level 1. There is a call to MaxIndex and hence a \
check of maximum degree.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"1", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"1", ",", "case"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RInv", "[", 
         RowBox[{"case", ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"MaxIndex", "[", "case", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"1", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"1", ",", "case"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DualRInv", "[", 
         RowBox[{"case", ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"MaxDualIndex", "[", "case", "]"}], "]"}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WInvs", "[", 
    RowBox[{"1", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"WInvs", "[", 
      RowBox[{"1", ",", "case"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"WInv", "[", 
         RowBox[{"case", ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"MaxIndex", "[", "case", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInvs", "[", 
    RowBox[{"1", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualWInvs", "[", 
      RowBox[{"1", ",", "case"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DualWInv", "[", 
         RowBox[{"case", ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"MaxDualIndex", "[", "case", "]"}], "]"}]}], "]"}]}], "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["DispatchRules", "Subsubsection"],

Cell["\<\
Dispatch rules per degree. Again, we do not need separate dispatched rules \
for the Weyl invariants:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRules", "[", 
    RowBox[{"RInv", ",", "step_", ",", "case_", ",", "dim___"}], "]"}], ":=", 
   
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "sigma", "}"}], ",", 
     RowBox[{
      RowBox[{"DispatchRules", "[", 
       RowBox[{"RInv", ",", "step", ",", "case", ",", "dim"}], "]"}], "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"RInvRules", "[", 
        RowBox[{"step", ",", "case", ",", "dim"}], "]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRules", "[", 
    RowBox[{"DualRInv", ",", "step_", ",", "case_", ",", "dim___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchRules", "[", 
     RowBox[{"DualRInv", ",", "step", ",", "case", ",", "dim"}], "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"DualRInvRules", "[", 
      RowBox[{"step", ",", "case", ",", "dim"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRules", "[", 
    RowBox[{"WInv", ",", "step_", ",", "case_", ",", "dim___"}], "]"}], ":=", 
   
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "sigma", "}"}], ",", 
     RowBox[{
      RowBox[{"DispatchRules", "[", 
       RowBox[{"WInv", ",", "step", ",", "case", ",", "dim"}], "]"}], "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"WInvRules", "[", 
        RowBox[{"step", ",", "case", ",", "dim"}], "]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRules", "[", 
    RowBox[{"DualWInv", ",", "step_", ",", "case_", ",", "dim___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchRules", "[", 
     RowBox[{"DualWInv", ",", "step", ",", "case", ",", "dim"}], "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"DualWInvRules", "[", 
      RowBox[{"step", ",", "case", ",", "dim"}], "]"}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Read the Canon permutations for the invariants: step 1", \
"Subsubsection"],

Cell[TextData[{
 "First we read the correspondence between invariants and permutations. Note \
that the symbols Invars and DualInvars are never loaded into ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ". "
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"1", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Reading InvRules for step 1 and case \>\"", ",", "case"}],
        "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"Inner", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"tmphead", "@@", 
          RowBox[{"RInvs", "[", 
           RowBox[{"1", ",", "case"}], "]"}]}], ",", 
         RowBox[{"tmphead", "@@", 
          RowBox[{"ReadInvarPerms", "[", 
           RowBox[{
            RowBox[{"$DataBaseDir", "<>", "\"\<1/\>\"", "<>", 
             RowBox[{"filename", "[", 
              RowBox[{"1", ",", "case"}], "]"}]}], ",", "\"\<Maple\>\""}], 
           "]"}]}], ",", "List"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"RInvRules", "[", 
         RowBox[{"1", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"1", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxDualIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Reading DualInvRules for step 1 and case \>\"", ",", "case"}], 
       "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"Inner", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"tmphead", "@@", 
          RowBox[{"DualRInvs", "[", 
           RowBox[{"1", ",", "case"}], "]"}]}], ",", 
         RowBox[{"tmphead", "@@", 
          RowBox[{"ReadInvarPerms", "[", 
           RowBox[{
            RowBox[{"$DataBaseDir", "<>", "\"\<1/\>\"", "<>", 
             RowBox[{"dualfilename", "[", 
              RowBox[{"1", ",", "case"}], "]"}]}], ",", "\"\<Maple\>\""}], 
           "]"}]}], ",", "List"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"1", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Dispatch rules per degree:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"reversecycles", "[", 
    RowBox[{"inv_", "\[Rule]", 
     RowBox[{"{", "cycles__", "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cycles", "[", "cycles", "]"}], "\[Rule]", "inv"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRInvToPermRules", "[", "case_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchRInvToPermRules", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"RInvRules", "[", 
      RowBox[{"1", ",", "case"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchPermToRInvRules", "[", "case_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchPermToRInvRules", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"reversecycles", "/@", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"1", ",", "case"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchDualRInvToPermRules", "[", "case_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchDualRInvToPermRules", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"DualRInvRules", "[", 
      RowBox[{"1", ",", "case"}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchPermToDualRInvRules", "[", "case_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchPermToDualRInvRules", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"reversecycles", "/@", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"1", ",", "case"}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
The files for WInvariants are the same as those for RInvariants. We do not \
create dispatched rules for the WInvariants.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WInvRules", "[", 
    RowBox[{"1", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RInvRules", "[", 
     RowBox[{"1", ",", "case"}], "]"}], "/.", 
    RowBox[{"RInv", "\[Rule]", "WInv"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInvRules", "[", 
    RowBox[{"1", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DualRInvRules", "[", 
     RowBox[{"1", ",", "case"}], "]"}], "/.", 
    RowBox[{"DualRInv", "\[Rule]", "DualWInv"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Examples with invariants:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RInvRules", "[", 
  RowBox[{"1", ",", "3"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "7", ",", "8", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "11"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "11"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,3\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "7", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,4\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "7", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "9", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,6\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "9", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,7\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,8\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"000,9\"\>"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "12"}], "}"}]}], "}"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"1", ",", "7"}], "]"}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.27744799999999991690913248021388426423`6.126943143986419", ",", 
   "16532"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"1", ",", "7"}], "]"}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.01484100000000000002531308496145356912`4.192063078363468", ",", 
   "16532"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvRules", "[", 
   RowBox[{"1", ",", "7"}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"0000000,16532\"\>"], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "4", ",", "7", ",", "11", ",", "17", ",", "8", ",", "13", ",", "6", ",", 
      "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"10", ",", "15", ",", "12", ",", "19", ",", "14", ",", "21"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"16", ",", "18", ",", "23", ",", "20", ",", "25"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"22", ",", "27"}], "}"}]}], "}"}]}]], "Output"]
}, Open  ]],

Cell["Examples with dual invariants:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DualRInvRules", "[", 
   RowBox[{"1", ",", "3"}], "]"}], "//", "Length"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData["27"], "Output"]
}, Open  ]],

Cell["Errors:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "@", 
  RowBox[{"RInvRules", "[", 
   RowBox[{"1", ",", "10"}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" not included.\"\>"}],
  SequenceForm["Case ", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, " not included."],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "@", 
  RowBox[{"DualWInvRules", "[", 
   RowBox[{"1", ",", "8"}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Dual case\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], "\[InvisibleSpace]", "\<\" not included.\"\>"}],
  SequenceForm["Dual case", {0, 0, 0, 0, 0, 0, 0, 0}, " not included."],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Read cyclic rules: step 2", "Subsubsection"],

Cell["Now we read the rules given by the cyclic symmetry.", "Text"],

Cell["Invariants:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"2", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"2", ",", "case"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"RInvs", "[", 
        RowBox[{"1", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"RInvRules", "[", 
         RowBox[{"2", ",", "case"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"2", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"2", ",", "case"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DualRInvs", "[", 
        RowBox[{"1", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"2", ",", "case"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Rules:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"2", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Reading InvRules for step 2 and case \>\"", ",", "case"}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<2/\>\"", "<>", 
          RowBox[{"filename", "[", 
           RowBox[{"2", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"RInvRules", "[", 
         RowBox[{"2", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"2", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxDualIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Reading DualInvRules for step 2 and case \>\"", ",", "case"}], 
       "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<2/\>\"", "<>", 
          RowBox[{"dualfilename", "[", 
           RowBox[{"2", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"2", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Examples:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"result", "=", 
    RowBox[{"RInvRules", "[", 
     RowBox[{"2", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.09669600000000000417088585891178809106`5.006008422379608", ",", "1712"}],
   "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"result", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,144\"\>"], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["\<\"I\"\>", "\<\"013,142\"\>"]}], "+", 
   SubscriptBox["\<\"I\"\>", "\<\"013,143\"\>"]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"result", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,3099\"\>"], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SubscriptBox["\<\"I\"\>", "\<\"013,3088\"\>"], "2"]}], "+", 
   FractionBox[
    SubscriptBox["\<\"I\"\>", "\<\"013,3089\"\>"], "2"]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvs", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
  "Length"}]], "Input"],

Cell[BoxData["1387"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"result", "=", 
    RowBox[{"DualRInvRules", "[", 
     RowBox[{"2", ",", "4"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.03205999999999999822142271455049922224`4.52656343129775", ",", "192"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"result", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"D\"\>", "\<\"0000,1\"\>"], "\[Rule]", "0"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "@", 
  RowBox[{"DualRInvRules", "[", 
   RowBox[{"2", ",", "8"}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Dual case\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], "\[InvisibleSpace]", "\<\" not included.\"\>"}],
  SequenceForm["Dual case", {0, 0, 0, 0, 0, 0, 0, 0}, " not included."],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DualRInvRules", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"D\"\>", "\<\"13,920\"\>"], "\[Rule]", "0"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Read Bianchi rules: step 3", "Subsubsection"],

Cell["Invariants:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"3", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"3", ",", "case"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"RInvs", "[", 
        RowBox[{"2", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"RInvRules", "[", 
         RowBox[{"3", ",", "case"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"3", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"3", ",", "case"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DualRInvs", "[", 
        RowBox[{"2", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"3", ",", "case"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Rules:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"3", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Reading InvRules for step 3 and case \>\"", ",", "case"}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<3/\>\"", "<>", 
          RowBox[{"filename", "[", 
           RowBox[{"3", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"RInvRules", "[", 
         RowBox[{"3", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"3", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxDualIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Reading DualInvRules for step 3 and case \>\"", ",", "case"}], 
       "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<3/\>\"", "<>", 
          RowBox[{"dualfilename", "[", 
           RowBox[{"3", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"3", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Examples:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.06496200000000000585043125056472490542`4.833259300442438", ",", "945"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00071400000000000000792421683826205481`2.874298125055798", ",", "945"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvRules", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
  "Length"}]], "Input"],

Cell[BoxData["945"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvs", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
  "Length"}]], "Input"],

Cell[BoxData["442"], "Output"]
}, Open  ]],

Cell["Duals:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02921699999999999991517896091863804031`4.486235533832953", ",", "126"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00001399999999999999978999003918955779`1.1667279489578624", ",", "126"}],
   "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DualRInvRules", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "//", "Length"}]], "Input"],

Cell[BoxData["126"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvs", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "//", "Length"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["23"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Read Commute rules: step 4", "Subsubsection"],

Cell["Invariants:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"4", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"4", ",", "case"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"RInvs", "[", 
        RowBox[{"3", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"RInvRules", "[", 
         RowBox[{"4", ",", "case"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"4", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"4", ",", "case"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DualRInvs", "[", 
        RowBox[{"3", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"4", ",", "case"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Rules:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ExpandedCommuteOrder12Q", "=", "False"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"extendedQ", "[", "case_", "]"}], ":=", 
   RowBox[{"$ExpandedCommuteOrder12Q", "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"InvarCases", "[", 
       RowBox[{"12", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", "case"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extendedQ", "[", "case_", "]"}], ":=", "True"}], ";"}]}], "Input",
 
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"extendedQ", "[", 
  RowBox[{"{", "8", "}"}], "]"}]], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"extendedQ", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"extendedQ", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "8"}], "}"}], "]"}]], "Input"],

Cell[BoxData["False"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"4", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", 
       RowBox[{"eQ", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"extendedQ", "[", "case", "]"}], ",", "\"\<\>\"", ",", 
          "\"\<NE\>\""}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{
        "\"\<Reading \>\"", "<>", "eQ", "<>", 
         "\"\<InvRules for step 4 and case \>\""}], ",", "case"}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<4/\>\"", "<>", 
          RowBox[{"filename", "[", 
           RowBox[{"4", ",", "case"}], "]"}], "<>", "eQ"}], ",", 
         "\"\<Mathematica\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"RInvRules", "[", 
         RowBox[{"4", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"4", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxDualIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Reading DualInvRules for step 4 and case \>\"", ",", "case"}], 
       "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<4/\>\"", "<>", 
          RowBox[{"dualfilename", "[", 
           RowBox[{"4", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"4", ",", "case"}], "]"}], ",", "result"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Examples:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.08251000000000000000888178419700125232`4.93710650039478", ",", "389"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00122900000000000005767608612927688228`3.110151796166078", ",", "389"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvRules", "[", 
   RowBox[{"4", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
  "Length"}]], "Input"],

Cell[BoxData["389"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvs", "[", 
   RowBox[{"4", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
  "Length"}]], "Input"],

Cell[BoxData["53"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Read Dim-dep rules: step 5", "Subsubsection"],

Cell["Invariants:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"5", ",", "case_"}], "]"}], ":=", 
   RowBox[{"RInvs", "[", 
    RowBox[{"5", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"5", ",", "case_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"5", ",", "case", ",", "dim"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"RInvs", "[", 
        RowBox[{"4", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"RInvRules", "[", 
         RowBox[{"5", ",", "case", ",", "dim"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"5", ",", "case_"}], "]"}], ":=", 
   RowBox[{"DualRInvs", "[", 
    RowBox[{"5", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"5", ",", "case_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"5", ",", "case", ",", "dim"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DualRInvs", "[", 
        RowBox[{"4", ",", "case"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"5", ",", "case", ",", "dim"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Rules:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"5", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"5", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"5", ",", "case_List", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Reading InvRules for step 5, case \>\"", ",", "case", ",", 
        "\"\< and dimension \>\"", ",", "dim"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<5_\>\"", "<>", 
          RowBox[{"ToString", "[", "dim", "]"}], "<>", "\"\</\>\"", "<>", 
          RowBox[{"filename", "[", 
           RowBox[{"5", ",", "case", ",", "dim"}], "]"}]}], ",", 
         "\"\<Mathematica\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"RInvRules", "[", 
         RowBox[{"5", ",", "case", ",", "dim"}], "]"}], ",", "result"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"5", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"5", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvRules", "[", 
    RowBox[{"5", ",", "case_List", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxDualIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Reading DualInvRules for step 5 and case \>\"", ",", "case"}], 
       "]"}], ";", 
      RowBox[{"result", "=", 
       RowBox[{"ReadInvarRules", "[", 
        RowBox[{
         RowBox[{"$DataBaseDir", "<>", "\"\<5_\>\"", "<>", 
          RowBox[{"ToString", "[", "dim", "]"}], "<>", "\"\</\>\"", "<>", 
          RowBox[{"dualfilename", "[", 
           RowBox[{"5", ",", "case", ",", "dim"}], "]"}]}], ",", 
         "\"\<Mathematica\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ProtSet", "[", 
       RowBox[{
        RowBox[{"DualRInvRules", "[", 
         RowBox[{"5", ",", "case", ",", "dim"}], "]"}], ",", "result"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["Examples:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", "4"}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.03519300000000000205879757686489028856`4.567056202789226", ",", "11"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Length", "[", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", "4"}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00001699999999999999986599261148079165`1.2510488346578978", ",", "11"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RInvs", "[", 
   RowBox[{"5", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", "4"}], "]"}], "//", 
  "Length"}]], "Input"],

Cell[BoxData["42"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Read metric-signature rules: step 6", "Subsubsection"],

Cell["\<\
Finally we read the metric-signature dependent relations. There are only 25 \
independent objects:\
\>", "Text"],

Cell["Invariants:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"6", ",", "case_"}], "]"}], ":=", 
   RowBox[{"RInvs", "[", 
    RowBox[{"6", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RInvs", "[", 
    RowBox[{"6", ",", "case_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"6", ",", "case", ",", "dim"}], "]"}], ",", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"RInvs", "[", 
        RowBox[{"5", ",", "case", ",", "dim"}], "]"}], ",", 
       RowBox[{"First", "/@", 
        RowBox[{"RInvRules", "[", 
         RowBox[{"6", ",", "case", ",", "dim"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"6", ",", "case_"}], "]"}], ":=", 
   RowBox[{"DualRInvs", "[", 
    RowBox[{"6", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualRInvs", "[", 
    RowBox[{"6", ",", "case_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualRInvs", "[", 
      RowBox[{"6", ",", "case", ",", "dim"}], "]"}], ",", 
     RowBox[{"DualRInvs", "[", 
      RowBox[{"5", ",", "case", ",", "dim"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Higher degrees:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"6", ",", "case_List"}], "]"}], ":=", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"6", ",", "case", ",", "$DefaultDim"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RInvRules", "[", 
    RowBox[{"6", ",", "case_List", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "sigma", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MaxIndex", "[", "case", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Reading InvRules for step 6, case \>\"", ",", "case", ",", 
          "\"\< and dimension \>\"", ",", "dim"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"ReadInvarRules", "[", 
          RowBox[{
           RowBox[{"$DataBaseDir", "<>", "\"\<6_\>\"", "<>", 
            RowBox[{"ToString", "[", "dim", "]"}], "<>", "\"\</\>\"", "<>", 
            RowBox[{"filename", "[", 
             RowBox[{"6", ",", "case", ",", "dim"}], "]"}]}], ",", 
           "\"\<Mathematica\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ProtSet", "[", 
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"6", ",", "case", ",", "dim"}], "]"}], ",", "result"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]}], "Input",
 
 InitializationCell->True]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numbers", "Subsection"],

Cell[CellGroupData[{

Cell["Diagonals 1 to 5", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"memory", "=", 
  RowBox[{"MemoryInUse", "[", "]"}]}]], "Input"],

Cell[BoxData["64762768"], "Output"]
}, Open  ]],

Cell["Read first five diagonals:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$DefaultDim", "=", "4"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"RInvs", "[", 
     RowBox[{"step", ",", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", "case", "]"}], "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"step", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"case", ",", "34"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {6}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 1, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 6}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 5}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {2, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {3, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {8}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 0, 0, 0}, " and dimension ",
    4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 1, 1, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 1, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {6}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 1, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 6}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 5}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {2, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {3, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {8}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 0, 0, 0}, " and dimension ",
    4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 0, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 1, 1, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 1, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "3", ",", "2", ",", "9", ",", "12", ",", "12", ",", "12", ",", 
     "38", ",", "99", ",", "125", ",", "126", ",", "138", ",", "86", ",", 
     "105", ",", "204", ",", "1020", ",", "1749", ",", "1473", ",", "3099", 
     ",", "1622", ",", "1617", ",", "1665", ",", "1770", ",", "1746", ",", 
     "962", ",", "1155", ",", "1613", ",", "12722", ",", "27022", ",", 
     "19617", ",", "60984", ",", "30974", ",", "62465", ",", "5606"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "2", ",", "5", ",", "9", ",", "9", ",", "11", ",", 
     "15", ",", "48", ",", "63", ",", "84", ",", "95", ",", "59", ",", "90", 
     ",", "54", ",", "313", ",", "564", ",", "648", ",", "1387", ",", "727", 
     ",", "741", ",", "1025", ",", "1115", ",", "1093", ",", "612", ",", 
     "945", ",", "270", ",", "2495", ",", "5439", ",", "5622", ",", "17662", 
     ",", "9030", ",", "18272", ",", "1733"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "1", ",", "5", ",", "5", ",", "4", ",", "6", ",", 
     "15", ",", "27", ",", "23", ",", "47", ",", "32", ",", "23", ",", "50", 
     ",", "54", ",", "175", ",", "194", ",", "361", ",", "442", ",", "244", 
     ",", "143", ",", "570", ",", "362", ",", "356", ",", "211", ",", "525", 
     ",", "270", ",", "1371", ",", "1725", ",", "3094", ",", "5440", ",", 
     "2861", ",", "3226", ",", "210"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "1", ",", "5", ",", "3", ",", "4", ",", "1", ",", 
     "15", ",", "15", ",", "23", ",", "3", ",", "5", ",", "7", ",", "1", ",", 
     "54", ",", "79", ",", "194", ",", "17", ",", "53", ",", "46", ",", "67", 
     ",", "3", ",", "5", ",", "9", ",", "9", ",", "1", ",", "270", ",", "549",
      ",", "1725", ",", "99", ",", "577", ",", "445", ",", "1235", ",", 
     "210"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "1", ",", "3", ",", "3", ",", "4", ",", "1", ",", "4",
      ",", "10", ",", "17", ",", "3", ",", "5", ",", "7", ",", "1", ",", "5", 
     ",", "26", ",", "76", ",", "12", ",", "42", ",", "34", ",", "52", ",", 
     "3", ",", "5", ",", "9", ",", "9", ",", "1", ",", "8", ",", "66", ",", 
     "245", ",", "37", ",", "242", ",", "169", ",", "505", ",", "86"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "1", ",", "3", ",", "3", ",", "4", ",", "1", ",", "3",
      ",", "10", ",", "17", ",", "3", ",", "5", ",", "7", ",", "1", ",", "3", 
     ",", "25", ",", "74", ",", "12", ",", "42", ",", "34", ",", "52", ",", 
     "3", ",", "5", ",", "9", ",", "9", ",", "1", ",", "4", ",", "58", ",", 
     "228", ",", "36", ",", "240", ",", "165", ",", "503", ",", "83"}], 
    "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Range", "[", "34", "]"}], "]"}], "]"}], "}"}], ",", "%"}], 
    "]"}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", "0", "}"}], "1", "1", "1", "1", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "3", "2", "2", "2", "2", "2"},
     {
      RowBox[{"{", "2", "}"}], "2", "2", "1", "1", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "9", "5", "5", "5", "3", "3"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], "12", "9", "5", "3", "3", "3"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "12", "9", "4", "4", "4", "4"},
     {
      RowBox[{"{", "4", "}"}], "12", "11", "6", "1", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "38", "15", "15", 
      "15", "4", "3"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}], "99", "48", "27", "15", "10",
       "10"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], "125", "63", "23", "23", 
      "17", "17"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "4"}], "}"}], "126", "84", "47", "3", "3", "3"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], "138", "95", "32", "5", "5", "5"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], "86", "59", "23", "7", "7", "7"},
     {
      RowBox[{"{", "6", "}"}], "105", "90", "50", "1", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "204", 
      "54", "54", "54", "5", "3"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], "1020", "313", 
      "175", "79", "26", "25"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "1749", "564", 
      "194", "194", "76", "74"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "4"}], "}"}], "1473", "648", "361", "17", 
      "12", "12"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "3"}], "}"}], "3099", "1387", "442", "53", 
      "42", "42"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "2"}], "}"}], "1622", "727", "244", "46", 
      "34", "34"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "2"}], "}"}], "1617", "741", "143", "67", 
      "52", "52"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "6"}], "}"}], "1665", "1025", "570", "3", "3", "3"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], "1770", "1115", "362", "5", "5", "5"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], "1746", "1093", "356", "9", "9", "9"},
     {
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}], "962", "612", "211", "9", "9", "9"},
     {
      RowBox[{"{", "8", "}"}], "1155", "945", "525", "1", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       "1613", "270", "270", "270", "8", "4"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], "12722", 
      "2495", "1371", "549", "66", "58"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], "27022", 
      "5439", "1725", "1725", "245", "228"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], "19617", "5622", 
      "3094", "99", "37", "36"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], "60984", "17662", 
      "5440", "577", "242", "240"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], "30974", "9030", 
      "2861", "445", "169", "165"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "62465", "18272", 
      "3226", "1235", "505", "503"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "5606", "1733", 
      "210", "210", "86", "83"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024."}], "/", "1000"}]], "Input"],

Cell[BoxData["549.7006015625`"], "Output"]
}, Open  ]],

Cell["\<\
Reading the first five diagonals takes 50 Mbytes. With eight more cases from \
the sixth diagonal it takes 350 Mbytes.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"MemoryInUse", "[", "]"}], "-", "memory"}], ")"}], "/", 
   "1024."}], "/", "1000"}]], "Input"],

Cell[BoxData["486.4576953125`"], "Output"]
}, Open  ]],

Cell["\<\
Analysis of numbers for the first five diagonals:
\tThere are originally 18550 invariants at step 1.
\tWe have 9133 rules at step 2 in terms of 6673 of the 9717 free invariants \
at step 2.
\tWe have 5839 rules at step 3 in terms of 3801 of the 3878 free invariants \
at step 3.
\tWe have 3255 rules at step 4 in terms of 618 of the 623 free invariants at \
step 4.
\tWe have 287 rules at step 5 in terms of 308 of the 336 free invariants at \
step 5.
\tWe have 6 rules at step 6 in terms of 57 of the 330 free invariants at step \
6 and 6 free dual invariants.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "26", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["18850"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"2", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "26", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["9717"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"3", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "26", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["3878"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"4", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "26", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["623"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"5", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "26", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["336"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"6", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "26", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["330"], "Output"]
}, Open  ]],

Cell["Check that all previous rules have been used:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "[", 
   RowBox[{"step_", ",", "cases_"}], "]"}], ":=", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"case", "=", 
      RowBox[{"cases", "[", 
       RowBox[{"[", "count", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"step", ",", "case"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"right", "=", 
      RowBox[{"Union", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Last", "/@", "rules"}], ",", 
         RowBox[{"RInv", "[", 
          RowBox[{"_", ",", "_"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inters", "=", 
      RowBox[{"Intersection", "[", 
       RowBox[{"right", ",", "knowns"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inters", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<There are \>\"", ",", 
         RowBox[{"Length", "[", "inters", "]"}], ",", 
         "\"\< rules to use in case \>\"", ",", "case"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Checked case \>\"", ",", "case"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"knowns", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"knowns", ",", 
        RowBox[{"First", "/@", "rules"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"count", ",", "1", ",", 
      RowBox[{"Length", "[", "cases", "]"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"knowns", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"],

Cell["These are the cases to check:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cases", "=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "34", "]"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", "48", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "8", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"2", ",", "cases"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"3", ",", "cases"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"4", ",", "cases"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"5", ",", "cases"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0, 0, 0, 0, 0}, 
   " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"6", ",", "cases"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0, 0, 0, 0, 0}, 
   " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["254735"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1000."}], "/", "1024"}]], "Input"],

Cell[BoxData["826.452484375`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Diagonal 6 non-expanded", "Subsubsection"],

Cell["Now we read the sixth diagonal (Commute non-expanded):", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"RInvs", "[", 
     RowBox[{"step", ",", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", "case", "]"}], "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"step", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"case", ",", "35", ",", "47"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 6}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 1, 5}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 2, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 1, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 3, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 2, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {2, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 8}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 7}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {2, 6}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {3, 5}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {4, 4}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {10}, " and dimension ", 4],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "25590", ",", "53160", ",", "52764", ",", "27396", ",", "27024", ",", 
     "54654", ",", "9104", ",", "25515", ",", "26670", ",", "26460", ",", 
     "26670", ",", "13607", ",", "15120"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "10600", ",", "22330", ",", "22063", ",", "11695", ",", "11402", ",", 
     "23255", ",", "3879", ",", "14910", ",", "15855", ",", "15675", ",", 
     "15855", ",", "8111", ",", "11970"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5840", ",", "6938", ",", "6861", ",", "2121", ",", "3597", ",", "4204", 
     ",", "715", ",", "8225", ",", "5000", ",", "4950", ",", "5000", ",", 
     "2615", ",", "6615"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "17", ",", "55", ",", "93", ",", "83", ",", "68", ",", "212", ",", "66", 
     ",", "3", ",", "5", ",", "9", ",", "11", ",", "12", ",", "1"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "12", ",", "44", ",", "72", ",", "66", ",", "53", ",", "171", ",", "49", 
     ",", "3", ",", "5", ",", "9", ",", "11", ",", "12", ",", "1"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Range", "[", 
         RowBox[{"35", ",", "47"}], "]"}], "]"}], "]"}], "}"}], ",", "%"}], 
    "]"}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "6"}], "}"}], "25590", "10600", "5840", 
      "17", "12"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "5"}], "}"}], "53160", "22330", "6938", 
      "55", "44"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "4"}], "}"}], "52764", "22063", "6861", 
      "93", "72"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], "27396", "11695", "2121", 
      "83", "66"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], "27024", "11402", "3597", 
      "68", "53"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], "54654", "23255", "4204", 
      "212", "171"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "2"}], "}"}], "9104", "3879", "715", "66", 
      "49"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "8"}], "}"}], "25515", "14910", "8225", "3", "3"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "7"}], "}"}], "26670", "15855", "5000", "5", "5"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], "26460", "15675", "4950", "9", "9"},
     {
      RowBox[{"{", 
       RowBox[{"3", ",", "5"}], "}"}], "26670", "15855", "5000", "11", "11"},
     {
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}], "13607", "8111", "2615", "12", "12"},
     {
      RowBox[{"{", "10", "}"}], "15120", "11970", "6615", "1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024."}], "/", "1000"}]], "Input"],

Cell[BoxData["3481.2755781250003`"], "Output"]
}, Open  ]],

Cell["\<\
Analysis of numbers for the first six diagonals:
\tThere are originally 623587 invariants at step 1.
\tWe have 365747 rules at step 2 in terms of 212119 of the 257840 free \
invariants at step 2.
\tWe have 169204 rules at step 3 in terms of 84409 of the 84756 free \
invariants at step 3.
\tWe have ? rules at step 4 in terms of ? of the 6368 free invariants at step \
4.
\tWe have ? rules at step 5 in terms of 2129 of the 2202 free invariants at \
step 5.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["623587"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"2", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["257840"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"2", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"InvarCases", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"RInv", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData["212119"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"3", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["84756"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"3", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"InvarCases", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"RInv", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData["84409"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"4", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["6368"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"5", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["2202"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"5", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"InvarCases", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"RInv", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData["2129"], "Output"]
}, Open  ]],

Cell["Checks (now we include the algebraic degree 7 case):", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"knowns", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"2", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Checked case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["380640"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"3", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Checked case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["553724"], "Output"]
}, Open  ]],

Cell["The sixth diagonal is not expanded:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"4", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "39502", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["There are ", 39502, " rules to use in case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "33821", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["There are ", 33821, " rules to use in case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "21143", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["There are ", 21143, " rules to use in case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "7043", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["There are ", 7043, " rules to use in case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "10293", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["There are ", 10293, " rules to use in case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "9974", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["There are ", 9974, " rules to use in case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "1373", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["There are ", 1373, " rules to use in case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "82507", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["There are ", 82507, " rules to use in case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "38993", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["There are ", 38993, " rules to use in case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "29313", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["There are ", 29313, " rules to use in case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "22786", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["There are ", 22786, " rules to use in case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "11727", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["There are ", 11727, " rules to use in case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"There are \"\>", "\[InvisibleSpace]", "70808", 
   "\[InvisibleSpace]", "\<\" rules to use in case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["There are ", 70808, " rules to use in case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["632112"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"5", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Checked case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["637910"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024."}], "/", "1000"}]], "Input"],

Cell[BoxData["4564.822453125`"], "Output"]
}, Open  ]],

Cell["Numbers for the abstract:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[BoxData["640119"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"DualRInvs", "[", 
      RowBox[{"1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["7698"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"2", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"InvarCases", "[", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData["380640"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dr2", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"2", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["5876"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r3", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"3", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"InvarCases", "[", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData["173084"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dr3", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"3", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["962"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r4", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"4", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"InvarCases", "[", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData["78388"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dr4", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"4", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["391"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r5", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"RInvRules", "[", 
       RowBox[{"5", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"InvarCases", "[", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData["5798"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dr5", "=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"5", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{
     RowBox[{"InvarCases", "[", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["435"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"allnonduals", ",", "allduals", ",", 
   RowBox[{"allnonduals", "+", "allduals"}], ",", 
   RowBox[{"r2", "+", "r3", "+", "r4", "+", "r5", "+", "51"}], ",", 
   RowBox[{"dr2", "+", "dr3", "+", "dr4", "+", "dr5"}], ",", 
   RowBox[{
   "r2", "+", "r3", "+", "r4", "+", "r5", "+", "51", "+", "dr2", "+", "dr3", 
    "+", "dr4", "+", "dr5"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "640119", ",", "7698", ",", "647817", ",", "637961", ",", "7664", ",", 
   "645625"}], "}"}]], "Output"]
}, Open  ]],

Cell["Number of independent invariants:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allnonduals", "-", 
  RowBox[{"(", 
   RowBox[{"r2", "+", "r3", "+", "r4", "+", "r5"}], ")"}]}]], "Input"],

Cell[BoxData["2209"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "-", "51"}]], "Input"],

Cell[BoxData["2158"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allduals", "-", 
  RowBox[{"(", 
   RowBox[{"dr2", "+", "dr3", "+", "dr4", "+", "dr5"}], ")"}]}]], "Input"],

Cell[BoxData["34"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Diagonal 6 expanded", "Subsubsection"],

Cell["Now we read the sixth diagonal (Commute expanded):", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ExpandedCommuteOrder12Q", "=", "True"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"RInvs", "[", 
     RowBox[{"step", ",", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", "case", "]"}], "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"step", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"case", ",", "35", ",", "47"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {10}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MemoryInUse", "[", "]"}]], "Input"],

Cell[BoxData["6639425120"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Range", "[", 
         RowBox[{"35", ",", "47"}], "]"}], "]"}], "]"}], "}"}], ",", "%"}], 
    "]"}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       "1613", "270", "270", "270", "8"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], "12722", 
      "2495", "1371", "549", "66"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], "27022", 
      "5439", "1725", "1725", "245"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], "19617", "5622", 
      "3094", "99", "37"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], "60984", "17662", 
      "5440", "577", "242"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], "30974", "9030", 
      "2861", "445", "169"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "62465", "18272", 
      "3226", "1235", "505"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "5606", "1733", 
      "210", "210", "86"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "6"}], "}"}], "25590", "10600", "5840", 
      "17", "12"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "5"}], "}"}], "53160", "22330", "6938", 
      "55", "44"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "4"}], "}"}], "52764", "22063", "6861", 
      "93", "72"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], "27396", "11695", "2121", 
      "83", "66"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], "27024", "11402", "3597", 
      "68", "53"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], "54654", "23255", "4204", 
      "212", "171"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "2"}], "}"}], "9104", "3879", "715", "66", 
      "49"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "8"}], "}"}], "25515", "14910", "8225", "3", "3"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "7"}], "}"}], "26670", "15855", "5000", "5", "5"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], "26460", "15675", "4950", "9", "9"},
     {
      RowBox[{"{", 
       RowBox[{"3", ",", "5"}], "}"}], "26670", "15855", "5000", "11", "11"},
     {
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}], "13607", "8111", "2615", "12", "12"},
     {
      RowBox[{"{", "10", "}"}], "15120", "11970", "6615", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], "16532", "1639", "1639", "1639", "7"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024."}], "/", "1000"}]], "Input"],

Cell[BoxData["2413.5582890625`"], "Output"]
}, Open  ]],

Cell["\<\
Analysis of numbers for the first six diagonals, only steps 2 and 3:
\tThere are originally 623587 invariants at step 1.
\tWe have 365747 rules at step 2 in terms of 212119 of the 257840 free \
invariants at step 2.
\tWe have 169204 rules at step 3 in terms of 84409 of the 84756 free \
invariants at step 3.
\tWe have ? rules at step 4 in terms of ? of the 6368 free invariants at step \
4.
\tWe have ? rules at step 5 in terms of 2129 of the 2202 free invariants at \
step 5.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["623587"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"2", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["257840"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"2", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"InvarCases", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"RInv", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData["212119"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"3", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["84756"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"3", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"InvarCases", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"RInv", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData["84409"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"4", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["6368"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"5", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["2202"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Union", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RInvRules", "[", 
           RowBox[{"5", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"InvarCases", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "47", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"RInv", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData["2129"], "Output"]
}, Open  ]],

Cell["Checks (now we include the algebraic degree 7 case):", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"knowns", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"2", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Checked case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["380640"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"3", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Checked case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["553724"], "Output"]
}, Open  ]],

Cell["The sixth diagonal is now expanded:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"4", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["632112"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"5", ",", 
   RowBox[{"InvarCases", "[", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Checked case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Checked case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Checked case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Checked case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Checked case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Checked case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["637910"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024."}], "/", "1000"}]], "Input"],

Cell[BoxData["6496.03225`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dual invariants", "Subsubsection"],

Cell["Now read dual invariants:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dualtable", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"DualRInvs", "[", 
      RowBox[{"step", ",", 
       RowBox[{
        RowBox[{"InvarCases", "[", "]"}], "[", 
        RowBox[{"[", "case", "]"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"step", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"case", ",", "15"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "4", ",", "3", ",", "27", ",", "58", ",", "36", ",", "32", ",", 
     "232", ",", "967", ",", "1047", ",", "876", ",", "920", ",", "478", ",", 
     "435", ",", "2582"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "6", ",", "13", ",", "9", ",", "11", ",", 
     "40", ",", "212", ",", "236", ",", "285", ",", "296", ",", "163", ",", 
     "220", ",", "330"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "6", ",", "5", ",", "2", ",", "4", ",", 
     "40", ",", "98", ",", "54", ",", "128", ",", "60", ",", "37", ",", "95", 
     ",", "330"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "6", ",", "1", ",", "2", ",", "0", ",", 
     "40", ",", "29", ",", "54", ",", "1", ",", "2", ",", "3", ",", "0", ",", 
     "330"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "2", ",", "1", ",", "2", ",", "0", ",", "1",
      ",", "6", ",", "13", ",", "1", ",", "2", ",", "3", ",", "0", ",", "2"}],
     "}"}]}], "}"}]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InvarCases", "[", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}], "}"}], ",", 
     "dualtable"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", "0", "}"}], "1", "0", "0", "0", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "4", "1", "1", "1", "1"},
     {
      RowBox[{"{", "2", "}"}], "3", "0", "0", "0", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "27", "6", "6", "6", "2"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], "58", "13", "5", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "36", "9", "2", "2", "2"},
     {
      RowBox[{"{", "4", "}"}], "32", "11", "4", "0", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "232", "40", "40", 
      "40", "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}], "967", "212", "98", "29", 
      "6"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], "1047", "236", "54", "54", 
      "13"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "4"}], "}"}], "876", "285", "128", "1", "1"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], "920", "296", "60", "2", "2"},
     {
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], "478", "163", "37", "3", "3"},
     {
      RowBox[{"{", "6", "}"}], "435", "220", "95", "0", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "2582", 
      "330", "330", "330", "2"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "/@", "dualtable"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7698", ",", "1822", ",", "860", ",", "469", ",", "34"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "[", "%", "]"}], "-", 
  RowBox[{"Last", "[", "%", "]"}]}]], "Input"],

Cell[BoxData["7664"], "Output"]
}, Open  ]],

Cell["There are 7664 relations for 7698 canonical dual invariants.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "]"}], "/", "1024"}], "/", "1000."}]], "Input"],

Cell[BoxData["445.9801484375`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "knowns", "]"}]], "Input"],

Cell[BoxData["254735"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkdual", "[", 
   RowBox[{"step_", ",", "cases_"}], "]"}], ":=", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"case", "=", 
      RowBox[{"cases", "[", 
       RowBox[{"[", "count", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"DualRInvRules", "[", 
       RowBox[{"step", ",", "case"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"right", "=", 
      RowBox[{"Union", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Last", "/@", "rules"}], ",", 
         RowBox[{
          RowBox[{"RInv", "[", 
           RowBox[{"_", ",", "_"}], "]"}], "|", 
          RowBox[{"DualRInv", "[", 
           RowBox[{"_", ",", "_"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inters", "=", 
      RowBox[{"Intersection", "[", 
       RowBox[{"right", ",", "knowns"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inters", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<There are \>\"", ",", "inters", ",", 
         "\"\< rules to use in case \>\"", ",", "case"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Checked case \>\"", ",", "case"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"knowns", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"knowns", ",", 
        RowBox[{"First", "/@", "rules"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"count", ",", "1", ",", 
      RowBox[{"Length", "[", "cases", "]"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkdual", "[", 
  RowBox[{"2", ",", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkdual", "[", 
  RowBox[{"3", ",", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkdual", "[", 
  RowBox[{"4", ",", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkdual", "[", 
  RowBox[{"5", ",", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Checked case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Checked case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Checked case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Checked case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Checked case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Checked case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Checked case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Checked case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Checked case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Checked case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Algebraic invariants", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"table", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"RInvs", "[", 
      RowBox[{"step", ",", "degree"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"step", ",", "1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "1", ",", "7"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "3", ",", "9", ",", "38", ",", "204", ",", "1613", ",", 
     "16532"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "5", ",", "15", ",", "54", ",", "270", ",", "1639"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "5", ",", "15", ",", "54", ",", "270", ",", "1639"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "5", ",", "15", ",", "54", ",", "270", ",", "1639"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "8", ",", "7"}],
     "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Transpose", "[", "table", "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "1", "1", "1", "1"},
    {"3", "2", "2", "2", "2"},
    {"9", "5", "5", "5", "3"},
    {"38", "15", "15", "15", "4"},
    {"204", "54", "54", "54", "5"},
    {"1613", "270", "270", "270", "8"},
    {"16532", "1639", "1639", "1639", "7"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "/@", "table"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18400", ",", "1986", ",", "1986", ",", "1986", ",", "30"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "[", "%", "]"}], "-", 
  RowBox[{"Last", "[", "%", "]"}]}]], "Input"],

Cell[BoxData["18370"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dualtable", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"DualRInvs", "[", 
      RowBox[{"step", ",", "degree"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"step", ",", "1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "1", ",", "5"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "27", ",", "232", ",", "2582"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "6", ",", "40", ",", "330"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "6", ",", "40", ",", "330"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "6", ",", "40", ",", "330"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "1", ",", "2"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Transpose", "[", "dualtable", "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "0", "0", "0", "0"},
    {"4", "1", "1", "1", "1"},
    {"27", "6", "6", "6", "2"},
    {"232", "40", "40", "40", "1"},
    {"2582", "330", "330", "330", "2"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "/@", "dualtable"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2846", ",", "377", ",", "377", ",", "377", ",", "6"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "[", "%", "]"}], "-", 
  RowBox[{"Last", "[", "%", "]"}]}]], "Input"],

Cell[BoxData["2840"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Number of canonical forms handled: ",
 StyleBox["21246",
  FontSize->18]
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"18400", "+", "2846"}]], "Input"],

Cell[BoxData["21246"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Number of independent objects: ",
 StyleBox["25",
  FontSize->18],
 ". Therefore we have ",
 StyleBox["21221",
  FontSize->18],
 " relations."
}], "Text"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl", "Subsection"],

Cell[CellGroupData[{

Cell["Riemann <-> Weyl conversion rules. INCOMPLETE. DEACTIVATED", \
"Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRToWRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchRToWRules", "[", 
     RowBox[{"step", ",", "case"}], "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"RToWRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchRToWDualRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchRToWDualRules", "[", 
     RowBox[{"step", ",", "case"}], "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"RToWDualRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchWToRRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchWToRRules", "[", 
     RowBox[{"step", ",", "case"}], "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"WToRRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchWToRDualRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchWToRDualRules", "[", 
     RowBox[{"step", ",", "case"}], "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"WToRDualRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 Evaluatable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fileread", "[", 
    RowBox[{"RToWRules", ",", "step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<RToW/RToW\>\"", ",", 
     RowBox[{"ToString", "[", "step", "]"}], ",", "\"\<_R\>\"", ",", 
     RowBox[{"ToString", "[", "case", "]"}], ",", "\"\<.mpl\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileread", "[", 
    RowBox[{"RToWDualRules", ",", "step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<RToW/RToW\>\"", ",", 
     RowBox[{"ToString", "[", "step", "]"}], ",", "\"\<_D\>\"", ",", 
     RowBox[{"ToString", "[", "case", "]"}], ",", "\"\<.mpl\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileread", "[", 
    RowBox[{"WToRRules", ",", "step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<WToR/WToR\>\"", ",", 
     RowBox[{"ToString", "[", "step", "]"}], ",", "\"\<_R\>\"", ",", 
     RowBox[{"ToString", "[", "case", "]"}], ",", "\"\<.mpl\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fileread", "[", 
    RowBox[{"WToRDualRules", ",", "step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<WToR/WToR\>\"", ",", 
     RowBox[{"ToString", "[", "step", "]"}], ",", "\"\<_D\>\"", ",", 
     RowBox[{"ToString", "[", "case", "]"}], ",", "\"\<.mpl\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"read", "[", 
   RowBox[{"file_", ",", "step_Integer", ",", "case_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Reading \>\"", ",", "file", ",", "\"\< for step \>\"", ",", "step",
        ",", "\"\< and case \>\"", ",", "case"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ReadInvarRules", "[", 
      RowBox[{
       RowBox[{"fileread", "[", 
        RowBox[{"file", ",", "step", ",", "case"}], "]"}], ",", 
       "\"\<Mathematica\>\""}], "]"}]}]}], "]"}]}]}], "Input",
 Evaluatable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RToWRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RToWRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"RToWRules", ",", "step", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RToWDualRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"RToWDualRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"RToWDualRules", ",", "step", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WToRRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"WToRRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"WToRRules", ",", "step", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WToRDualRules", "[", 
    RowBox[{"step_Integer", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"WToRDualRules", "[", 
      RowBox[{"step", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"WToRDualRules", ",", "step", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 Evaluatable->False]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl simplification: levels 3 and 4. INCOMPLETE. DEACTIVATED", \
"Subsubsection"],

Cell["These two files are still incomplete for degree 6 and 7:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DispatchWInvRules3", "[", "case_", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchWInvRules3", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"WInvRules", "[", 
      RowBox[{"3", ",", "case"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchDualWInvRules3", "[", "case_", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchDualWInvRules3", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"DualWInvRules", "[", 
      RowBox[{"3", ",", "case"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchWInvRules4", "[", "case_", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchWInvRules4", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"WInvRules", "[", 
      RowBox[{"4", ",", "case"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DispatchDualWInvRules4", "[", "case_", "]"}], ":=", 
   RowBox[{
    RowBox[{"DispatchDualWInvRules4", "[", "case", "]"}], "=", 
    RowBox[{"Dispatch", "[", 
     RowBox[{"DualWInvRules", "[", 
      RowBox[{"4", ",", "case"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 Evaluatable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fileread", "[", 
    RowBox[{"WInvRules", ",", "level_", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<Weyl/WInvar\>\"", ",", 
     RowBox[{"ToString", "[", "level", "]"}], ",", "\"\<_R\>\"", ",", 
     RowBox[{"ToString", "[", "case", "]"}], ",", "\"\<.mpl\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileread", "[", 
    RowBox[{"DualWInvRules", ",", "level_", ",", "case_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<Weyl/WInvar\>\"", ",", 
     RowBox[{"ToString", "[", "level", "]"}], ",", "\"\<_D\>\"", ",", 
     RowBox[{"ToString", "[", "case", "]"}], ",", "\"\<.mpl\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WInvRules", "[", 
    RowBox[{"3", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"WInvRules", "[", 
      RowBox[{"3", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"WInvRules", ",", "3", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInvRules", "[", 
    RowBox[{"3", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"DualWInvRules", "[", 
      RowBox[{"3", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"DualWInvRules", ",", "3", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WInvRules", "[", 
    RowBox[{"4", ",", "case_"}], "]"}], ":=", 
   RowBox[{"ProtSet", "[", 
    RowBox[{
     RowBox[{"WInvRules", "[", 
      RowBox[{"4", ",", "case"}], "]"}], ",", 
     RowBox[{"read", "[", 
      RowBox[{"WInvRules", ",", "4", ",", "case"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DualWInvRules", "[", 
    RowBox[{"4", ",", "case"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 Evaluatable->False]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The ten main functions", "Section"],

Cell[CellGroupData[{

Cell["InvSimplify", "Subsection"],

Cell["\<\
This function takes an expression containing RInv and DualRInv objects (or \
their Weyl counterparts) and simplify them to the level given by the user. \
Note that there is no use of permutations.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "InvSimplify"}]], "Input"],

Cell[BoxData["\<\"InvSimplify[expr, level] simplifies the invariants of the \
form inv[metric][case,count] in the expression expr, where inv is one of \
RInv, DualRInv, WInv, DualWInv. There are six possible levels of \
simplification: 1 means no simplification; 2 uses the cyclic identity; 3 uses \
the Bianchi identity; 4 commutes covariant derivatives; 5 uses dimensionally \
dependent (Lovelock type) identities and 6 reduces some non-dual invariants \
into products of dual invariants. The default level used in InvSimplify[expr] \
is $InvSimplifyLevel.\"\>"], "Print",
 CellTags->"Info3411227614-4799785"]
}, Open  ]],

Cell["\<\
User driver: conversion to InvSimplify1, which knows the dimension of the \
vbundle of the metric and already acts on a single invariant. Note that the \
most external function of InvSimplify is Expand, and not Simplify.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify", "[", "expr_", "]"}], ":=", 
   RowBox[{"InvSimplify", "[", 
    RowBox[{"expr", ",", "$InvSimplifyLevel"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify", "[", 
    RowBox[{"expr_", ",", "1"}], "]"}], ":=", "expr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify", "[", 
    RowBox[{"expr_", ",", "step_"}], "]"}], ":=", 
   RowBox[{"Expand", "[", 
    RowBox[{"expr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inv", ":", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}], 
           ")"}], "[", "metric_", "]"}], "[", 
         RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dim", "=", 
            RowBox[{"DimOfVBundle", "@", 
             RowBox[{"VBundleOfMetric", "@", "metric"}]}]}], ",", 
           RowBox[{"sigma", "=", 
            RowBox[{"SignDetOfMetric", "[", "metric", "]"}]}]}], "}"}], ",", 
         RowBox[{"InvSimplify1", "[", 
          RowBox[{"inv", ",", "step", ",", "dim"}], "]"}]}], "]"}]}], "}"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"InvSimplify", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
InvSimplify1 receives one invariant. Initial checks. If correct, move on to \
InvSimplify2.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify1", "[", 
    RowBox[{"inv_", ",", "1", ",", "_"}], "]"}], ":=", "inv"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify1", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"DualRInv", "|", "DualWInv"}], ")"}], "[", "_", "]"}], "[", 
      RowBox[{"_", ",", "_"}], "]"}], ",", "_", ",", "dim_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Duals are only handled in dimension 4.\>\"", "]"}], "/;", 
    RowBox[{"dim", "=!=", "4"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify1", "[", 
    RowBox[{"_", ",", 
     RowBox[{"5", "|", "6"}], ",", "dim_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
    "Print", "[", 
     "\"\<Levels 5 and 6 of simplication are only possible in dimension \
4.\>\"", "]"}], "/;", 
    RowBox[{"dim", "=!=", "4"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify1", "[", 
    RowBox[{
     RowBox[{"inv", ":", 
      RowBox[{
       RowBox[{"_", "[", "metric_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], ",", 
     RowBox[{"step", ":", 
      RowBox[{"(", 
       RowBox[{"2", "|", "3", "|", "4", "|", "5", "|", "6"}], ")"}]}], ",", 
     "dim_"}], "]"}], ":=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"InvSimplify56", "[", 
      RowBox[{
       RowBox[{"InvSimplify234", "[", 
        RowBox[{"inv", ",", "step"}], "]"}], ",", "step"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RInv", "\[Rule]", 
        RowBox[{"RInv", "[", "metric", "]"}]}], ",", 
       RowBox[{"DualRInv", "\[Rule]", 
        RowBox[{"DualRInv", "[", "metric", "]"}]}], ",", 
       RowBox[{"WInv", "\[Rule]", 
        RowBox[{"WInv", "[", "metric", "]"}]}], ",", 
       RowBox[{"DualWInv", "\[Rule]", 
        RowBox[{"DualWInv", "[", "metric", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify1", "[", 
    RowBox[{"inv_", ",", "step_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Invalid level of simplification: \>\"", ",", "step"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify234", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RInv", "[", "metric_", "]"}], "[", 
      RowBox[{"case_", ",", "count_"}], "]"}], ",", "step_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newexpr", "=", 
       RowBox[{"RInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"RInvs", "[", 
           RowBox[{"step", ",", "case"}], "]"}], ",", "newexpr"}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newexpr", "=", 
          RowBox[{"newexpr", "/.", 
           RowBox[{"DispatchRules", "[", 
            RowBox[{"RInv", ",", "2", ",", "case"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newexpr", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[GreaterEqual]", "3"}], ",", 
            RowBox[{"newexpr", "/.", 
             RowBox[{"DispatchRules", "[", 
              RowBox[{"RInv", ",", "3", ",", "case"}], "]"}]}], ",", 
            "newexpr"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newexpr", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[GreaterEqual]", "4"}], ",", 
            RowBox[{"newexpr", "/.", 
             RowBox[{"DispatchRules", "[", 
              RowBox[{"RInv", ",", "4", ",", "case"}], "]"}]}], ",", 
            "newexpr"}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "newexpr"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify234", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DualRInv", "[", "metric_", "]"}], "[", 
      RowBox[{"case_", ",", "count_"}], "]"}], ",", "step_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newexpr", "=", 
       RowBox[{"DualRInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"DualRInvs", "[", 
           RowBox[{"step", ",", "case"}], "]"}], ",", "newexpr"}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newexpr", "=", 
          RowBox[{"newexpr", "/.", 
           RowBox[{"DispatchRules", "[", 
            RowBox[{"DualRInv", ",", "2", ",", "case"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newexpr", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[GreaterEqual]", "3"}], ",", 
            RowBox[{"newexpr", "/.", 
             RowBox[{"DispatchRules", "[", 
              RowBox[{"DualRInv", ",", "3", ",", "case"}], "]"}]}], ",", 
            "newexpr"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newexpr", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[GreaterEqual]", "4"}], ",", 
            RowBox[{"newexpr", "/.", 
             RowBox[{"DispatchRules", "[", 
              RowBox[{"DualRInv", ",", "4", ",", "case"}], "]"}]}], ",", 
            "newexpr"}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "newexpr"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify234", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"WInv", "[", "metric_", "]"}], "[", 
      RowBox[{"case_", ",", "count_"}], "]"}], ",", "step_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"RInvs", "[", 
        RowBox[{"step", ",", "case"}], "]"}], ",", 
       RowBox[{"RInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"WInv", "[", 
      RowBox[{"case", ",", "count"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newexpr", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"RInv", "[", 
            RowBox[{"case", ",", "count"}], "]"}], "/.", 
           RowBox[{"DispatchRules", "[", 
            RowBox[{"RInv", ",", "2", ",", "case"}], "]"}]}], "/.", 
          RowBox[{"RInv", "\[Rule]", "WInv"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"step", "\[GreaterEqual]", "3"}], ",", 
           RowBox[{"newexpr", "/.", 
            RowBox[{"DispatchRules", "[", 
             RowBox[{"WInv", ",", "3", ",", "case"}], "]"}]}], ",", 
           "newexpr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"step", "\[GreaterEqual]", "4"}], ",", 
           RowBox[{"newexpr", "/.", 
            RowBox[{"DispatchRules", "[", 
             RowBox[{"WInv", ",", "4", ",", "case"}], "]"}]}], ",", 
           "newexpr"}], "]"}]}], ";", "\[IndentingNewLine]", "newexpr"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify234", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DualWInv", "[", "metric_", "]"}], "[", 
      RowBox[{"case_", ",", "count_"}], "]"}], ",", "step_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DualRInvs", "[", 
        RowBox[{"step", ",", "case"}], "]"}], ",", 
       RowBox[{"DualRInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DualWInv", "[", 
      RowBox[{"case", ",", "count"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newexpr", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DualRInv", "[", 
            RowBox[{"case", ",", "count"}], "]"}], "/.", 
           RowBox[{"DispatchRules", "[", 
            RowBox[{"DualRInv", ",", "2", ",", "case"}], "]"}]}], "/.", 
          RowBox[{"DualRInv", "\[Rule]", "DualWInv"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"step", "\[GreaterEqual]", "3"}], ",", 
           RowBox[{"newexpr", "/.", 
            RowBox[{"DispatchRules", "[", 
             RowBox[{"DualWInv", ",", "3", ",", "case"}], "]"}]}], ",", 
           "newexpr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"step", "\[GreaterEqual]", "4"}], ",", 
           RowBox[{"newexpr", "/.", 
            RowBox[{"DispatchRules", "[", 
             RowBox[{"DualWInv", ",", "4", ",", "case"}], "]"}]}], ",", 
           "newexpr"}], "]"}]}], ";", "\[IndentingNewLine]", "newexpr"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"RulesFor", "[", 
   RowBox[{
    RowBox[{"inv_", "[", 
     RowBox[{"case_", ",", "_"}], "]"}], ",", "step_"}], "]"}], ":=", 
  RowBox[{"DispatchRules", "[", 
   RowBox[{"inv", ",", "step", ",", "case", ",", "dim"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify56", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"step_", "/;", 
      RowBox[{"step", "<", "5"}]}]}], "]"}], ":=", "expr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify56", "[", 
    RowBox[{"expr_", ",", "5"}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"inv", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}], 
         ")"}], "[", 
        RowBox[{"case_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"inv", "/.", 
        RowBox[{"RulesFor", "[", 
         RowBox[{"inv", ",", "5"}], "]"}]}], ")"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvSimplify56", "[", 
    RowBox[{"expr_", ",", "6"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"InvSimplify56", "[", 
     RowBox[{"expr", ",", "5"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"inv", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RInv", "|", "WInv"}], ")"}], "[", 
        RowBox[{"case_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"inv", "/.", 
        RowBox[{"RulesFor", "[", 
         RowBox[{"inv", ",", "6"}], "]"}]}], ")"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["InvToPerm", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "InvToPerm"}]], "Input"],

Cell[BoxData["\<\"InvToPerm[expr] converts all invariants in expr into their \
corresponding permutations with head RPerm or WPerm.\"\>"], "Print",
 CellTags->"Info3411227615-8565162"]
}, Open  ]],

Cell["\<\
With the Canon permutations we need to use the Cycles notation.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toCycles", "[", 
    RowBox[{"cycles", ":", 
     RowBox[{"{", "___List", "}"}]}], "]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Cycles", ",", "cycles"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["Focus InvToPerm on single invariants:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvToPerm", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"inv", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}], 
         ")"}], "[", "_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"InvToPerm", "[", "inv", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToPerm", "[", 
    RowBox[{
     RowBox[{"RInv", "[", "metric_", "]"}], "[", 
     RowBox[{"case_", ",", "count_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RPerm", "[", "metric", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"case", ",", "0"}], "}"}], ",", 
     RowBox[{"toCycles", "[", 
      RowBox[{
       RowBox[{"RInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}], "/.", 
       RowBox[{"DispatchRInvToPermRules", "[", "case", "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToPerm", "[", 
    RowBox[{
     RowBox[{"DualRInv", "[", "metric_", "]"}], "[", 
     RowBox[{"case_", ",", "count_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RPerm", "[", "metric", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"case", ",", "1"}], "}"}], ",", 
     RowBox[{"toCycles", "[", 
      RowBox[{
       RowBox[{"DualRInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}], "/.", 
       RowBox[{"DispatchDualRInvToPermRules", "[", "case", "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToPerm", "[", 
    RowBox[{
     RowBox[{"WInv", "[", "metric_", "]"}], "[", 
     RowBox[{"case_", ",", "count_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"WPerm", "[", "metric", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"case", ",", "0"}], "}"}], ",", 
     RowBox[{"toCycles", "[", 
      RowBox[{
       RowBox[{"RInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}], "/.", 
       RowBox[{"DispatchRInvToPermRules", "[", "case", "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToPerm", "[", 
    RowBox[{
     RowBox[{"DualWInv", "[", "metric_", "]"}], "[", 
     RowBox[{"case_", ",", "count_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"WPerm", "[", "metric", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"case", ",", "1"}], "}"}], ",", 
     RowBox[{"toCycles", "[", 
      RowBox[{
       RowBox[{"DualRInv", "[", 
        RowBox[{"case", ",", "count"}], "]"}], "/.", 
       RowBox[{"DispatchDualRInvToPermRules", "[", "case", "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"InvToPerm", ",", "1"}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
There is nothing to decide in this function. All invariants will be converted \
into permutations, unless the degree and index supplied is incorrect.\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["PermToRiemann", "Subsection"],

Cell["\<\
We need to introduce indices. This is done through these two auxiliary \
functions. Note that they are defined with remembered values, and so they are \
computed just once. We specify 2*9 because that is the most complicated case \
we shall need:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"upindices", "[", "metric_", "]"}], ":=", 
   RowBox[{
    RowBox[{"upindices", "[", "metric", "]"}], "=", 
    RowBox[{"GetIndicesOfVBundle", "[", 
     RowBox[{
      RowBox[{"VBundleOfMetric", "[", "metric", "]"}], ",", "18"}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canon", "[", "metric_", "]"}], ":=", 
   RowBox[{
    RowBox[{"canon", "[", "metric", "]"}], "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"upindices", "[", "metric", "]"}], ",", 
        RowBox[{"Minus", "/@", 
         RowBox[{"upindices", "[", "metric", "]"}]}]}], "}"}], "]"}]}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "PermToRiemann"}]], "Input"],

Cell[BoxData["\<\"PermToRiemann[expr, cr] converts all permutations into \
their explicit tensor expressions. With cr=True contracted Riemann tensors \
are replaced by Ricci tensors. The default value used in PermToRiemann[expr] \
is $CurvatureRelations.\"\>"], "Print",
 CellTags->"Info3411227616-4472405"]
}, Open  ]],

Cell["\<\
Any permutation can be converted into a Riemann expression using \
PermToRiemann. The first point is translating the permutation into Images \
notation:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"translate", "[", 
    RowBox[{
     RowBox[{"RPerm", "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"case_", ",", "dege_"}], "}"}], ",", "perm_"}], "]"}], "]"}], ":=", 
   RowBox[{"First", "@", 
    RowBox[{"TranslatePerm", "[", 
     RowBox[{"perm", ",", 
      RowBox[{"{", 
       RowBox[{"Images", ",", 
        RowBox[{
         RowBox[{"4", 
          RowBox[{"Length", "[", "case", "]"}]}], "+", 
         RowBox[{"Plus", "@@", "case"}], "+", 
         RowBox[{"4", "dege"}]}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RPerm", "[", "metric_", "]"}], "[", 
    RowBox[{"info_", ",", 
     RowBox[{"-", "perm_"}]}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"RPerm", "[", "metric", "]"}], "[", 
     RowBox[{"info", ",", "perm"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WPerm", "[", "metric_", "]"}], "[", 
    RowBox[{"info_", ",", 
     RowBox[{"-", "perm_"}]}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"WPerm", "[", "metric", "]"}], "[", 
     RowBox[{"info", ",", "perm"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
We construct a function which transforms a given permutation into a Riemann \
(or Weyl) expression:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"riemannof", "[", 
    RowBox[{"metric_", ",", "0", ",", "indices_", ",", 
     RowBox[{"{", 
      RowBox[{"other___", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CD", "=", 
       RowBox[{"CovDOfMetric", "[", "metric", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Composition", ",", 
         RowBox[{"CD", "/@", 
          RowBox[{"indices", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"4", "+", "n"}], ",", "5", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{"Riemann", "[", "CD", "]"}], ",", 
         RowBox[{"Take", "[", 
          RowBox[{"indices", ",", "4"}], "]"}]}], "]"}], "]"}], 
      RowBox[{"riemannof", "[", 
       RowBox[{"metric", ",", "0", ",", 
        RowBox[{"Drop", "[", 
         RowBox[{"indices", ",", 
          RowBox[{"4", "+", "n"}]}], "]"}], ",", 
        RowBox[{"{", "other", "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"riemannof", "[", 
    RowBox[{"metric_", ",", "1", ",", "indices_", ",", "case_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"riemannof", "[", 
     RowBox[{"metric", ",", "0", ",", 
      RowBox[{"Drop", "[", 
       RowBox[{"indices", ",", 
        RowBox[{"-", "4"}]}], "]"}], ",", "case"}], "]"}], 
    RowBox[{"Apply", "[", 
     RowBox[{
      RowBox[{"epsilon", "[", "metric", "]"}], ",", 
      RowBox[{"Take", "[", 
       RowBox[{"indices", ",", 
        RowBox[{"-", "4"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"riemannof", "[", 
    RowBox[{"_", ",", "_", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", "1"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PermToRiemann", "[", "rperm_", "]"}], ":=", 
    RowBox[{"PermToRiemann", "[", 
     RowBox[{"rperm", ",", "$CurvatureRelations"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"On", " ", "Riemann", " ", "permutations"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PermToRiemann", "[", 
     RowBox[{
      RowBox[{"rperm", ":", 
       RowBox[{
        RowBox[{"RPerm", "[", "metric_", "]"}], "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"case_", ",", "dege_"}], "}"}], ",", "_"}], "]"}]}], ",", 
      "cr_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ToRicci", "[", 
      RowBox[{"metric", ",", "cr"}], "]"}], "[", 
     RowBox[{"riemannof", "[", 
      RowBox[{"metric", ",", "dege", ",", 
       RowBox[{
        RowBox[{"canon", "[", "metric", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"translate", "[", "rperm", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Reverse", "[", "case", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"On", " ", "Weyl", " ", "permutations"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PermToRiemann", "[", 
     RowBox[{
      RowBox[{"wperm", ":", 
       RowBox[{
        RowBox[{"WPerm", "[", "metric_", "]"}], "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "_"}], "]"}]}], ",", "_"}], 
     "]"}], ":=", 
    RowBox[{"ToWeyl", "[", 
     RowBox[{
      RowBox[{"PermToRiemann", "[", 
       RowBox[{
        RowBox[{"wperm", "/.", 
         RowBox[{"WPerm", "\[Rule]", "RPerm"}]}], ",", "True"}], "]"}], ",", 
      RowBox[{"CovDOfMetric", "[", "metric", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"On", " ", "general", " ", "expressions"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToRiemann", "[", 
    RowBox[{"expr_", ",", "cr_"}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"perm", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RPerm", "|", "WPerm"}], ")"}], "[", "_", "]"}], "[", "__", 
       "]"}]}], "\[RuleDelayed]", 
     RowBox[{"PermToRiemann", "[", 
      RowBox[{"perm", ",", "cr"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"PermToRiemann", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
It is returned with canon indices, not with dollar-indices. That is why we \
need to wrap it with Scalar. There is a second argument in PermToRiemman to \
specify whether the contracted Riemann must be replaced by Ricci:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToRicci", "[", 
     RowBox[{"metric_", ",", "False"}], "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{"Scalar", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToRicci", "[", 
     RowBox[{"metric_", ",", "True"}], "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{"Scalar", "@", 
    RowBox[{"ReplaceDummies", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ContractMetric", "[", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{"CurvatureRelations", "[", 
           RowBox[{
            RowBox[{"CovDOfMetric", "[", "metric", "]"}], ",", "Riemann"}], 
           "]"}]}], ",", "metric"}], "]"}], "/.", 
       RowBox[{"CurvatureRelations", "[", 
        RowBox[{
         RowBox[{"CovDOfMetric", "[", "metric", "]"}], ",", "Ricci"}], 
        "]"}]}], ",", 
      RowBox[{"IndexList", "@@", 
       RowBox[{"upindices", "[", "metric", "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToWeyl", "[", 
    RowBox[{"expr_", ",", "cd_"}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Riemann", "[", "cd", "]"}], "\[RuleDelayed]", 
       RowBox[{"Weyl", "[", "cd", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ricci", "[", "cd", "]"}], "\[RuleDelayed]", 
       RowBox[{"TFRicci", "[", "cd", "]"}]}]}], "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Only cr (True or False, with default True) needs to be decided in this \
function.\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["InvToRiemann", "Subsection"],

Cell["\<\
The invariant Inv[metric][n,m] is converted into a Riemann expression using \
the function InvToRiemann1:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvToRiemann1", "[", "cr_", "]"}], "[", 
    RowBox[{"inv", ":", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}], 
        ")"}], "[", "_", "]"}], "[", 
      RowBox[{"_", ",", "_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"PermToRiemann", "[", 
    RowBox[{
     RowBox[{"InvToPerm", "[", "inv", "]"}], ",", "cr"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
This intermediate function is in charge of detecting these very frequent \
cases:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvToRiemann1", "[", "False", "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"RInv", "|", "WInv"}], ")"}], "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], "]"}], ":=", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     RowBox[{"Riemann", "[", 
      RowBox[{"CovDOfMetric", "[", "metric", "]"}], "]"}], "@@", 
     RowBox[{
      RowBox[{"canon", "[", "metric", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], "]"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvToRiemann1", "[", "True", "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"RInv", "|", "WInv"}], ")"}], "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RicciScalar", "[", 
     RowBox[{"CovDOfMetric", "[", "metric", "]"}], "]"}], "[", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Main translation function. Note that there is no ToCanonical. We assume that \
the permutations of the invariants have been already canonicalized:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "InvToRiemann"}]], "Input"],

Cell[BoxData["\<\"InvToRiemann[expr, cr] converts all invariants into their \
explicit tensor expressions. With cr=True contracted Riemann tensors are \
replaced by Ricci tensors. The default value used in InvToRiemann[expr] is \
$CurvatureRelations.\"\>"], "Print",
 CellTags->"Info3411227617-3523154"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InvToRiemann", "[", "expr_", "]"}], ":=", 
   RowBox[{"InvToRiemann", "[", 
    RowBox[{"expr", ",", "$CurvatureRelations"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvToRiemann", "[", 
    RowBox[{"expr_", ",", "cr_"}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"inv", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}], 
         ")"}], "[", "_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"InvToRiemann1", "[", "cr", "]"}], "[", "inv", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"InvToRiemann", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["RiemannToPerm", "Subsection"],

Cell["\<\
Given any **monomial** Riemann expression, we need to know the degree of that \
expression in terms of Riemann's and Ricci's, and the degree in terms of \
epsilons. Note that the three objects are given by the metric:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"addone", "[", 
    RowBox[{"head_", "[", "n_Integer", "]"}], "]"}], ":=", 
   RowBox[{"head", "[", 
    RowBox[{"n", "+", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addone", "[", 
    RowBox[{"casePlus", "[", 
     RowBox[{"{", 
      RowBox[{"head_", ",", "n_Integer"}], "}"}], "]"}], "]"}], ":=", 
   RowBox[{"casePlus", "[", 
    RowBox[{"{", 
     RowBox[{"head", ",", 
      RowBox[{"n", "+", "1"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"casePlus", ",", 
   RowBox[{"{", 
    RowBox[{"Flat", ",", "Orderless"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"casePlus", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"head_", ",", "n__"}], "}"}], ",", "c___", ",", 
     RowBox[{"{", 
      RowBox[{"head_", ",", "m__"}], "}"}]}], "]"}], ":=", 
   RowBox[{"casePlus", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"head", ",", "m", ",", "n"}], "}"}], ",", "c"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"casePlus", "[", 
    RowBox[{"0", ",", "c___"}], "]"}], ":=", 
   RowBox[{"casePlus", "[", "c", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"casePlus", "[", "ERROR", "]"}], ":=", "ERROR"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"casePlus", "[", 
    RowBox[{"ERROR", ",", "__"}], "]"}], ":=", "ERROR"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"casePlus", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Ricci", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Riemann", ",", "6"}], "}"}], ",", "0", ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"Riemann", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Riemann", ",", "4"}], "}"}], ",", 
   RowBox[{"casePlus", "[", 
    RowBox[{
     RowBox[{"casePlus", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Ricci", ",", "3"}], "}"}], ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"Riemann", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Weyl", ",", "5"}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"casePlus", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Weyl", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Ricci", ",", "3", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Riemann", ",", "1", ",", "2", ",", "4", ",", "6"}], "}"}]}], 
  "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"degrees", "[", 
   RowBox[{"expr_", ",", "cd_", ",", "metric_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"riemann", "=", 
       RowBox[{"Riemann", "[", "cd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ricci", "=", 
       RowBox[{"Ricci", "[", "cd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ricciscalar", "=", 
       RowBox[{"RicciScalar", "[", "cd", "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"weyl", "=", 
       RowBox[{"Weyl", "[", "cd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"tfricci", "=", 
       RowBox[{"TFRicci", "[", "cd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"eps", "=", 
       RowBox[{"epsilon", "[", "metric", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "deg", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cd", "[", "_", "]"}], "[", "expr1_", "]"}], "x_."}], 
         "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"addone", "[", 
           RowBox[{"deg", "[", "expr1", "]"}], "]"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"_riemann", " ", "x_."}], "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Riemann", ",", "0"}], "}"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"_ricci", " ", "x_."}], "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Ricci", ",", "0"}], "}"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"_ricciscalar", " ", "x_."}], "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"RicciScalar", ",", "0"}], "}"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"_weyl", " ", "x_."}], "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Weyl", ",", "0"}], "}"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"_tfricci", " ", "x_."}], "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TFRicci", ",", "0"}], "}"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"_eps", " ", "x_."}], "]"}], ":=", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"epsilon", ",", "0"}], "}"}], ",", 
          RowBox[{"deg", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"1", "|", 
          RowBox[{"-", "1"}]}], "]"}], ":=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deg", "[", "x_", "]"}], ":=", "Infinity"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deg", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
The function is essentially based on the use sowing of the new list of \
indices by ToCanonical (this was its GivePerm option before xTensor 1.1.0). \
We need the function RiemannToPerm1 to avoid using PutScalar several times, \
which would be time-consuming. In this case we need to separate the action on \
the different metrics which have been defined and therefore this function \
does need a metric argument. It is a different question whether we make this \
feature public or not. October 2011: We have added a wrapping ContractMetric \
to fix cases like metric[a,b]Ricci[-a,-b] or metric[a,b]Riemann[-a,-c,-b,c].\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"First", " ", "expand"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm", "[", 
      RowBox[{"expr_", ",", "args___"}], "]"}], ":=", 
     RowBox[{"RiemannToPerm0", "[", 
      RowBox[{
       RowBox[{"ContractMetric", "@", 
        RowBox[{"Expand", "[", "expr", "]"}]}], ",", "args"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetNumberOfArguments", "[", 
     RowBox[{"RiemannToPerm", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{"Thread", " ", "over", " ", "sums"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm0", "[", 
      RowBox[{"expr_Plus", ",", "args___"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"RiemannToPerm0", "[", 
        RowBox[{"#", ",", "args"}], "]"}], "&"}], "/@", "expr"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm0", "[", 
      RowBox[{"expr_", ",", "args___"}], "]"}], ":=", 
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{
       RowBox[{"BreakScalars", "@", 
        RowBox[{"PutScalar", "[", "expr", "]"}]}], ",", "args"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Deal", " ", "with", " ", "the", " ", "second", " ", "argument"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", "expr_", "]"}], ":=", 
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{"expr", ",", "$Metrics"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{"expr_", ",", "metrics_List"}], "]"}], ":=", 
     RowBox[{"Fold", "[", 
      RowBox[{"RiemannToPerm1", ",", "expr", ",", "metrics"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Possibilities", " ", "for", " ", "the", " ", "first", " ", "argument"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{
       RowBox[{"Scalar", "[", "expr_", "]"}], ",", "metric_Symbol"}], "]"}], ":=", 
     RowBox[{"arrange", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"degrees", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"CovDOfMetric", "[", "metric", "]"}], ",", "metric"}], "]"}],
        ",", "metric"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{"expr_Times", ",", "metric_Symbol"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"RiemannToPerm1", "[", 
        RowBox[{"#", ",", "metric"}], "]"}], "&"}], "/@", "expr"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{
       RowBox[{"tensor_Symbol", "[", "]"}], ",", "metric_Symbol"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"RPerm", "[", "metric", "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"xAct`xPerm`Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "/;", 
      RowBox[{"tensor", "===", 
       RowBox[{"RicciScalar", "[", 
        RowBox[{"CovDOfMetric", "[", "metric", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"expr_", ",", "n_Integer"}], "]"}], ",", "metric_Symbol"}], 
      "]"}], ":=", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"RiemannToPerm1", "[", 
        RowBox[{"expr", ",", "metric"}], "]"}], ",", "n"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannToPerm1", "[", 
      RowBox[{"expr_", ",", "x_"}], "]"}], ":=", "expr"}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Note that the RicciScalar is always converted into RInv[metric][{0},1] and \
never into WInv[metric][{0},1]. This additional step must be done by the \
user. The function arrange always receives a monomial.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.", " ", "Trivial", " ", "cases"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"arrange", "[", 
      RowBox[{"0", ",", "_", ",", "_"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"arrange", "[", 
      RowBox[{"expr_", ",", "Infinity", ",", "_"}], "]"}], ":=", "expr"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1.", " ", "There", " ", "is", " ", "Ricci", " ", "or", " ", 
     RowBox[{"RicciScalar", ":", " ", 
      RowBox[{"convert", " ", "to", " ", "Riemann"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"arrange", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Ricci", "|", "RicciScalar"}], ",", "m__"}], "}"}], ",", 
          "c___"}], "]"}], ",", "metric_"}], "]"}], "]"}], ":=", 
     RowBox[{"arrange", "[", 
      RowBox[{
       RowBox[{"RicciToRiemann", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"CovDOfMetric", "[", "metric", "]"}]}], "]"}], ",", 
       RowBox[{"casePlus", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Riemann", ",", "m"}], "}"}], ",", "c"}], "]"}], ",", 
       "metric"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"2", 
     RowBox[{"a", ".", " ", "There"}], " ", "are", " ", "only", " ", 
     RowBox[{"Riemanns", ":", " ", 
      RowBox[{
       RowBox[{"compute", " ", "non"}], "-", 
       RowBox[{"dual", " ", "permutation"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"arrange", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"casePlus", "[", 
         RowBox[{"{", 
          RowBox[{"Riemann", ",", "Rcase__"}], "}"}], "]"}], ",", "metric_"}],
        "]"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"canonical", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], 
           "&"}], "@", 
          RowBox[{"Reap", "[", 
           RowBox[{
            RowBox[{"ToCanonical", "[", "expr", "]"}], ",", 
            "\"\<NewIndices\>\""}], "]"}]}]}], "}"}], ",", 
       RowBox[{"arrange1", "[", 
        RowBox[{"canonical", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"{", "Rcase", "}"}], "]"}], ",", "0"}], "}"}], ",", 
         "metric"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"2", 
     RowBox[{"b", ".", " ", "There"}], " ", "are", " ", "only", " ", 
     "Riemanns", " ", "and", " ", "an", " ", "epsilon", " ", 
     RowBox[{"tensor", ":", " ", 
      RowBox[{"compute", " ", "dual", " ", 
       RowBox[{"permutation", ".", " ", "Oct"}], " ", "2011"}], ":", " ", 
      RowBox[{
      "epsilon", " ", "must", " ", "be", " ", "sorted", " ", "last"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"arrange", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"casePlus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Riemann", ",", "Rcase__"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"epsilon", ",", "0"}], "}"}]}], "]"}], ",", "metric_"}], 
       "]"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"epsilonname", "=", 
         RowBox[{"epsilon", "[", "metric", "]"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TagSet", "[", 
           RowBox[{"epsilonname", ",", 
            RowBox[{"xSortPrecedence", "[", "epsilonname", "]"}], ",", 
            "Infinity"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"canonical", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], 
                "&"}], "@", 
               RowBox[{"Reap", "[", 
                RowBox[{
                 RowBox[{"ToCanonical", "[", "expr", "]"}], ",", 
                 "\"\<NewIndices\>\""}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"result", "=", 
             RowBox[{"arrange1", "[", 
              RowBox[{"canonical", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sort", "[", 
                  RowBox[{"{", "Rcase", "}"}], "]"}], ",", "1"}], "}"}], ",", 
               "metric"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TagUnset", "[", 
           RowBox[{"epsilonname", ",", 
            RowBox[{"xSortPrecedence", "[", "epsilonname", "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"3.", " ", "There", " ", "are", " ", 
     RowBox[{"Weyl", "/", "TFRicci"}], " ", 
     RowBox[{"only", ":", " ", 
      RowBox[{"convert", " ", "to", " ", 
       RowBox[{"Riemann", ".", " ", "NOT"}], " ", "UPDATED"}]}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"arrange", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "degWeyl_", ",", "degTFRic_", ",", "degeps_"}], 
        "}"}], ",", "metric_"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cd", "=", 
         RowBox[{"CovDOfMetric", "[", "metric", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"arrange", "[", 
         RowBox[{
          RowBox[{"ToRiemann", "[", 
           RowBox[{
            RowBox[{"FromWeyl", "[", 
             RowBox[{"expr", ",", "cd"}], "]"}], ",", "cd", ",", "metric"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"degWeyl", "+", "degTFRic"}], ",", "0", ",", "0", ",", 
            "0", ",", "degeps"}], "}"}], ",", "metric"}], "]"}], "/.", 
        RowBox[{"RPerm", "\[Rule]", "WPerm"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"4.", " ", "Final", " ", "arrangements"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"arrange1", "[", 
      RowBox[{"0", ",", "_", ",", "_"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"arrange1", "[", 
      RowBox[{
       RowBox[{"_Symbol", "[", 
        RowBox[{"a_", ",", "b_", ",", 
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"-", "b_"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", "0"}], "}"}], ",", "metric_"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{"RPerm", "[", "metric", "]"}], "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", "0"}], "}"}], ",", 
       RowBox[{"xAct`xPerm`Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"arrange1", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"expr_", ",", 
         RowBox[{"{", 
          RowBox[{"sign_", ",", "perm_IndexList"}], "}"}]}], "}"}], ",", 
       RowBox[{"degs", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], ",", "metric_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RPerm", "[", "metric", "]"}], "[", 
      RowBox[{"degs", ",", 
       RowBox[{"sign", " ", 
        RowBox[{"TranslatePerm", "[", 
         RowBox[{
          RowBox[{"PermutationFromTo", "[", 
           RowBox[{
            RowBox[{"List", "@@", "perm"}], ",", 
            RowBox[{"List", "@@", 
             RowBox[{"IndexSort", "[", "perm", "]"}]}]}], "]"}], ",", 
          "xAct`xPerm`Cycles"}], "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell["\<\
The function FromWeyl changes temporarily the heads WeylCD and TRicciCD by \
RiemannCD and RicciCD respectively. This is a trick to avoid duplicated code.\
\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FromWeyl", "[", 
    RowBox[{"expr_", ",", "cd_"}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Weyl", "[", "cd", "]"}], "\[RuleDelayed]", 
       RowBox[{"Riemann", "[", "cd", "]"}]}], ",", 
      RowBox[{
       RowBox[{"TFRicci", "[", "cd", "]"}], "\[RuleDelayed]", 
       RowBox[{"Ricci", "[", "cd", "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
This function converts any Ricci tensor into its corresponding Riemann tensor \
(added $RicciSign in version 2.0.4, as pointed out by Teake):\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RicciToRiemann", "[", 
    RowBox[{"expr_", ",", "cd_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ricciscalar", "=", 
        RowBox[{"RicciScalar", "[", "cd", "]"}]}], ",", 
       RowBox[{"ricci", "=", 
        RowBox[{"Ricci", "[", "cd", "]"}]}], ",", 
       RowBox[{"riemann", "=", 
        RowBox[{"Riemann", "[", "cd", "]"}]}], ",", 
       RowBox[{"vbundle", "=", 
        RowBox[{"First", "@", 
         RowBox[{"VBundlesOfCovD", "[", "cd", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"expr", "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ricciscalar", "[", "]"}], "\[RuleDelayed]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"DummyIn", "@", "vbundle"}]}], ",", 
             RowBox[{"d", "=", 
              RowBox[{"DummyIn", "@", "vbundle"}]}]}], "}"}], ",", 
           RowBox[{"$RicciSign", " ", 
            RowBox[{"riemann", "[", 
             RowBox[{"c", ",", "d", ",", 
              RowBox[{"-", "c"}], ",", 
              RowBox[{"-", "d"}]}], "]"}]}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"ricci", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", "=", 
             RowBox[{"DummyIn", "@", "vbundle"}]}], "}"}], ",", 
           RowBox[{"$RicciSign", " ", 
            RowBox[{"riemann", "[", 
             RowBox[{"a", ",", 
              RowBox[{"-", "c"}], ",", "b", ",", "c"}], "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["PermToInv", "Subsection"],

Cell["\<\
Note also that these dispatched rules have no metric argument; it is added at \
the end. It is important to realize that right now this command will only \
work if the permutation is already in canonical form.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PermToInv", "[", 
    RowBox[{
     RowBox[{"RPerm", "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"case_", ",", "0"}], "}"}], ",", "perm_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"perm", "/.", 
     RowBox[{"DispatchPermToRInvRules", "[", "case", "]"}]}], "/.", 
    RowBox[{"RInv", "\[Rule]", 
     RowBox[{"RInv", "[", "metric", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToInv", "[", 
    RowBox[{
     RowBox[{"RPerm", "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"case_", ",", "1"}], "}"}], ",", "perm_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"perm", "/.", 
     RowBox[{"DispatchPermToDualRInvRules", "[", "case", "]"}]}], "/.", 
    RowBox[{"DualRInv", "\[Rule]", 
     RowBox[{"DualRInv", "[", "metric", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToInv", "[", 
    RowBox[{
     RowBox[{"WPerm", "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"case_", ",", "0"}], "}"}], ",", "perm_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"perm", "/.", 
     RowBox[{"DispatchPermToRInvRules", "[", "case", "]"}]}], "/.", 
    RowBox[{"RInv", "\[Rule]", 
     RowBox[{"WInv", "[", "metric", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToInv", "[", 
    RowBox[{
     RowBox[{"WPerm", "[", "metric_", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"case_", ",", "1"}], "}"}], ",", "perm_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"perm", "/.", 
     RowBox[{"DispatchPermToDualRInvRules", "[", "case", "]"}]}], "/.", 
    RowBox[{"DualRInv", "\[Rule]", 
     RowBox[{"DualWInv", "[", "metric", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermToInv", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"perm", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RPerm", "|", "WPerm"}], ")"}], "[", "_", "]"}], "[", "__", 
       "]"}]}], "\[RuleDelayed]", 
     RowBox[{"PermToInv", "[", "perm", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"PermToInv", ",", "1"}], "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["RiemannToInv", "Subsection"],

Cell["\<\
Main transformation function. It is just a combination of RiemannToPerm and \
PermToInv:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannToInv", "[", "expr_", "]"}], ":=", 
   RowBox[{"RiemannToInv", "[", 
    RowBox[{"expr", ",", "$Metrics"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannToInv", "[", 
    RowBox[{"expr_", ",", "metrics_List"}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{"RiemannToInv", ",", "expr", ",", "metrics"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannToInv", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"metric_Symbol", "?", "MetricQ"}]}], "]"}], ":=", 
   RowBox[{"PermToInv", "[", 
    RowBox[{"RiemannToPerm", "[", 
     RowBox[{"expr", ",", "metric"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannToInv", "[", 
    RowBox[{"expr_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"RiemannToInv", "::", "unknown"}], ",", 
       "\"\<metric or list of metrics\>\"", ",", "x"}], "]"}], ";", "expr"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"RiemannToInv", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["RiemannSimplify", "Subsection"],

Cell["\<\
This function requires two additional arguments: the level of simplification \
(to be passed to InvSimplify) and the metric argument (to be passed to \
RiemannToInv):\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RiemannSimplify"}]], "Input"],

Cell[BoxData["\<\"RiemannSimplify[expr, level, cr, g] simplifies the Riemann \
scalars of metric g using relations up to the given level (see usage message \
for InvSimplify). With cr=True contracted Riemann tensors are replaced by \
Ricci tensors. If g is a list of metrics then the command is folded over the \
list. RiemannSimplify[expr] uses the defaults $InvSimplifyLevel, \
$CurvatureRelations and $Metrics, respectively. See usage messages for those \
global variables.\"\>"], "Print",
 CellTags->"Info3411227618-8018884"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannSimplify", "[", "expr_", "]"}], ":=", 
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{
    "expr", ",", "$InvSimplifyLevel", ",", "$CurvatureRelations", ",", 
     "$Metrics"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{"expr_", ",", "step_Integer"}], "]"}], ":=", 
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{
    "expr", ",", "step", ",", "$CurvatureRelations", ",", "$Metrics"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"cr", ":", 
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{"expr", ",", "$InvSimplifyLevel", ",", "cr", ",", "$Metrics"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"metric", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_Symbol", "?", "MetricQ"}], "|", 
        RowBox[{"{", 
         RowBox[{"__Symbol", "?", "MetricQ"}], "}"}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{
    "expr", ",", "$InvSimplifyLevel", ",", "$CurvatureRelations", ",", 
     "metric"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannSimplify", "[", 
    RowBox[{"expr_", ",", "step_Integer", ",", 
     RowBox[{"cr", ":", 
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}]}], ",", "metric_"}], "]"}], ":=", 
   RowBox[{"InvToRiemann", "[", 
    RowBox[{
     RowBox[{"InvSimplify", "[", 
      RowBox[{
       RowBox[{"RiemannToInv", "[", 
        RowBox[{"expr", ",", "metric"}], "]"}], ",", "step"}], "]"}], ",", 
     "cr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"RiemannSimplify", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["RToW and WToR", "Subsection"],

Cell["\<\
Transformation between Riemann and Weyl invariants. Internal function:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RToWInv", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RInv", "[", "metric_", "]"}], "[", 
      RowBox[{"deg_", ",", "index_"}], "]"}], ",", "level_"}], "]"}], ":=", 
   RowBox[{"setdim", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RInv", "[", 
        RowBox[{"deg", ",", "index"}], "]"}], "/.", 
       RowBox[{"DispatchRToWRules", "[", 
        RowBox[{"level", ",", "deg"}], "]"}]}], "/.", 
      RowBox[{"WInv", "\[Rule]", 
       RowBox[{"WInv", "[", "metric", "]"}]}]}], ",", "metric"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RToWInv", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DualRInv", "[", "metric_", "]"}], "[", 
      RowBox[{"deg_", ",", "index_"}], "]"}], ",", "level_"}], "]"}], ":=", 
   RowBox[{"setdim", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"DualRInv", "[", 
        RowBox[{"deg", ",", "index"}], "]"}], "/.", 
       RowBox[{"DispatchRToWDualRules", "[", 
        RowBox[{"level", ",", "deg"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DualWInv", "\[Rule]", 
         RowBox[{"DualWInv", "[", "metric", "]"}]}], ",", 
        RowBox[{"WInv", "\[Rule]", 
         RowBox[{"WInv", "[", "metric", "]"}]}]}], "}"}]}], ",", "metric"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WToRInv", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"WInv", "[", "metric_", "]"}], "[", 
      RowBox[{"deg_", ",", "index_"}], "]"}], ",", "level_"}], "]"}], ":=", 
   RowBox[{"setdim", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"WInv", "[", 
        RowBox[{"deg", ",", "index"}], "]"}], "/.", 
       RowBox[{"DispatchWToRRules", "[", 
        RowBox[{"level", ",", "deg"}], "]"}]}], "/.", 
      RowBox[{"RInv", "\[Rule]", 
       RowBox[{"RInv", "[", "metric", "]"}]}]}], ",", "metric"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WToRInv", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DualWInv", "[", "metric_", "]"}], "[", 
      RowBox[{"deg_", ",", "index_"}], "]"}], ",", "level_"}], "]"}], ":=", 
   RowBox[{"setdim", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"DualWInv", "[", 
        RowBox[{"deg", ",", "index"}], "]"}], "/.", 
       RowBox[{"DispatchWToRDualRules", "[", 
        RowBox[{"level", ",", "deg"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DualRInv", "\[Rule]", 
         RowBox[{"DualRInv", "[", "metric", "]"}]}], ",", 
        RowBox[{"RInv", "\[Rule]", 
         RowBox[{"RInv", "[", "metric", "]"}]}]}], "}"}]}], ",", "metric"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\
Set correct dimension (replacing the constant symbol dim in the stored rules):\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setdim", "[", 
   RowBox[{"expr_", ",", "metric_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dimension", "=", 
      RowBox[{"DimOfVBundle", "@", 
       RowBox[{"VBundleOfMetric", "[", "metric", "]"}]}]}], "}"}], ",", 
    RowBox[{"expr", "/.", 
     RowBox[{"dim", "\[Rule]", "dimension"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell["User driver:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RToW"}]], "Input"],

Cell[BoxData["\<\"RToW[expr] transforms Riemann invariants into Weyl \
invariants in expression expr.\"\>"], "Print",
 CellTags->"Info3411227619-2362067"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "WToR"}]], "Input"],

Cell[BoxData["\<\"WToR[expr] transforms Weyl invariants into Riemann \
invariants in expression expr.\"\>"], "Print",
 CellTags->"Info3411227620-8562565"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RToW", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"level_:", "2"}]}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"inv", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RInv", "|", "DualRInv"}], ")"}], "[", "_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"RToWInv", "[", 
      RowBox[{"inv", ",", "level"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WToR", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"level_:", "2"}]}], "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"inv", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"WInv", "|", "DualWInv"}], ")"}], "[", "_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"WToRInv", "[", 
      RowBox[{"inv", ",", "level"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"RToW", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"WToR", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomRiemannMonomial", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomRiemannMonomial", "[", "case_", "]"}], ":=", 
   RowBox[{"RandomRiemannMonomial", "[", 
    RowBox[{"case", ",", 
     RowBox[{"First", "[", "$Metrics", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomRiemannMonomial", "[", 
    RowBox[{"degree_Integer", ",", "metric_"}], "]"}], ":=", 
   RowBox[{"RandomRiemannMonomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "degree", "}"}]}], "]"}], ",", "metric"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomRiemannMonomial", "[", 
    RowBox[{"case_List", ",", "metric_"}], "]"}], ":=", 
   RowBox[{"PermToRiemann", "[", 
    RowBox[{
     RowBox[{"RPerm", "[", "metric", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"case", ",", "0"}], "}"}], ",", 
      RowBox[{"RandomPerm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"4", 
          RowBox[{"Length", "@", "case"}]}], "+", 
         RowBox[{"Plus", "@@", "case"}]}], ",", "Images"}], "]"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"RandomRiemannMonomial", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["End package", "Subsection"],

Cell["End private part:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`Invar`Private`\"\>"], "Output"]
}, Open  ]],

Cell["\<\
We have defined these new names, and they are now all protected:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "\"\<xAct`Invar`*\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
The three user-global-variables and the constant-symbols dim, sigma must be \
unprotected:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{
   "xAct`Invar`dim", ",", "xAct`Invar`sigma", ",", 
    "xAct`Invar`$InvSimplifyLevel", ",", "xAct`Invar`$CurvatureRelations", 
    ",", "xAct`Invar`$ExpandedCommuteOrder12Q", ",", 
    "xAct`Invar`InvarDirectory"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsection"],

Cell[CellGroupData[{

Cell["Setup", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{
   RowBox[{"General", "::", "spell"}], ",", 
   RowBox[{"General", "::", "spell1"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefManifold", "[", 
  RowBox[{"M", ",", "4", ",", 
   RowBox[{"IndexRange", "[", 
    RowBox[{"a", ",", "q"}], "]"}], ",", "z"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefManifold", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"manifold \"\>", "\[InvisibleSpace]", "M", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefManifold, ": Defining ", "manifold ", M, ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefVBundle", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle \"\>", "\[InvisibleSpace]", "TangentM", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefVBundle, ": Defining ", "vbundle ", TangentM, ". ", ""],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefMetric", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"metric", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "CD", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<;\>\"", ",", "\"\<\[EmptyDownTriangle]\>\""}], "}"}], ",", 
   RowBox[{"CurvatureRelations", "\[Rule]", "False"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric metric tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"metric", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "symmetric metric tensor ", 
   metric[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric tensor \"\>", "\[InvisibleSpace]", 
   
   RowBox[{"epsilonmetric", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "antisymmetric tensor ", 
   epsilonmetric[a, b, c, d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"covariant derivative \"\>", "\[InvisibleSpace]", 
   
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefCovD, ": Defining ", "covariant derivative ", 
   CD[-a], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing torsion tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"TorsionCD", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "vanishing torsion tensor ", 
   TorsionCD[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"ChristoffelCD", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", DefTensor, ": Defining ", "symmetric Christoffel tensor ", 
   ChristoffelCD[a, -b, -c], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Riemann tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Riemann tensor ", 
   RiemannCD[-a, -b, -c, -d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"symmetric Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RicciCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "symmetric Ricci tensor ", 
   RicciCD[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Ricci scalar \"\>", "\[InvisibleSpace]", 
   RowBox[{"RicciScalarCD", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Ricci scalar ", 
   RicciScalarCD[], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Einstein tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"EinsteinCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Einstein tensor ", 
   EinsteinCD[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"Weyl tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"WeylCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "Weyl tensor ", 
   WeylCD[-a, -b, -c, -d], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"   Rules \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
     "8"}], "}"}], 
   "\[InvisibleSpace]", "\<\" have been declared as DownValues for \"\>", 
   "\[InvisibleSpace]", "WeylCD", "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm["   Rules ", 
   Shallow[{1, 2, 3, 4, 5, 6, 7, 8}], 
   " have been declared as DownValues for ", WeylCD, "."],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"TFRicci tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"TFRicciCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", DefTensor, ": Defining ", "TFRicci tensor ", 
   TFRicciCD[-a, -b], ". ", ""],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"   Rules \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" have been declared as DownValues for \"\>", 
   "\[InvisibleSpace]", "TFRicciCD", "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm["   Rules ", 
   Shallow[{1, 2}], " have been declared as DownValues for ", TFRicciCD, "."],
  
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** DefCovD:  Computing RiemannToWeylRules for dim \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm["** DefCovD:  Computing RiemannToWeylRules for dim ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** DefCovD:  Computing RicciToTFRicci for dim \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm["** DefCovD:  Computing RicciToTFRicci for dim ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** DefCovD:  Computing RicciToEinsteinRules for dim \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm["** DefCovD:  Computing RicciToEinsteinRules for dim ", 4],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RiemannCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RicciCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RicciScalarCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "epsilonmetric", "]"}], "^=", 
   "\"\<\[Epsilon]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "metric", "]"}], "^=", "\"\<g\>\""}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Special cases", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{"RicciScalarCD", "[", "]"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{
   RowBox[{"-", "3"}], 
   RowBox[{"RicciScalarCD", "[", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "3"}], " ", 
  SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{
   RowBox[{"-", "3"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", "a", ",", "b"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "3"}], " ", 
  SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{
   RowBox[{"-", "3"}], 
   RowBox[{
    RowBox[{"CD", "[", 
     RowBox[{"-", "a"}], "]"}], "@", 
    RowBox[{"RicciScalarCD", "[", "]"}]}], 
   RowBox[{
    RowBox[{"CD", "[", "a", "]"}], "@", 
    RowBox[{"RicciScalarCD", "[", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "3"}], " ", 
  SubscriptBox["\<\"I\"\>", "\<\"11,1\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{
   RowBox[{"-", "3"}], 
   RowBox[{
    RowBox[{"CD", "[", 
     RowBox[{"-", "a"}], "]"}], "@", 
    RowBox[{"RiemannCD", "[", 
     RowBox[{"b", ",", 
      RowBox[{"-", "c"}], ",", "c", ",", 
      RowBox[{"-", "b"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"CD", "[", "a", "]"}], "@", 
    RowBox[{"RicciScalarCD", "[", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"3", " ", 
  SubscriptBox["\<\"I\"\>", "\<\"11,1\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{
   RowBox[{"-", "3"}], 
   RowBox[{
    RowBox[{"CD", "[", 
     RowBox[{"-", "a"}], "]"}], "@", 
    RowBox[{"RiemannCD", "[", 
     RowBox[{"b", ",", 
      RowBox[{"-", "c"}], ",", "c", ",", 
      RowBox[{"-", "b"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"CD", "[", "a", "]"}], "@", 
    RowBox[{"RicciCD", "[", 
     RowBox[{"d", ",", 
      RowBox[{"-", "d"}]}], "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"3", " ", 
  SubscriptBox["\<\"I\"\>", "\<\"11,1\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", 
  RowBox[{
   RowBox[{"-", "3"}], 
   RowBox[{
    RowBox[{"CD", "[", 
     RowBox[{"-", "a"}], "]"}], "@", 
    RowBox[{"RiemannCD", "[", 
     RowBox[{"b", ",", 
      RowBox[{"-", "c"}], ",", "c", ",", 
      RowBox[{"-", "b"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"CD", "[", "a", "]"}], "@", 
    RowBox[{"RiemannCD", "[", 
     RowBox[{
      RowBox[{"-", "d"}], ",", 
      RowBox[{"-", "e"}], ",", "d", ",", "e"}], "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"3", " ", 
  SubscriptBox["\<\"I\"\>", "\<\"11,1\"\>"]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check of RiemannToInv", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkperms", "[", "case_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"riemanns", ",", "invs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"riemanns", "=", 
      RowBox[{"xAct`Invar`Private`ReadInvarPerms", "[", 
       RowBox[{
        RowBox[{"xAct`Invar`Private`$DataBaseDir", "<>", "\"\<0/\>\"", "<>", 
         RowBox[{"xAct`Invar`Private`filename", "[", 
          RowBox[{"0", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"invs", "=", 
         RowBox[{"RiemannToInv", "/@", "riemanns"}]}], "]"}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"invs", "/.", 
        RowBox[{
         RowBox[{"RInv", "[", "metric", "]"}], "\[Rule]", "RInv"}]}], ")"}], "===", 
      RowBox[{"RInvs", "[", 
       RowBox[{"1", ",", "case"}], "]"}]}]}]}], "]"}]}]], "Input"],

Cell["First diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "0", "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.004991`4.149732563362096", " ", "Second"}], ",", "1"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Second diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.131295`5.569793181019146", " ", "Second"}], ",", "3"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "2", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.117452`5.521405409940106", " ", "Second"}], ",", "2"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Third diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.154208`5.639651898117087", " ", "Second"}], ",", "9"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.276592`5.893384608148153", " ", "Second"}], ",", "12"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.182808`5.713540190800961", " ", "Second"}], ",", "12"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "4", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.241806`5.835012066425038", " ", "Second"}], ",", "12"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Fourth diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.005408`6.453887330069382", " ", "Second"}], ",", "38"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.057613`6.764908688621534", " ", "Second"}], ",", "99"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.553331`6.858652111533881", " ", "Second"}], ",", "125"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.349168`6.822459069815508", " ", "Second"}], ",", "126"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.498517`6.849227302239991", " ", "Second"}], ",", "138"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.690113`6.679460735763983", " ", "Second"}], ",", "86"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "6", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.708278`6.6841035413720835", " ", "Second"}], ",", "105"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Fifth diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"6.398637`7.257632466476654", " ", "Second"}], ",", "204"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"29.779126`7.925456940809133", " ", "Second"}], ",", "1020"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"52.523769`8.171900876129946", " ", "Second"}], ",", "1749"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"40.320767`8.057073778359515", " ", "Second"}], ",", "1473"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"78.180342`8.344642559418082", " ", "Second"}], ",", "3099"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"42.5302`8.080242418502307", " ", "Second"}], ",", "1622"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"41.360479`8.068130553220458", " ", "Second"}], ",", "1617"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "6"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"41.053926`8.064899688656835", " ", "Second"}], ",", "1665"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"42.440843`8.079328995177024", " ", "Second"}], ",", "1770"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"40.571427`8.05976527670749", " ", "Second"}], ",", "1746"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"23.348762`7.819808851810434", " ", "Second"}], ",", "962"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "8", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"24.544413`7.841497643543219", " ", "Second"}], ",", "1155"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Sixth diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"67.705513`8.28216902655332", " ", "Second"}], ",", "1613"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"556.176796`9.196757859398849", " ", "Second"}], ",", "12722"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1500.317586`9.627728193383835", " ", "Second"}], ",", "27022"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"918.764127`9.414749023390652", " ", "Second"}], ",", "19617"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4288.280804`10.083828209461192", " ", "Second"}], ",", "60984"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1641.026477`9.666660581692415", " ", "Second"}], ",", "30974"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4530.369857`10.107678652528072", " ", "Second"}], ",", "62465"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"215.617927`8.785229859813604", " ", "Second"}], ",", "5606"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "6"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1247.736608`9.54766791076151", " ", "Second"}], ",", "25590"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "5"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"3391.849248`9.98198153512999", " ", "Second"}], ",", "53160"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"3397.808827`9.982743933739831", " ", "Second"}], ",", "52764"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1365.574839`9.586860499710355", " ", "Second"}], ",", "27396"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "3", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1295.664256`9.564037471375517", " ", "Second"}], ",", "27024"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"3433.395039`9.987268768779453", " ", "Second"}], ",", "54654"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"325.672535`8.964326128171093", " ", "Second"}], ",", "9104"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "8"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1173.992029`9.521210141708194", " ", "Second"}], ",", "25515"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "7"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 7}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1038.752264`9.468056976850493", " ", "Second"}], ",", "26670"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "6"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1039.274087`9.4682750923273", " ", "Second"}], ",", "26460"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "5"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {3, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1044.221858`9.470337773262674", " ", "Second"}], ",", "26670"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {4, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"474.894716`9.128142330850553", " ", "Second"}], ",", "13607"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "10", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "10", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {10}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"526.007396`9.172536844150487", " ", "Second"}], ",", "15120"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Seventh diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
   "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1012.036507`9.456741172504382", " ", "Second"}], ",", "16532"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check of InvToRiemann", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData["$CurvatureRelations"], "Input"],

Cell[BoxData["False"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkperms", "[", "case_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"riemanns", ",", "frominvs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"riemanns", "=", 
      RowBox[{"Scalar", "/@", 
       RowBox[{"xAct`Invar`Private`ReadInvarPerms", "[", 
        RowBox[{
         RowBox[{
         "xAct`Invar`Private`$DataBaseDir", "<>", "\"\<0/\>\"", "<>", 
          RowBox[{"xAct`Invar`Private`filename", "[", 
           RowBox[{"0", ",", "case"}], "]"}]}], ",", "\"\<Mathematica\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"frominvs", "=", 
         RowBox[{"InvToRiemann", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RInvs", "[", 
             RowBox[{"1", ",", "case"}], "]"}], "/.", 
            RowBox[{"RInv", "\[Rule]", 
             RowBox[{"RInv", "[", "metric", "]"}]}]}], ")"}]}]}], "]"}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"riemanns", "===", "frominvs"}]}]}], "]"}]}]], "Input"],

Cell["First diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "0", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.046226`5.116431308455025", " ", "Second"}], ",", "1"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Second diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.038161`5.033164740261565", " ", "Second"}], ",", "3"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "2", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.041459`5.0691638161037975", " ", "Second"}], ",", "2"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Third diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.006556`4.268183938394429", " ", "Second"}], ",", "9"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.041422`5.068776057826317", " ", "Second"}], ",", "12"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.038412`5.036011913687731", " ", "Second"}], ",", "12"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "4", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.04161`5.070742709288924", " ", "Second"}], ",", "12"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Fourth diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.062751`5.249165644621502", " ", "Second"}], ",", "38"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.082681`5.368950714134532", " ", "Second"}], ",", "99"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.1019`5.459719177502392", " ", "Second"}], ",", "125"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.089094`5.401393451128445", " ", "Second"}], ",", "126"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.092355`5.41700540614314", " ", "Second"}], ",", "138"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.070083`5.29715767763145", " ", "Second"}], ",", "86"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "6", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.074415`5.323205479587842", " ", "Second"}], ",", "105"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Fifth diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.211114`5.776062027945935", " ", "Second"}], ",", "204"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.744608`6.323472691423454", " ", "Second"}], ",", "1020"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.238924`6.544589659522593", " ", "Second"}], ",", "1749"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.924189`6.417305788594333", " ", "Second"}], ",", "1473"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.772673`6.700173623404124", " ", "Second"}], ",", "3099"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.961906`6.434677627201219", " ", "Second"}], ",", "1622"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.951224`6.429827792777002", " ", "Second"}], ",", "1617"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "6"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.845635`6.378727943188322", " ", "Second"}], ",", "1665"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.878395`6.395234848517989", " ", "Second"}], ",", "1770"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.882233`6.397128292064027", " ", "Second"}], ",", "1746"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.554227`6.1952326727649645", " ", "Second"}], ",", "962"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "8", "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {8}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.506037`6.155727265885893", " ", "Second"}], ",", "1155"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Sixth diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.156364`6.785267066266811", " ", "Second"}], ",", "1613"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"12.301808`7.541513938001994", " ", "Second"}], ",", "12722"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"27.569132`7.891968086277682", " ", "Second"}], ",", "27022"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"14.880151`7.624152331838496", " ", "Second"}], ",", "19617"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"45.076325`8.105493494985383", " ", "Second"}], ",", "60984"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"24.140848`7.8342975150672585", " ", "Second"}], ",", "30974"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"47.944902`8.132287428757108", " ", "Second"}], ",", "62465"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4.424557`7.097414787832281", " ", "Second"}], ",", "5606"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "6"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 6}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"16.649409`7.6729438155668905", " ", "Second"}], ",", "25590"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "5"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 5}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"34.33199`7.987243970850384", " ", "Second"}], ",", "53160"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"33.53896`7.977094585061679", " ", "Second"}], ",", "52764"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"19.75139`7.747142657918598", " ", "Second"}], ",", "27396"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "3", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"18.36304`7.715489573734557", " ", "Second"}], ",", "27024"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"36.430667`8.013012116200072", " ", "Second"}], ",", "54654"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"5.950329`7.2260859724908055", " ", "Second"}], ",", "9104"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "8"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"14.888479`7.624395326194613", " ", "Second"}], ",", "25515"}], 
  "}"}]], "Print"]
}, Open  ]],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "7"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"13.322361`7.57612619118371", " ", "Second"}], ",", "26670"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "6"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"13.214404`7.572592573725842", " ", "Second"}], ",", "26460"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "5"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"13.18877`7.571749288123373", " ", "Second"}], ",", "26670"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"6.60293`7.271281686683739", " ", "Second"}], ",", "13607"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", "10", "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"6.162564`7.241306436077817", " ", "Second"}], ",", "15120"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["Seventh diagonal:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkperms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
   "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"33.193421`7.972597007726173", " ", "Second"}], ",", "16532"}], 
  "}"}]], "Print"],

Cell[BoxData["True"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The invariant in the paper", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"paperinv", "=", 
  RowBox[{
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], 
   RowBox[{
    RowBox[{"CD", "[", 
     RowBox[{"-", "e"}], "]"}], "@", 
    RowBox[{"RiemannCD", "[", 
     RowBox[{"e", ",", "c", ",", "f", ",", "g"}], "]"}]}], 
   RowBox[{
    RowBox[{"CD", "[", "a", "]"}], "@", 
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "f"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "h"}], "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{"b", ",", "d", ",", "h", ",", 
        RowBox[{"-", "g"}]}], "]"}]}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "abcd", "    "],
    AutoSpacing->False],
   RiemannCD[-a, -b, -c, -d],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"   ", 
      RowBox[{"g", ";", "h", ";", "f", "  "}]}], 
     RowBox[{"bdh", "     ", ";", "a"}]],
    AutoSpacing->False],
   CD[a][
    CD[-f][
     CD[-h][
      RiemannCD[b, d, h, -g]]]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"    ", 
      RowBox[{";", "e"}]}], 
     RowBox[{"ecfg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[e, c, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"canon", "=", 
  RowBox[{"ToCanonical", "[", "paperinv", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "    ", "abcd"],
     AutoSpacing->False],
    RiemannCD[a, b, c, d],
    Editable->False]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
     RowBox[{"   ", "h", "      "}]],
    AutoSpacing->False],
   CD[-d][
    CD[-g][
     CD[-h][
      RiemannCD[-b, -c, -f, h]]]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"a", "   ", ";", "e"}], 
     RowBox[{" ", "efg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[-a, e, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RiemannCD", "[", 
   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "e"}], "]"}], "@", 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}]}], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "f"}], ",", "h"}], "]"}]}]}]}]}], "+", 
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "b"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "g"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "h"}], "]"}], "@", 
       RowBox[{"RiemannCD", "[", 
        RowBox[{
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "d"}], ",", 
         RowBox[{"-", "f"}], ",", "h"}], "]"}]}]}]}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"cdf", " ", ";", "h", ";", "g", ";", "b"}], 
       RowBox[{"   ", "h", "      "}]],
      AutoSpacing->False],
     CD[-b][
      CD[-g][
       CD[-h][
        RiemannCD[-c, -d, -f, h]]]],
     Editable->False], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False]}]}], ")"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"a", "   ", ";", "e"}], 
     RowBox[{" ", "efg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[-a, e, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplification", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"cdf", " ", ";", "h", ";", "g", ";", "b"}], 
       RowBox[{"   ", "h", "      "}]],
      AutoSpacing->False],
     CD[-b][
      CD[-g][
       CD[-h][
        RiemannCD[-c, -d, -f, h]]]],
     Editable->False], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False]}]}], ")"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"a", "   ", ";", "e"}], 
     RowBox[{" ", "efg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[-a, e, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"]}], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2610\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RiemannCD", "[", 
   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "e"}], "]"}], "@", 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}]}], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "d"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "g"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "h"}], "]"}], "@", 
       RowBox[{"RiemannCD", "[", 
        RowBox[{
         RowBox[{"-", "b"}], ",", 
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "f"}], ",", "h"}], "]"}]}]}]}], "-", 
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "d"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "g"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "h"}], "]"}], "@", 
       RowBox[{"RiemannCD", "[", 
        RowBox[{
         RowBox[{"-", "b"}], ",", 
         RowBox[{"-", "f"}], ",", 
         RowBox[{"-", "c"}], ",", "h"}], "]"}]}]}]}], "+", 
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "d"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "g"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "h"}], "]"}], "@", 
       RowBox[{"RiemannCD", "[", 
        RowBox[{
         RowBox[{"-", "b"}], ",", "h", ",", 
         RowBox[{"-", "c"}], ",", 
         RowBox[{"-", "f"}]}], "]"}]}]}]}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
       RowBox[{"   ", "h", "      "}]],
      AutoSpacing->False],
     CD[-d][
      CD[-g][
       CD[-h][
        RiemannCD[-b, -c, -f, h]]]],
     Editable->False], "-", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"bfc", " ", ";", "h", ";", "g", ";", "d"}], 
       RowBox[{"   ", "h", "      "}]],
      AutoSpacing->False],
     CD[-d][
      CD[-g][
       CD[-h][
        RiemannCD[-b, -f, -c, h]]]],
     Editable->False], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{
        RowBox[{"b", " ", "cf"}], ";", "h", ";", "g", ";", "d"}], 
       RowBox[{" ", "h", "        "}]],
      AutoSpacing->False],
     CD[-d][
      CD[-g][
       CD[-h][
        RiemannCD[-b, h, -c, -f]]]],
     Editable->False]}], ")"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"a", "   ", ";", "e"}], 
     RowBox[{" ", "efg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[-a, e, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplification", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
       RowBox[{"   ", "h", "      "}]],
      AutoSpacing->False],
     CD[-d][
      CD[-g][
       CD[-h][
        RiemannCD[-b, -c, -f, h]]]],
     Editable->False], "-", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"bfc", " ", ";", "h", ";", "g", ";", "d"}], 
       RowBox[{"   ", "h", "      "}]],
      AutoSpacing->False],
     CD[-d][
      CD[-g][
       CD[-h][
        RiemannCD[-b, -f, -c, h]]]],
     Editable->False], "+", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{
        RowBox[{"b", " ", "cf"}], ";", "h", ";", "g", ";", "d"}], 
       RowBox[{" ", "h", "        "}]],
      AutoSpacing->False],
     CD[-d][
      CD[-g][
       CD[-h][
        RiemannCD[-b, h, -c, -f]]]],
     Editable->False]}], ")"}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"a", "   ", ";", "e"}], 
     RowBox[{" ", "efg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[-a, e, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2601\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2757\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RiemannCD", "[", 
   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "e"}], "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}]}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "f"}], ",", "h"}], "]"}]}]}]}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "f"}], "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}]}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "e"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "g"}], ",", "h"}], "]"}]}]}]}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "f"}], "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}]}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "e"}], ",", "h"}], "]"}]}]}]}]}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", "   ", ";", "e"}], 
        RowBox[{" ", "efg", "  "}]],
       AutoSpacing->False],
      CD[-e][
       RiemannCD[-a, e, f, g]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcg", " ", ";", "h", ";", "e", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-e][
        CD[-h][
         RiemannCD[-b, -c, -g, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", "   ", ";", "f"}], 
        RowBox[{" ", "efg", "  "}]],
       AutoSpacing->False],
      CD[-f][
       RiemannCD[-a, e, f, g]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bce", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -e, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", "   ", ";", "f"}], 
        RowBox[{" ", "efg", "  "}]],
       AutoSpacing->False],
      CD[-f][
       RiemannCD[-a, e, f, g]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplification", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", "   ", ";", "e"}], 
        RowBox[{" ", "efg", "  "}]],
       AutoSpacing->False],
      CD[-e][
       RiemannCD[-a, e, f, g]],
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["R", 
          RowBox[{"bcg", " ", ";", "h", ";", "e", ";", "d"}], 
          RowBox[{"   ", "h", "      "}]],
         AutoSpacing->False],
        CD[-d][
         CD[-e][
          CD[-h][
           RiemannCD[-b, -c, -g, h]]]],
        Editable->False], "-", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["R", 
          RowBox[{"bce", " ", ";", "h", ";", "g", ";", "d"}], 
          RowBox[{"   ", "h", "      "}]],
         AutoSpacing->False],
        CD[-d][
         CD[-g][
          CD[-h][
           RiemannCD[-b, -c, -e, h]]]],
        Editable->False]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", "   ", ";", "f"}], 
        RowBox[{" ", "efg", "  "}]],
       AutoSpacing->False],
      CD[-f][
       RiemannCD[-a, e, f, g]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2634\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2640\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RiemannCD", "[", 
   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "e"}], "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}]}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "f"}], ",", "h"}], "]"}]}]}]}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", "g", "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "e", ",", 
        RowBox[{"-", "e"}], ",", "f"}], "]"}]}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "f"}], ",", "h"}], "]"}]}]}]}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", "g", "]"}], "@", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "e", ",", 
        RowBox[{"-", "e"}], ",", "f"}], "]"}]}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "f"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "h"}], "]"}], "@", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "g"}], ",", "h"}], "]"}]}]}]}]}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", "   ", ";", "e"}], 
        RowBox[{" ", "efg", "  "}]],
       AutoSpacing->False],
      CD[-e][
       RiemannCD[-a, e, f, g]],
      Editable->False]}], "-", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcg", " ", ";", "h", ";", "f", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-f][
        CD[-h][
         RiemannCD[-b, -c, -g, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", " ", "e", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-a, e, -e, f]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", " ", "e", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-a, e, -e, f]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplification", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", "    ", "abcd"],
    AutoSpacing->False],
   RiemannCD[a, b, c, d],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       StyleBox[
        SubsuperscriptBox["R", 
         RowBox[{"bcg", " ", ";", "h", ";", "f", ";", "d"}], 
         RowBox[{"   ", "h", "      "}]],
        AutoSpacing->False],
       CD[-d][
        CD[-f][
         CD[-h][
          RiemannCD[-b, -c, -g, h]]]],
       Editable->False]}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", " ", "e", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-a, e, -e, f]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
        RowBox[{"   ", "h", "      "}]],
       AutoSpacing->False],
      CD[-d][
       CD[-g][
        CD[-h][
         RiemannCD[-b, -c, -f, h]]]],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["R", 
          RowBox[{"a", "   ", ";", "e"}], 
          RowBox[{" ", "efg", "  "}]],
         AutoSpacing->False],
        CD[-e][
         RiemannCD[-a, e, f, g]],
        Editable->False], "+", 
       InterpretationBox[
        StyleBox[
         SubsuperscriptBox["R", 
          RowBox[{"a", " ", "e", "   "}], 
          RowBox[{" ", 
           RowBox[{
            RowBox[{"e", " ", "f"}], ";", "g"}]}]],
         AutoSpacing->False],
        CD[g][
         RiemannCD[-a, e, -e, f]],
        Editable->False]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,1445\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,1451\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvSimplify", "[", 
  RowBox[{"%", ",", "2"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,1445\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,1451\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["canon"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "    ", "abcd"],
     AutoSpacing->False],
    RiemannCD[a, b, c, d],
    Editable->False]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"bcf", " ", ";", "h", ";", "g", ";", "d"}], 
     RowBox[{"   ", "h", "      "}]],
    AutoSpacing->False],
   CD[-d][
    CD[-g][
     CD[-h][
      RiemannCD[-b, -c, -f, h]]]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"a", "   ", ";", "e"}], 
     RowBox[{" ", "efg", "  "}]],
    AutoSpacing->False],
   CD[-e][
    RiemannCD[-a, e, f, g]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"canon", "-", 
   RowBox[{"CommuteCovDs", "[", 
    RowBox[{"canon", ",", "CD", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "h"}], ",", 
       RowBox[{"-", "g"}]}], "}"}]}], "]"}]}], "//", 
  "RiemannToInv"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,2593\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,694\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,827\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,1194\"\>"], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"I\"\>", "\<\"0011,1329\"\>"]}], "+", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"I\"\>", "\<\"0011,1331\"\>"]}], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,1745\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"InvSimplify", "[", 
   RowBox[{"%", ",", "3"}], "]"}], "//", "Expand"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,536\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,539\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,542\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,548\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,820\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,294\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,296\"\>"], "+", 
  FractionBox[
   SubscriptBox["\<\"I\"\>", "\<\"0011,363\"\>"], "2"], "+", 
  FractionBox[
   SubscriptBox["\<\"I\"\>", "\<\"0011,369\"\>"], "2"], "-", 
  FractionBox[
   SubscriptBox["\<\"I\"\>", "\<\"0011,775\"\>"], "2"], "+", 
  FractionBox[
   SubscriptBox["\<\"I\"\>", "\<\"0011,776\"\>"], "2"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,884\"\>"], "+", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"I\"\>", "\<\"0011,885\"\>"]}], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"I\"\>", "\<\"0011,918\"\>"]}], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,1008\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"InvSimplify", "[", 
   RowBox[{"%", ",", "4"}], "]"}], "//", "Expand"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"canon", "-", 
   RowBox[{"CommuteCovDs", "[", 
    RowBox[{"canon", ",", "CD", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "g"}], ",", 
       RowBox[{"-", "d"}]}], "}"}]}], "]"}]}], "//", 
  "RiemannToInv"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"013,2594\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,2595\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,1091\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,1216\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,1353\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"InvSimplify", "[", 
   RowBox[{"%", ",", "3"}], "]"}], "//", "Expand"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["\<\"I\"\>", "\<\"013,535\"\>"]}], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,536\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,538\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,539\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,541\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,542\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"013,547\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"013,548\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,385\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,386\"\>"], "-", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,394\"\>"], "+", 
  SubscriptBox["\<\"I\"\>", "\<\"0011,397\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"InvSimplify", "[", 
   RowBox[{"%", ",", "4"}], "]"}], "//", "Expand"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nice examples", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {1, 2, 3}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvToRiemann", "/@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"First", "/@", 
     RowBox[{"Cases", "[", 
      RowBox[{"rules", ",", 
       RowBox[{"HoldPattern", "[", 
        RowBox[{"_", "\[Rule]", "0"}], "]"}]}], "]"}]}], "/.", 
    RowBox[{"RInv", "\[Rule]", 
     RowBox[{"RInv", "[", "metric", "]"}]}]}], ")"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "a", ";", "b"}]}], 
        RowBox[{"fg", "      "}]],
       AutoSpacing->False],
      CD[-b][
       CD[-a][
        RiemannCD[f, g, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"hi", ";", "c", ";", "d", ";", "e"}]}], 
        RowBox[{"hi", "        "}]],
       AutoSpacing->False],
      CD[-e][
       CD[-d][
        CD[-c][
         RiemannCD[h, i, -h, -i]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bdgh", "  ", ";", "i", ";", "c"}], 
        RowBox[{"    ", 
         RowBox[{";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-c][
       CD[-i][
        CD[i][
         RiemannCD[-b, -d, -g, -h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "   "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d"}]],
       AutoSpacing->False],
      CD[d][
       RiemannCD[a, b, -a, c]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "ef", "    "}], 
        RowBox[{"ef", "  ", ";", "g", ";", "h"}]],
       AutoSpacing->False],
      CD[h][
       CD[g][
        RiemannCD[e, f, -e, -f]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "a", ";", "b"}]}], 
        RowBox[{"fg", "      "}]],
       AutoSpacing->False],
      CD[-b][
       CD[-a][
        RiemannCD[f, g, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "eh"}], ";", "d", "  ", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{"h", "    ", ";", "i", "  "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[i][
        CD[-d][
         RiemannCD[-c, h, -e, -h]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "a", ";", "b"}]}], 
        RowBox[{"fg", "      "}]],
       AutoSpacing->False],
      CD[-b][
       CD[-a][
        RiemannCD[f, g, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "eh"}], "  ", ";", "i", ";", "d"}], 
        RowBox[{" ", 
         RowBox[{"h", "  ", ";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-d][
       CD[-i][
        CD[i][
         RiemannCD[-c, h, -e, -h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"hi", ";", "c", ";", "d", ";", "e"}]}], 
        RowBox[{"hi", "        "}]],
       AutoSpacing->False],
      CD[-e][
       CD[-d][
        CD[-c][
         RiemannCD[h, i, -h, -i]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "a", ";", "b"}]}], 
        RowBox[{"fg", "      "}]],
       AutoSpacing->False],
      CD[-b][
       CD[-a][
        RiemannCD[f, g, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "h"}], " ", ";", "d", ";", "e", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{"h", " ", "i", "      "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[-e][
        CD[-d][
         RiemannCD[-c, h, -h, i]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bdgh", "  ", ";", "i", ";", "c"}], 
        RowBox[{"    ", 
         RowBox[{";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-c][
       CD[-i][
        CD[i][
         RiemannCD[-b, -d, -g, -h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "   "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d"}]],
       AutoSpacing->False],
      CD[d][
       RiemannCD[a, b, -a, c]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"e", "   ", ";", "f"}]}], 
        RowBox[{
         RowBox[{"ef", " ", "g"}], ";", "h", "  "}]],
       AutoSpacing->False],
      CD[-f][
       CD[h][
        RiemannCD[e, f, -e, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "eh"}], ";", "d", "  ", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{"h", "    ", ";", "i", "  "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[i][
        CD[-d][
         RiemannCD[-c, h, -e, -h]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "eh"}], "  ", ";", "i", ";", "d"}], 
        RowBox[{" ", 
         RowBox[{"h", "  ", ";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-d][
       CD[-i][
        CD[i][
         RiemannCD[-c, h, -e, -h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "h"}], " ", ";", "d", ";", "e", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{"h", " ", "i", "      "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[-e][
        CD[-d][
         RiemannCD[-c, h, -h, i]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "a", ";", "b"}]}], 
        RowBox[{"fg", "      "}]],
       AutoSpacing->False],
      CD[-b][
       CD[-a][
        RiemannCD[f, g, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cde", "   ", ";", "i", ";", "h"}], 
        RowBox[{"   ", 
         RowBox[{"h", ";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-h][
       CD[-i][
        CD[i][
         RiemannCD[-c, -d, -e, h]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cde", "   ", ";", "i", ";", "h"}], 
        RowBox[{"   ", 
         RowBox[{"h", ";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-h][
       CD[-i][
        CD[i][
         RiemannCD[-c, -d, -e, h]]]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$CommuteCovDsOnScalars", "=", "True"}], "}"}], ",", 
   RowBox[{"ToCanonical", "[", "%", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bdgh", "  ", ";", "i", ";", "c"}], 
        RowBox[{"    ", 
         RowBox[{";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-c][
       CD[-i][
        CD[i][
         RiemannCD[-b, -d, -g, -h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "   "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d"}]],
       AutoSpacing->False],
      CD[d][
       RiemannCD[a, b, -a, c]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"e", "   ", ";", "f"}]}], 
        RowBox[{
         RowBox[{"ef", " ", "g"}], ";", "h", "  "}]],
       AutoSpacing->False],
      CD[-f][
       CD[h][
        RiemannCD[e, f, -e, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "eh"}], ";", "d", "  ", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{"h", "    ", ";", "i", "  "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[i][
        CD[-d][
         RiemannCD[-c, h, -e, -h]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "eh"}], "  ", ";", "i", ";", "d"}], 
        RowBox[{" ", 
         RowBox[{"h", "  ", ";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-d][
       CD[-i][
        CD[i][
         RiemannCD[-c, h, -e, -h]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "h"}], " ", ";", "d", ";", "e", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{"h", " ", "i", "      "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[-e][
        CD[-d][
         RiemannCD[-c, h, -h, i]]]],
      Editable->False]}], "]"}], ",", "0", ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "g"}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g", "    "}]}]],
       AutoSpacing->False],
      CD[-g][
       CD[-b][
        RiemannCD[-a, f, -f, g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cde", "   ", ";", "i", ";", "h"}], 
        RowBox[{"   ", 
         RowBox[{"h", ";", "i", "    "}]}]],
       AutoSpacing->False],
      CD[-h][
       CD[-i][
        CD[i][
         RiemannCD[-c, -d, -e, h]]]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"RInvRules", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2, 2, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulesb", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"rules", ",", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{
       RowBox[{"RInv", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", "_"}], "]"}], 
       "\[Rule]", 
       RowBox[{"_", " ", 
        RowBox[{"RInv", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", "_"}], "]"}]}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{"Denominator", "/@", 
    RowBox[{"Last", "/@", "rulesb"}]}], ",", "8"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "57", "}"}], ",", 
   RowBox[{"{", "62", "}"}], ",", 
   RowBox[{"{", "133", "}"}], ",", 
   RowBox[{"{", "389", "}"}], ",", 
   RowBox[{"{", "439", "}"}], ",", 
   RowBox[{"{", "440", "}"}], ",", 
   RowBox[{"{", "441", "}"}], ",", 
   RowBox[{"{", "444", "}"}], ",", 
   RowBox[{"{", "446", "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"rules", ",", 
   RowBox[{"rulesb", "[", 
    RowBox[{"[", "446", "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "2868", "}"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Scalar", "[", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"      ", 
        RowBox[{";", "a"}]}], 
       RowBox[{"abcd", ";", "e", "  "}]],
      AutoSpacing->False],
     CD[-a][
      CD[e][
       RiemannCD[a, b, c, d]]],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"cfgi", ";", "d", ";", "h"}], "        "],
      AutoSpacing->False],
     CD[-h][
      CD[-d][
       RiemannCD[-c, -f, -g, -i]]],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"be", "      "}], 
       RowBox[{"  ", 
        RowBox[{"fg", ";", "h", ";", "i"}]}]],
      AutoSpacing->False],
     CD[i][
      CD[h][
       RiemannCD[-b, -e, f, g]]],
     Editable->False]}], "]"}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"      ", 
         RowBox[{";", "e"}]}], 
        RowBox[{"abcd", ";", "e", "  "}]],
       AutoSpacing->False],
      CD[-e][
       CD[e][
        RiemannCD[a, b, c, d]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cdfg", ";", "i", ";", "h"}], "        "],
       AutoSpacing->False],
      CD[-h][
       CD[-i][
        RiemannCD[-c, -d, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"ab", "      "}], 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "h", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       CD[h][
        RiemannCD[-a, -b, f, g]]],
      Editable->False]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "8"]}], " ", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"      ", 
         RowBox[{";", "e"}]}], 
        RowBox[{"abcd", ";", "e", "  "}]],
       AutoSpacing->False],
      CD[-e][
       CD[e][
        RiemannCD[a, b, c, d]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cdfg", ";", "i", ";", "h"}], "        "],
       AutoSpacing->False],
      CD[-h][
       CD[-i][
        RiemannCD[-c, -d, -f, -g]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"ab", "      "}], 
        RowBox[{"  ", 
         RowBox[{"fg", ";", "h", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       CD[h][
        RiemannCD[-a, -b, f, g]]],
      Editable->False]}], "]"}]}], "+", 
  RowBox[{"Scalar", "[", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"      ", 
        RowBox[{";", "a"}]}], 
       RowBox[{"abcd", ";", "e", "  "}]],
      AutoSpacing->False],
     CD[-a][
      CD[e][
       RiemannCD[a, b, c, d]]],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"cfgi", ";", "d", ";", "h"}], "        "],
      AutoSpacing->False],
     CD[-h][
      CD[-d][
       RiemannCD[-c, -f, -g, -i]]],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"be", "      "}], 
       RowBox[{"  ", 
        RowBox[{"fg", ";", "h", ";", "i"}]}]],
      AutoSpacing->False],
     CD[i][
      CD[h][
       RiemannCD[-b, -e, f, g]]],
     Editable->False]}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "RiemannToInv"}], "//", "InvSimplify"}], "//", 
  "Simplify"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {2, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {2, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {2, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Renato's examples", "Subsubsection"],

Cell["First example:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invar1", "=", 
  RowBox[{
   RowBox[{"DualRInv", "[", "metric", "]"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}], ",", "1"}], "]"}]}]], "Input"],

Cell[BoxData[
 SubscriptBox["\<\"D\"\>", "\<\"02,1\"\>"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invar2", "=", 
  RowBox[{"InvSimplify", "[", "invar1", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"000,2\"\>"], "2"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvToRiemann", "[", "invar1", "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"Scalar", "[", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "cefg", "    "],
     AutoSpacing->False],
    epsilonmetric[-c, -e, -f, -g],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"  ", "a", " "}], 
      RowBox[{"ab", " ", "c"}]],
     AutoSpacing->False],
    RiemannCD[a, b, -a, c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"b", " ", "d", "     "}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"d", " ", "e"}], ";", "f", ";", "g"}]}]],
     AutoSpacing->False],
    CD[g][
     CD[f][
      RiemannCD[-b, d, -d, e]]],
    Editable->False]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NoScalar", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Epsilon]", "cefg", "    "],
    AutoSpacing->False],
   epsilonmetric[-c, -e, -f, -g],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"  ", "a", " "}], 
     RowBox[{"ab", " ", "c"}]],
    AutoSpacing->False],
   RiemannCD[a, b, -a, c],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["R", 
     RowBox[{"b", " ", "d", "     "}], 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"d", " ", "e"}], ";", "f", ";", "g"}]}]],
    AutoSpacing->False],
   CD[g][
    CD[f][
     RiemannCD[-b, d, -d, e]]],
   Editable->False]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CD", "[", "a", "]"}], "@", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", "%", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Epsilon]", "dfgh", "    "],
    AutoSpacing->False],
   epsilonmetric[-d, -f, -g, -h],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "e"}], "     ", ";", "a"}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g", ";", "h", "  "}]}]],
       AutoSpacing->False],
      CD[-a][
       CD[h][
        CD[g][
         RiemannCD[-c, e, -e, f]]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "b", "   "}], 
        RowBox[{
         RowBox[{"bc", " ", "d"}], ";", "a"}]],
       AutoSpacing->False],
      CD[a][
       RiemannCD[b, c, -b, d]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "b", " "}], 
        RowBox[{"bc", " ", "d"}]],
       AutoSpacing->False],
      RiemannCD[b, c, -b, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "e"}], "     ", ";", "a", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g", ";", "h", "  ", ";", "a"}]}]],
       AutoSpacing->False],
      CD[a][
       CD[-a][
        CD[h][
         CD[g][
          RiemannCD[-c, e, -e, f]]]]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"b", " ", ";", "a"}]}], 
        RowBox[{"bc", " ", "d", "  "}]],
       AutoSpacing->False],
      CD[-a][
       RiemannCD[b, c, -b, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", " ", "e", "       "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g", ";", "h", ";", "a"}]}]],
       AutoSpacing->False],
      CD[a][
       CD[h][
        CD[g][
         RiemannCD[-c, e, -e, f]]]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"b", " ", ";", "a", "  "}]}], 
        RowBox[{
         RowBox[{"bc", " ", "d"}], "  ", ";", "a"}]],
       AutoSpacing->False],
      CD[a][
       CD[-a][
        RiemannCD[b, c, -b, d]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", " ", "e", "     "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g", ";", "h"}]}]],
       AutoSpacing->False],
      CD[h][
       CD[g][
        RiemannCD[-c, e, -e, f]]],
      Editable->False]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr1", "=", 
  RowBox[{"RiemannToInv", "[", "%", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {2, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"D\"\>", "\<\"04,7\"\>"], "+", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"D\"\>", "\<\"13,27\"\>"]}], "+", 
  SubscriptBox["\<\"D\"\>", "\<\"22,6\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CD", "[", "a", "]"}], "@", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "@", 
   RowBox[{"NoScalar", "@", 
    RowBox[{"InvToRiemann", "[", "invar2", "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  InterpretationBox[
   StyleBox[
    SubsuperscriptBox["\[Epsilon]", "dfgi", "    "],
    AutoSpacing->False],
   epsilonmetric[-d, -f, -g, -i],
   Editable->False], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"e", " ", "h", " "}], 
           RowBox[{" ", 
            RowBox[{"h", " ", "i"}]}]],
          AutoSpacing->False],
         RiemannCD[-e, h, -h, i],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"c", "   ", ";", "a"}], 
           RowBox[{" ", "efg", "  "}]],
          AutoSpacing->False],
         CD[-a][
          RiemannCD[-c, e, f, g]],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"c", "   "}], 
           RowBox[{" ", "efg"}]],
          AutoSpacing->False],
         RiemannCD[-c, e, f, g],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{
            RowBox[{"e", " ", "h"}], " ", ";", "a"}], 
           RowBox[{" ", 
            RowBox[{"h", " ", "i", "  "}]}]],
          AutoSpacing->False],
         CD[-a][
          RiemannCD[-e, h, -h, i]],
         Editable->False]}]}], ")"}], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "b", "   "}], 
        RowBox[{
         RowBox[{"bc", " ", "d"}], ";", "a"}]],
       AutoSpacing->False],
      CD[a][
       RiemannCD[b, c, -b, d]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"e", " ", "h", " "}], 
        RowBox[{" ", 
         RowBox[{"h", " ", "i"}]}]],
       AutoSpacing->False],
      RiemannCD[-e, h, -h, i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"b", " ", ";", "a"}]}], 
        RowBox[{"bc", " ", "d", "  "}]],
       AutoSpacing->False],
      CD[-a][
       RiemannCD[b, c, -b, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", "     "}], 
        RowBox[{" ", 
         RowBox[{"efg", ";", "a"}]}]],
       AutoSpacing->False],
      CD[a][
       RiemannCD[-c, e, f, g]],
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", "   "}], 
        RowBox[{" ", "efg"}]],
       AutoSpacing->False],
      RiemannCD[-c, e, f, g],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"  ", 
            RowBox[{"b", " ", ";", "a"}]}], 
           RowBox[{"bc", " ", "d", "  "}]],
          AutoSpacing->False],
         CD[-a][
          RiemannCD[b, c, -b, d]],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"e", " ", "h", "   "}], 
           RowBox[{" ", 
            RowBox[{
             RowBox[{"h", " ", "i"}], ";", "a"}]}]],
          AutoSpacing->False],
         CD[a][
          RiemannCD[-e, h, -h, i]],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"e", " ", "h", " "}], 
           RowBox[{" ", 
            RowBox[{"h", " ", "i"}]}]],
          AutoSpacing->False],
         RiemannCD[-e, h, -h, i],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"  ", 
            RowBox[{"b", " ", ";", "a", "  "}]}], 
           RowBox[{
            RowBox[{"bc", " ", "d"}], "  ", ";", "a"}]],
          AutoSpacing->False],
         CD[a][
          CD[-a][
           RiemannCD[b, c, -b, d]]],
         Editable->False]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "b", " "}], 
        RowBox[{"bc", " ", "d"}]],
       AutoSpacing->False],
      RiemannCD[b, c, -b, d],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{
            RowBox[{"e", " ", "h"}], " ", ";", "a"}], 
           RowBox[{" ", 
            RowBox[{"h", " ", "i", "  "}]}]],
          AutoSpacing->False],
         CD[-a][
          RiemannCD[-e, h, -h, i]],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"c", "     "}], 
           RowBox[{" ", 
            RowBox[{"efg", ";", "a"}]}]],
          AutoSpacing->False],
         CD[a][
          RiemannCD[-c, e, f, g]],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"c", "   ", ";", "a"}], 
           RowBox[{" ", "efg", "  "}]],
          AutoSpacing->False],
         CD[-a][
          RiemannCD[-c, e, f, g]],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"e", " ", "h", "   "}], 
           RowBox[{" ", 
            RowBox[{
             RowBox[{"h", " ", "i"}], ";", "a"}]}]],
          AutoSpacing->False],
         CD[a][
          RiemannCD[-e, h, -h, i]],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"e", " ", "h", " "}], 
           RowBox[{" ", 
            RowBox[{"h", " ", "i"}]}]],
          AutoSpacing->False],
         RiemannCD[-e, h, -h, i],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"c", "   ", ";", "a", "  "}], 
           RowBox[{" ", 
            RowBox[{"efg", "  ", ";", "a"}]}]],
          AutoSpacing->False],
         CD[a][
          CD[-a][
           RiemannCD[-c, e, f, g]]],
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{"c", "   "}], 
           RowBox[{" ", "efg"}]],
          AutoSpacing->False],
         RiemannCD[-c, e, f, g],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          SubsuperscriptBox["R", 
           RowBox[{
            RowBox[{"e", " ", "h"}], " ", ";", "a", "  "}], 
           RowBox[{" ", 
            RowBox[{
             RowBox[{"h", " ", "i"}], "  ", ";", "a"}]}]],
          AutoSpacing->False],
         CD[a][
          CD[-a][
           RiemannCD[-e, h, -h, i]]],
         Editable->False]}]}], ")"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"RiemannToInv", "[", "%", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["\<\"D\"\>", "\<\"002,14\"\>"]}], "+", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"002,16\"\>"], "2"], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"D\"\>", "\<\"011,68\"\>"]}], "+", 
  SubscriptBox["\<\"D\"\>", "\<\"011,102\"\>"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"InvSimplify", "[", 
   RowBox[{"expr1", "-", "expr2"}], "]"}], "//", "Simplify"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell["Second example:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CurvatureRelations", "=", "False"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"RiemannCD", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"xAct`Invar`Private`RicciToRiemann", "[", 
    RowBox[{"RicciCD", "[", 
     RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"a_", ",", "b__"}], "]"}], "[", "exp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CD", "[", "a", "]"}], "[", 
   RowBox[{
    RowBox[{"CD", "[", "b", "]"}], "[", "exp", "]"}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"IndicesOf", "[", "]"}], "[", "expr", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "f5"}], ",", 
   RowBox[{"-", "d2"}], ",", 
   RowBox[{"-", "b4"}], ",", 
   RowBox[{"-", "c1"}], ",", 
   RowBox[{"-", "g9"}], ",", 
   RowBox[{"-", "f4"}], ",", "f9", ",", "b4", ",", "c1", ",", 
   RowBox[{"-", "f9"}], ",", 
   RowBox[{"-", "a"}], ",", "g9", ",", "f5", ",", "f4", ",", "d2", ",", "a"}],
   "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"HoldComplete", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", "a", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"g9", ",", "f5", ",", "f4", ",", "d2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "f9"}], ",", "c1"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "g9"}], ",", 
         RowBox[{"-", "f4"}], ",", "f9", ",", "b4"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "b4"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"R", "[", 
       RowBox[{"g9", ",", "f5", ",", "f4", ",", "d2"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "f9"}], ",", "c1"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "g9"}], ",", 
         RowBox[{"-", "f4"}], ",", "f9", ",", "b4"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "b4"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", "h2"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "f5", ",", "a0", ",", "z"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "f9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "f9", ",", 
         RowBox[{"-", "h2"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "a0"}], ",", 
        RowBox[{"-", "z"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", "h2", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "f5", ",", "a0", ",", "z"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "f9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "f9", ",", 
         RowBox[{"-", "h2"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "a0"}], ",", 
        RowBox[{"-", "z"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", "b8"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "f5", ",", "b7", ",", "d2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b8"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "g6", ",", 
         RowBox[{"-", "b7"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "g6"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"CD", "[", "b8", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "f5", ",", "b7", ",", "d2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b8"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "g6", ",", 
         RowBox[{"-", "b7"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "g6"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"CD", "[", "a", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"g9", ",", "f5", ",", "h1", ",", "d2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "e6"}], ",", "e6"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "g9"}], ",", "b0", ",", 
         RowBox[{"-", "h1"}], ",", "e5"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "b0"}], ",", 
        RowBox[{"-", "e5"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"g9", ",", "f5", ",", "h1", ",", "d2"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "e6"}], ",", "e6"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "g9"}], ",", "b0", ",", 
         RowBox[{"-", "h1"}], ",", "e5"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "b0"}], ",", 
        RowBox[{"-", "e5"}]}], "]"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", "c7"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "c5", ",", "h9", ",", "f2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "h9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "g6", ",", 
         RowBox[{"-", "c5"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f2"}], ",", 
        RowBox[{"-", "c7"}], ",", 
        RowBox[{"-", "g6"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"CD", "[", "c7", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "c5", ",", "h9", ",", "f2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "h9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "g6", ",", 
         RowBox[{"-", "c5"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f2"}], ",", 
        RowBox[{"-", "c7"}], ",", 
        RowBox[{"-", "g6"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", "b8"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"f3", ",", "f2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b8"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "f3"}], ",", "g7", ",", "b4", ",", "c1"}], "]"}], "]"}],
       "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f2"}], ",", 
        RowBox[{"-", "g7"}], ",", 
        RowBox[{"-", "b4"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", "b8", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"f3", ",", "f2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b8"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "f3"}], ",", "g7", ",", "b4", ",", "c1"}], "]"}], "]"}],
       "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f2"}], ",", 
        RowBox[{"-", "g7"}], ",", 
        RowBox[{"-", "b4"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", "b8"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "f5", ",", "a0", ",", "z"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b8"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "a0"}], ",", 
        RowBox[{"-", "z"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", "b8", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"d3", ",", "f5", ",", "a0", ",", "z"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b8"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "d3"}], ",", "c1"}], "]"}], "]"}], "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "a0"}], ",", 
        RowBox[{"-", "z"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"CD", "[", "a", "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"g9", ",", "f5", ",", "i1", ",", "d2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "f9"}], ",", 
         RowBox[{"-", "i1"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "g9"}], ",", "b0", ",", "f9", ",", "e5"}], "]"}], "]"}],
       "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "b0"}], ",", 
        RowBox[{"-", "e5"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"g9", ",", "f5", ",", "i1", ",", "d2"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "f9"}], ",", 
         RowBox[{"-", "i1"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "g9"}], ",", "b0", ",", "f9", ",", "e5"}], "]"}], "]"}],
       "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f5"}], ",", 
        RowBox[{"-", "d2"}], ",", 
        RowBox[{"-", "b0"}], ",", 
        RowBox[{"-", "e5"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "g9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"g9", ",", "f3", ",", "h9", ",", "f2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "h9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "f3"}], ",", "g7", ",", "b4", ",", "c1"}], "]"}], "]"}],
       "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f2"}], ",", 
        RowBox[{"-", "g7"}], ",", 
        RowBox[{"-", "b4"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g9"}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{"g9", ",", "f3", ",", "h9", ",", "f2"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "h9"}]}], "]"}], "[", 
       RowBox[{"R", "[", 
        RowBox[{
         RowBox[{"-", "f3"}], ",", "g7", ",", "b4", ",", "c1"}], "]"}], "]"}],
       "*", 
      RowBox[{"epsilonmetric", "[", 
       RowBox[{
        RowBox[{"-", "f2"}], ",", 
        RowBox[{"-", "g7"}], ",", 
        RowBox[{"-", "b4"}], ",", 
        RowBox[{"-", "c1"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"expr", ",", 
     RowBox[{
      RowBox[{"epsilonmetric", "[", "inds__", "]"}], "\[Rule]", 
      RowBox[{"{", "inds", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "a0"}], ",", 
   RowBox[{"-", "b0"}], ",", 
   RowBox[{"-", "b4"}], ",", 
   RowBox[{"-", "c1"}], ",", 
   RowBox[{"-", "c7"}], ",", 
   RowBox[{"-", "d2"}], ",", 
   RowBox[{"-", "e5"}], ",", 
   RowBox[{"-", "f2"}], ",", 
   RowBox[{"-", "f5"}], ",", 
   RowBox[{"-", "g6"}], ",", 
   RowBox[{"-", "g7"}], ",", 
   RowBox[{"-", "z"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"expr", ",", 
     RowBox[{
      RowBox[{"R", "[", "inds__", "]"}], "\[Rule]", 
      RowBox[{"{", "inds", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a0", ",", "b0", ",", "b4", ",", 
   RowBox[{"-", "b7"}], ",", "b7", ",", "c1", ",", 
   RowBox[{"-", "c5"}], ",", "c5", ",", "d2", ",", 
   RowBox[{"-", "d3"}], ",", "d3", ",", "e5", ",", "f2", ",", 
   RowBox[{"-", "f3"}], ",", "f3", ",", 
   RowBox[{"-", "f4"}], ",", "f4", ",", "f5", ",", "f9", ",", "g6", ",", "g7",
    ",", 
   RowBox[{"-", "g9"}], ",", "g9", ",", 
   RowBox[{"-", "h1"}], ",", "h1", ",", 
   RowBox[{"-", "h2"}], ",", "h9", ",", "i1", ",", "z"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"expr", ",", 
     RowBox[{
      RowBox[{"CD", "[", "inds__", "]"}], "\[Rule]", 
      RowBox[{"{", "inds", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "a"}], ",", "a", ",", 
   RowBox[{"-", "b8"}], ",", "b8", ",", "c1", ",", "c7", ",", 
   RowBox[{"-", "e6"}], ",", "e6", ",", 
   RowBox[{"-", "f9"}], ",", 
   RowBox[{"-", "g9"}], ",", "h2", ",", 
   RowBox[{"-", "h9"}], ",", 
   RowBox[{"-", "i1"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"Union", "[", 
    RowBox[{"%", ",", "%%", ",", "%%%"}], "]"}], ",", "_Symbol"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "a", ",", "a0", ",", "b0", ",", "b4", ",", "b7", ",", "b8", ",", "c1", ",", 
   "c5", ",", "c7", ",", "d2", ",", "d3", ",", "e5", ",", "e6", ",", "f2", 
   ",", "f3", ",", "f4", ",", "f5", ",", "f9", ",", "g6", ",", "g7", ",", 
   "g9", ",", "h1", ",", "h2", ",", "h9", ",", "i1", ",", "z"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Drop", "[", 
  RowBox[{"%", ",", "1"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "a0", ",", "b0", ",", "b4", ",", "b7", ",", "b8", ",", "c1", ",", "c5", ",",
    "c7", ",", "d2", ",", "d3", ",", "e5", ",", "e6", ",", "f2", ",", "f3", 
   ",", "f4", ",", "f5", ",", "f9", ",", "g6", ",", "g7", ",", "g9", ",", 
   "h1", ",", "h2", ",", "h9", ",", "i1", ",", "z"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Drop", "[", 
  RowBox[{"%", ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "a0", ",", "b0", ",", "b4", ",", "b7", ",", "b8", ",", "c1", ",", "c5", ",",
    "c7", ",", "d2", ",", "d3", ",", "e5", ",", "e6", ",", "f2", ",", "f3", 
   ",", "f4", ",", "f5", ",", "f9", ",", "g6", ",", "g7", ",", "g9", ",", 
   "h1", ",", "h2", ",", "h9", ",", "i1"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"AddIndices", "[", 
  RowBox[{"TangentM", ",", "%"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IndicesOfVBundle", "[", "TangentM", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h",
      ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", 
     ",", "p", ",", "q", ",", "a0", ",", "b0", ",", "b4", ",", "b7", ",", 
     "b8", ",", "c1", ",", "c5", ",", "c7", ",", "d2", ",", "d3", ",", "e5", 
     ",", "e6", ",", "f2", ",", "f3", ",", "f4", ",", "f5", ",", "f9", ",", 
     "g6", ",", "g7", ",", "g9", ",", "h1", ",", "h2", ",", "h9", ",", "i1"}],
     "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"RiemannCD", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"xAct`Invar`Private`RicciToRiemann", "[", 
    RowBox[{
     RowBox[{"RicciCD", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "CD"}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"ReleaseHold", "[", "expr", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"g9f4", "       ", ";", "f9", ";", "a"}], 
      RowBox[{"    ", 
       RowBox[{"f9b4", ";", "c1", "     "}]}]],
     AutoSpacing->False],
    CD[-a][
     CD[-f9][
      CD[c1][
       RiemannCD[-g9, -f4, f9, b4]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"g9f5f4d2", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     RiemannCD[g9, f5, f4, d2]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2b0e5", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -b0, -e5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"g9", "  ", "h1"}], "     ", ";", "e6", ";", "a"}], 
      RowBox[{"  ", 
       RowBox[{
        RowBox[{"b0", "  ", "e5"}], ";", "e6", "     "}]}]],
     AutoSpacing->False],
    CD[-a][
     CD[-e6][
      CD[e6][
       RiemannCD[-g9, b0, -h1, e5]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"g9f5h1d2", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     RiemannCD[g9, f5, h1, d2]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2b0e5", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -b0, -e5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"g9", "      ", ";", "i1", ";", "f9", ";", "a"}], 
      RowBox[{"  ", "b0f9e5", "        "}]],
     AutoSpacing->False],
    CD[-a][
     CD[-f9][
      CD[-i1][
       RiemannCD[-g9, b0, f9, e5]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"g9f5i1d2", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     RiemannCD[g9, f5, i1, d2]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2b0e5", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -b0, -e5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "        ", "g9f5h1d2"],
     AutoSpacing->False],
    RiemannCD[g9, f5, h1, d2],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"g9", "  ", "h1"}], "     ", ";", "e6", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{
        RowBox[{"b0", "  ", "e5"}], ";", "e6", "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-e6][
       CD[e6][
        RiemannCD[-g9, b0, -h1, e5]]]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "        ", "g9f5f4d2"],
     AutoSpacing->False],
    RiemannCD[g9, f5, f4, d2],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"g9f4", "       ", ";", "f9", ";", "a", "  "}], 
      RowBox[{"    ", 
       RowBox[{"f9b4", ";", "c1", "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-f9][
       CD[c1][
        RiemannCD[-g9, -f4, f9, b4]]]]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2b0e5", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -b0, -e5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "        ", "g9f5i1d2"],
     AutoSpacing->False],
    RiemannCD[g9, f5, i1, d2],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"g9", "      ", ";", "i1", ";", "f9", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{"b0f9e5", "        ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-f9][
       CD[-i1][
        RiemannCD[-g9, b0, f9, e5]]]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5a0zc1", "       "],
     AutoSpacing->False],
    epsilonmetric[-f5, -a0, -z, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"d3b", "   ", ";", "b8", ";", "a"}], 
      RowBox[{"   ", "c1b", "     "}]],
     AutoSpacing->False],
    CD[-a][
     CD[-b8][
      RiemannCD[-d3, -b, c1, b]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "            ", 
      RowBox[{"d3f5a0z", ";", "b8", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     CD[b8][
      RiemannCD[d3, f5, a0, z]]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2g6c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -g6, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"d3", "  ", "b7"}], "  ", ";", "b8", ";", "a"}], 
      RowBox[{"  ", 
       RowBox[{"g6", "  ", "c1", "     "}]}]],
     AutoSpacing->False],
    CD[-a][
     CD[-b8][
      RiemannCD[-d3, g6, -b7, c1]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "             ", 
      RowBox[{"d3f5b7d2", ";", "b8", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     CD[b8][
      RiemannCD[d3, f5, b7, d2]]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f2g7b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f2, -g7, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"f3", "      ", ";", "b8", ";", "a"}], 
      RowBox[{"  ", "g7b4c1", "     "}]],
     AutoSpacing->False],
    CD[-a][
     CD[-b8][
      RiemannCD[-f3, g7, b4, c1]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"  ", "a0", "         "}], 
      RowBox[{
       RowBox[{"f3", "  ", "f2a0"}], ";", "b8", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     CD[b8][
      RiemannCD[f3, -a0, f2, a0]]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f2c7g6c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f2, -c7, -g6, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"d3", "  ", "c5"}], "  ", ";", "h9", ";", "a"}], 
      RowBox[{"  ", 
       RowBox[{"g6", "  ", "c1", "     "}]}]],
     AutoSpacing->False],
    CD[-a][
     CD[-h9][
      RiemannCD[-d3, g6, -c5, c1]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "             ", 
      RowBox[{"d3c5h9f2", ";", "c7", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     CD[c7][
      RiemannCD[d3, c5, h9, f2]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f2g7b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f2, -g7, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"f3", "      ", ";", "h9", ";", "a"}], 
      RowBox[{"  ", "g7b4c1", "     "}]],
     AutoSpacing->False],
    CD[-a][
     CD[-h9][
      RiemannCD[-f3, g7, b4, c1]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"        ", 
       RowBox[{";", "g9", "  "}]}], 
      RowBox[{"g9f3h9f2", "   ", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     CD[-g9][
      RiemannCD[g9, f3, h9, f2]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5a0zc1", "       "],
     AutoSpacing->False],
    epsilonmetric[-f5, -a0, -z, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"d3", "  ", "h2"}], "  ", ";", "f9", ";", "a"}], 
      RowBox[{"  ", 
       RowBox[{"f9", "  ", "c1", "     "}]}]],
     AutoSpacing->False],
    CD[-a][
     CD[-f9][
      RiemannCD[-d3, f9, -h2, c1]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "            ", 
      RowBox[{"d3f5a0z", ";", "h2", ";", "a"}]],
     AutoSpacing->False],
    CD[a][
     CD[h2][
      RiemannCD[d3, f5, a0, z]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5a0zc1", "       "],
     AutoSpacing->False],
    epsilonmetric[-f5, -a0, -z, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"d3b", "   ", ";", "b8", ";", "a", "  "}], 
      RowBox[{"   ", 
       RowBox[{"c1b", "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-b8][
       RiemannCD[-d3, -b, c1, b]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"d3f5a0z", ";", "b8"}]],
     AutoSpacing->False],
    CD[b8][
     RiemannCD[d3, f5, a0, z]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5d2g6c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f5, -d2, -g6, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"d3", "  ", "b7"}], "  ", ";", "b8", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{
        RowBox[{"g6", "  ", "c1"}], "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-b8][
       RiemannCD[-d3, g6, -b7, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "           ", 
      RowBox[{"d3f5b7d2", ";", "b8"}]],
     AutoSpacing->False],
    CD[b8][
     RiemannCD[d3, f5, b7, d2]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f2g7b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f2, -g7, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"f3", "      ", ";", "b8", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{"g7b4c1", "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-b8][
       RiemannCD[-f3, g7, b4, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"  ", "a0", "       "}], 
      RowBox[{
       RowBox[{"f3", "  ", "f2a0"}], ";", "b8"}]],
     AutoSpacing->False],
    CD[b8][
     RiemannCD[f3, -a0, f2, a0]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f2c7g6c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f2, -c7, -g6, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"d3", "  ", "c5"}], "  ", ";", "h9", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{
        RowBox[{"g6", "  ", "c1"}], "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-h9][
       RiemannCD[-d3, g6, -c5, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "           ", 
      RowBox[{"d3c5h9f2", ";", "c7"}]],
     AutoSpacing->False],
    CD[c7][
     RiemannCD[d3, c5, h9, f2]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f2g7b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-f2, -g7, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"f3", "      ", ";", "h9", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{"g7b4c1", "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-h9][
       RiemannCD[-f3, g7, b4, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"        ", 
       RowBox[{";", "g9"}]}], 
      RowBox[{"g9f3h9f2", "   "}]],
     AutoSpacing->False],
    CD[-g9][
     RiemannCD[g9, f3, h9, f2]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "f5a0zc1", "       "],
     AutoSpacing->False],
    epsilonmetric[-f5, -a0, -z, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"d3", "  ", "h2"}], "  ", ";", "f9", ";", "a", "  "}], 
      RowBox[{"  ", 
       RowBox[{
        RowBox[{"f9", "  ", "c1"}], "     ", ";", "a"}]}]],
     AutoSpacing->False],
    CD[a][
     CD[-a][
      CD[-f9][
       RiemannCD[-d3, f9, -h2, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"d3f5a0z", ";", "h2"}]],
     AutoSpacing->False],
    CD[h2][
     RiemannCD[d3, f5, a0, z]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "//", "ToCanonical"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4c1c5", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -c1, -c5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"ab0", "       ", ";", "b8", ";", "b7"}], 
      RowBox[{"   ", 
       RowBox[{"b8c1", ";", "c5", "      "}]}]],
     AutoSpacing->False],
    CD[-b7][
     CD[-b8][
      CD[c5][
       RiemannCD[-a, -b0, b8, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4b8c5", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -b8, -c5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"a", "      ", ";", "b0", ";", "c1", ";", "b7"}], 
      RowBox[{" ", "b8c1c5", "         "}]],
     AutoSpacing->False],
    CD[-b7][
     CD[-c1][
      CD[-b0][
       RiemannCD[-a, b8, c1, c5]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4b8c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -b8, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "b0"}], "     ", ";", "c5", ";", "b7"}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"b8", "  ", "c1"}], ";", "c5", "      "}]}]],
     AutoSpacing->False],
    CD[-b7][
     CD[-c5][
      CD[c5][
       RiemannCD[-a, b8, -b0, c1]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "b4b8c1c5", "        "],
     AutoSpacing->False],
    epsilonmetric[-b4, -b8, -c1, -c5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"a0", "      ", ";", "b0", ";", "b7"}], 
      RowBox[{"  ", "b8c1c5", "      "}]],
     AutoSpacing->False],
    CD[-b7][
     CD[-b0][
      RiemannCD[-a0, b8, c1, c5]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"       ", 
       RowBox[{";", "a", "   "}]}], 
      RowBox[{"aa0b0b4", "  ", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     CD[-a][
      RiemannCD[a, a0, b0, b4]]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "b0b8c1c5", "        "],
     AutoSpacing->False],
    epsilonmetric[-b0, -b8, -c1, -c5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"a0", "      ", ";", "b4", ";", "b7"}], 
      RowBox[{"  ", "b8c1c5", "      "}]],
     AutoSpacing->False],
    CD[-b7][
     CD[-b4][
      RiemannCD[-a0, b8, c1, c5]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"   ", "a", "        "}], 
      RowBox[{
       RowBox[{"aa0", " ", "b0"}], ";", "b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     CD[b4][
      RiemannCD[a, a0, -a, b0]]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4c1c5", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -c1, -c5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "b0"}], "  ", ";", "b7", ";", "b8"}], 
      RowBox[{" ", 
       RowBox[{"c1", "  ", "c5", "      "}]}]],
     AutoSpacing->False],
    CD[-b8][
     CD[-b7][
      RiemannCD[-a, c1, -b0, c5]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "             ", 
      RowBox[{"aa0b0b4", ";", "b7", ";", "b8"}]],
     AutoSpacing->False],
    CD[b8][
     CD[b7][
      RiemannCD[a, a0, b0, b4]]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4c1c5", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -c1, -c5],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"ab0b7", "     ", ";", "b8"}], 
      RowBox[{"     ", 
       RowBox[{"c1", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-b8][
     CD[c5][
      RiemannCD[-a, -b0, -b7, c1]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "             ", 
      RowBox[{"aa0b0b4", ";", "b7", ";", "b8"}]],
     AutoSpacing->False],
    CD[b8][
     CD[b7][
      RiemannCD[a, a0, b0, b4]]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "b4b7b8c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-b4, -b7, -b8, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "a0"}], "  ", ";", "b0", "   ", ";", "c5"}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"b8", "  ", "c1"}], "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b0][
       RiemannCD[-a, b8, -a0, c1]]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "b4b7b8c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-b4, -b7, -b8, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"       ", 
       RowBox[{";", "a"}]}], 
      RowBox[{"aa0b0b4", "  "}]],
     AutoSpacing->False],
    CD[-a][
     RiemannCD[a, a0, b0, b4]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"a0", "      ", ";", "b0", "   ", ";", "c5"}], 
      RowBox[{"  ", 
       RowBox[{"b7b8c1", "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b0][
       RiemannCD[-a0, b7, b8, c1]]]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "b0b7b8c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-b0, -b7, -b8, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"   ", "a", "     "}], 
      RowBox[{
       RowBox[{"aa0", " ", "b0"}], ";", "b4"}]],
     AutoSpacing->False],
    CD[b4][
     RiemannCD[a, a0, -a, b0]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"a0", "      ", ";", "b4", "   ", ";", "c5"}], 
      RowBox[{"  ", 
       RowBox[{"b7b8c1", "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b4][
       RiemannCD[-a0, b7, b8, c1]]]],
    Editable->False]}], "-", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4b8c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -b8, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "b0"}], "  ", ";", "b7", "   ", ";", "c5"}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"b8", "  ", "c1"}], "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b7][
       RiemannCD[-a, b8, -b0, c1]]]],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b0b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b0, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "b8"}], "  ", ";", "b7", "   ", ";", "c5"}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"b8", "  ", "c1"}], "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b7][
       RiemannCD[-a, b8, -b8, c1]]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4b8c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -b8, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "       ", "aa0b0b4"],
     AutoSpacing->False],
    RiemannCD[a, a0, b0, b4],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"ab0", "       ", ";", "b7", "   ", ";", "c5"}], 
      RowBox[{"   ", 
       RowBox[{"b7b8", ";", "c1", "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b7][
       CD[c1][
        RiemannCD[-a, -b0, b7, b8]]]]],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b0b4c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b0, -b4, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "          ", 
      RowBox[{"aa0b0b4", ";", "b7"}]],
     AutoSpacing->False],
    CD[b7][
     RiemannCD[a, a0, b0, b4]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "b7"}], "  ", ";", "b8", "   ", ";", "c5"}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"b8", "  ", "c1"}], "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b8][
       RiemannCD[-a, b8, -b7, c1]]]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4b7c1", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -b7, -c1],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "       ", "aa0b0b4"],
     AutoSpacing->False],
    RiemannCD[a, a0, b0, b4],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"a", "      ", ";", "b0", ";", "b8", "   ", ";", "c5"}], 
      RowBox[{" ", 
       RowBox[{"b7b8c1", "      ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-b8][
       CD[-b0][
        RiemannCD[-a, b7, b8, c1]]]]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "a0b4b7b8", "        "],
     AutoSpacing->False],
    epsilonmetric[-a0, -b4, -b7, -b8],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "       ", "aa0b0b4"],
     AutoSpacing->False],
    RiemannCD[a, a0, b0, b4],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{
       RowBox[{"a", "  ", "b0"}], "     ", ";", "c1", "   ", ";", "c5"}], 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"b7", "  ", "b8"}], ";", "c1", "   ", ";", "c5", "   "}]}]],
     AutoSpacing->False],
    CD[-c5][
     CD[c5][
      CD[-c1][
       CD[c1][
        RiemannCD[-a, b7, -b0, b8]]]]],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"IndexList", "@@", 
    RowBox[{"First", "@", 
     RowBox[{"IndicesOfVBundle", "[", "TangentM", "]"}]}]}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{"Range", "[", "15", "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
   ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "expr2", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["\<\"D\"\>", "\<\"04,331\"\>"]}], "-", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"04,355\"\>"], "2"], "+", 
  SubscriptBox["\<\"D\"\>", "\<\"04,396\"\>"], "+", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"13,102\"\>"], "2"], "+", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"13,121\"\>"], "2"], "-", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"13,377\"\>"], "2"], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"D\"\>", "\<\"13,421\"\>"]}], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"D\"\>", "\<\"13,425\"\>"]}], "-", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"13,429\"\>"], "2"], "-", 
  SubscriptBox["\<\"D\"\>", "\<\"13,435\"\>"], "-", 
  FractionBox[
   SubscriptBox["\<\"D\"\>", "\<\"13,693\"\>"], "2"], "+", 
  SubscriptBox["\<\"D\"\>", "\<\"13,842\"\>"], "+", 
  SubscriptBox["\<\"D\"\>", "\<\"22,153\"\>"], "-", 
  SubscriptBox["\<\"D\"\>", "\<\"22,308\"\>"], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"D\"\>", "\<\"22,437\"\>"]}], "-", 
  RowBox[{"2", " ", 
   SubscriptBox["\<\"D\"\>", "\<\"22,473\"\>"]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", "%", "]"}]], "Input"],

Cell["\<\
-DualRInv[metric][{0, 4}, 331] - 
 DualRInv[metric][{0, 4}, 355]/2 + 
 DualRInv[metric][{0, 4}, 396] + 
 DualRInv[metric][{1, 3}, 102]/2 + 
 DualRInv[metric][{1, 3}, 121]/2 - 
 DualRInv[metric][{1, 3}, 377]/2 - 
 2*DualRInv[metric][{1, 3}, 421] - 
 2*DualRInv[metric][{1, 3}, 425] - 
 DualRInv[metric][{1, 3}, 429]/2 - 
 DualRInv[metric][{1, 3}, 435] - 
 DualRInv[metric][{1, 3}, 693]/2 + 
 DualRInv[metric][{1, 3}, 842] + 
 DualRInv[metric][{2, 2}, 153] - 
 DualRInv[metric][{2, 2}, 308] - 
 2*DualRInv[metric][{2, 2}, 437] - 
 2*DualRInv[metric][{2, 2}, 473]\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "expr2", "]"}]], "Input"],

Cell[BoxData["18"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvSimplify", "[", "%%", "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Relation in the previous paper", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"epsilonmetric", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", "e", ",", "f"}], "]"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "e"}], ",", 
     RowBox[{"-", "f"}], ",", "g"}], "]"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "d"}], ",", "h", ",", "i", ",", "j"}], "]"}], 
   RowBox[{"RicciCD", "[", 
    RowBox[{
     RowBox[{"-", "g"}], ",", 
     RowBox[{"-", "i"}]}], "]"}], 
   RowBox[{"RicciCD", "[", 
    RowBox[{
     RowBox[{"-", "h"}], ",", 
     RowBox[{"-", "j"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"1", "/", "8"}], 
   RowBox[{"epsilonmetric", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", "e", ",", "f"}], "]"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}], ",", 
     RowBox[{"-", "e"}], ",", 
     RowBox[{"-", "f"}]}], "]"}], 
   RowBox[{"RiemannCD", "[", 
    RowBox[{"g", ",", "h", ",", "i", ",", "j"}], "]"}], 
   RowBox[{"RicciCD", "[", 
    RowBox[{
     RowBox[{"-", "g"}], ",", 
     RowBox[{"-", "i"}]}], "]"}], 
   RowBox[{"RicciCD", "[", 
    RowBox[{
     RowBox[{"-", "h"}], ",", 
     RowBox[{"-", "j"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "    ", "abcd"],
     AutoSpacing->False],
    epsilonmetric[a, b, c, d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "gi", "  "],
     AutoSpacing->False],
    RicciCD[-g, -i],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "hj", "  "],
     AutoSpacing->False],
    RicciCD[-h, -j],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"ab", "  "}], 
      RowBox[{"  ", "ef"}]],
     AutoSpacing->False],
    RiemannCD[-a, -b, e, f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"cef", " "}], 
      RowBox[{"   ", "g"}]],
     AutoSpacing->False],
    RiemannCD[-c, -e, -f, g],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"d", "   "}], 
      RowBox[{" ", "hij"}]],
     AutoSpacing->False],
    RiemannCD[-d, h, i, j],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["\[Epsilon]", "    ", "abcd"],
     AutoSpacing->False],
    epsilonmetric[a, b, c, d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "gi", "  "],
     AutoSpacing->False],
    RicciCD[-g, -i],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "hj", "  "],
     AutoSpacing->False],
    RicciCD[-h, -j],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", 
      RowBox[{"ab", "  "}], 
      RowBox[{"  ", "ef"}]],
     AutoSpacing->False],
    RiemannCD[-a, -b, e, f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "cdef", "    "],
     AutoSpacing->False],
    RiemannCD[-c, -d, -e, -f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     SubsuperscriptBox["R", "    ", "ghij"],
     AutoSpacing->False],
    RiemannCD[g, h, i, j],
    Editable->False]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "[", "%", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["\<\"D\"\>", "\<\"00000,89\"\>"]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "8"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InvSimplify", "[", "%", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 0}, " and dimension ", 4],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["More examples", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"memory", "=", 
     RowBox[{"MemoryInUse", "[", "]"}]}], ")"}], "/", "1000."}], "/", 
  "1024"}]], "Input"],

Cell[BoxData["29.7776796875`"], "Output"]
}, Open  ]],

Cell["Examples of RiemannToInv and InvToRiemann:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "h"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "a"}], "]"}], "@", 
       RowBox[{"RiemannCD", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], 
     RowBox[{"RiemannCD", "[", 
      RowBox[{
       RowBox[{"-", "b"}], ",", 
       RowBox[{"-", "d"}], ",", "e", ",", "f"}], "]"}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "g"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "c"}], "]"}], "@", 
       RowBox[{"RiemannCD", "[", 
        RowBox[{
         RowBox[{"-", "e"}], ",", 
         RowBox[{"-", "f"}], ",", "g", ",", "h"}], "]"}]}]}]}], "+", 
    RowBox[{
     RowBox[{"RInv", "[", "metric", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", "1157"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannCD", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", "e", ",", "f", ",", "g"}], "]"}], 
     RowBox[{"RiemannCD", "[", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
     RowBox[{"RiemannCD", "[", 
      RowBox[{"h", ",", "i", ",", "j", ",", "k"}], "]"}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "d"}], "]"}], "[", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "h"}], ",", 
        RowBox[{"-", "i"}], ",", 
        RowBox[{"-", "j"}], ",", 
        RowBox[{"-", "k"}]}], "]"}], "]"}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "e"}], "]"}], "[", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"-", "b"}], ",", 
        RowBox[{"-", "c"}], ",", 
        RowBox[{"-", "f"}], ",", 
        RowBox[{"-", "g"}]}], "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"RInv", "[", "metric", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      "27015"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannCD", "[", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "h"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "g"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "c"}], "]"}], "@", 
        RowBox[{
         RowBox[{"CD", "[", "h", "]"}], "@", 
         RowBox[{
          RowBox[{"CD", "[", 
           RowBox[{"-", "f"}], "]"}], "@", 
          RowBox[{
           RowBox[{"CD", "[", 
            RowBox[{"-", "e"}], "]"}], "@", 
           RowBox[{
            RowBox[{"CD", "[", 
             RowBox[{"-", "d"}], "]"}], "@", 
            RowBox[{
             RowBox[{"CD", "[", "g", "]"}], "[", 
             RowBox[{"RiemannCD", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", "e", ",", 
               RowBox[{"-", "b"}], ",", "f"}], "]"}], "]"}]}]}]}]}]}]}]}]}], 
    "+", 
    RowBox[{
     RowBox[{"RInv", "[", "metric", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "8"}], "}"}], ",", "20018"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"epsilonmetric", "[", 
      RowBox[{
       RowBox[{"-", "b"}], ",", 
       RowBox[{"-", "d"}], ",", 
       RowBox[{"-", "g"}], ",", 
       RowBox[{"-", "h"}]}], "]"}], 
     RowBox[{
      RowBox[{"CD", "[", 
       RowBox[{"-", "c"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "a"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "f"}], "]"}], "[", 
        RowBox[{"RiemannCD", "[", 
         RowBox[{"g", ",", "f", ",", 
          RowBox[{"-", "e"}], ",", "h"}], "]"}], "]"}]}]}], 
     RowBox[{
      RowBox[{"CD", "[", "e", "]"}], "[", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"DualRInv", "[", "metric", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "914"}], "]"}]}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RiemannToInv", "/@", 
  RowBox[{"Array", "[", 
   RowBox[{"test", ",", "4"}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 8}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {1, 3}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InvToRiemann", "/@", 
    RowBox[{"Array", "[", 
     RowBox[{"test", ",", "4"}], "]"}]}], "//", "NoScalar"}], "//", 
  "ToCanonical"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell["Shortcuts:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inv", "=", 
   RowBox[{"RInv", "[", "metric", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dinv", "=", 
   RowBox[{"DualRInv", "[", "metric", "]"}]}], ";"}]}], "Input"],

Cell["Examples of relations at step 2:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "5", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "15073"}], "]"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "15063"}], "]"}], "/", 
     "4"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "15072"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "6", "]"}], "=", 
   RowBox[{
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "914"}], "]"}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "908"}], "]"}], "/", "4"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "7", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      "27015"}], "]"}], "+", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       "26365"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "8", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", "8", "}"}], ",", "1116"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", "8", "}"}], ",", "1092"}], "]"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", "8", "}"}], ",", "1115"}], "]"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$InvSimplifyLevel", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvSimplify", "/@", 
  RowBox[{"Array", "[", 
   RowBox[{"test", ",", "4", ",", "5"}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {8}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell["Examples of relations at step 3:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "9", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "15072"}], "]"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "1750"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "1751"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "1753"}], "]"}]}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", "1754"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "10", "]"}], "=", 
   RowBox[{
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "908"}], "]"}], "+", 
    RowBox[{"4", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "328"}], "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "332"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "11", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      "26365"}], "]"}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       "26327"}], "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       "26335"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "12", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", "8", "}"}], ",", "1092"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", "8", "}"}], ",", "1090"}], "]"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", "8", "}"}], ",", "1091"}], "]"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$InvSimplifyLevel", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvSimplify", "/@", 
  RowBox[{"Array", "[", 
   RowBox[{"test", ",", "4", ",", "9"}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {8}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell["Examples of relations at step 4:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "13", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", "70"}], "]"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "50"}], "]"}],
     "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "100"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "14", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", "74"}], "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", "18"}], "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", "19"}], "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "71"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "251"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "264"}], 
      "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "267"}], 
      "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "5"}], 
      "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "6"}], 
      "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "8"}], 
      "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "12"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "31"}], 
      "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "32"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "34"}], 
      "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "35"}], 
      "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "37"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "41"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", "42"}], 
      "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "2"}], "]"}]}], "+", 
    RowBox[{"10", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "6"}], "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "8"}], "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "9"}], "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "11"}], "]"}]}], "+", 
    RowBox[{"6", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "12"}], "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "25"}], "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "27"}], "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "31"}], "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "33"}], "]"}]}], "+", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "35"}], "]"}]}], "-", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "36"}], "]"}]}], "-", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "38"}], "]"}]}], "-", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "43"}], "]"}]}], "-", 
    RowBox[{"8", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "45"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "15", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "11"}], "]"}]}], "+", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "10"}], "]"}], "+", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "2"}], "]"}], "-", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "4"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "6"}], "]"}]}], "+", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "88"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "89"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "16", "]"}], "=", 
   RowBox[{
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "5"}], "]"}], "-", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "1"}], "]"}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "18"}], "]"}], "/", 
     "2"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$InvSimplifyLevel", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvSimplify", "/@", 
  RowBox[{"Array", "[", 
   RowBox[{"test", ",", "4", ",", "13"}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell["Examples of relations at step 5:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "17", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "5861"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "7"}], "]"}], "/", 
     "8"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "49"}], "]"}], "/", 
     "4"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "380"}], "]"}], "/", 
     "2"}], "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "392"}], "]"}], "/", 
     "2"}], "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "474"}], "]"}], "/", 
     "2"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "480"}], "]"}], "/", 
     "2"}], "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "625"}], "]"}], "/", 
     "2"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "631"}], "]"}], "/", 
     "2"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1356"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1362"}], "]"}]}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1380"}], "]"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1416"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1422"}], "]"}], "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "2229"}], "]"}], "/", 
     "2"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "2626"}], "]"}], "/", 
     "2"}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "4985"}], "]"}]}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "5804"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "5816"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "5837"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "18", "]"}], "=", 
   RowBox[{
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", "95"}], "]"}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", "2", "}"}], ",", "1"}], "]"}], "/", "4"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "19", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "3901"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}], ",", "7"}], "]"}], "/", "8"}]}], "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}], ",", "150"}], "]"}], "/", "2"}]}], 
    "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}], ",", "155"}], "]"}], "/", "2"}]}], 
    "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "14"}], "]"}], "/", 
     "4"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "101"}], "]"}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "111"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "585"}], "]"}]}], "+", 
    
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "590"}], "]"}], "+", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "602"}], "]"}]}], "+", 
    
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "718"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "1144"}], "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "3567"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "3572"}], "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", "3875"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "20", "]"}], "=", 
   RowBox[{
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "4"}], "]"}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "1"}], "]"}], "/", 
     "2"}], "+", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "2"}], "]"}], "-", 
    RowBox[{"dinv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "3"}], "]"}]}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$InvSimplifyLevel", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvSimplify", "/@", 
  RowBox[{"Array", "[", 
   RowBox[{"test", ",", "4", ",", "17"}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {1, 2, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 2, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 5, case ", {0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {3, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading NEInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}]}],
  SequenceForm["Reading NEInvRules for step 4 and case ", {0, 3, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 3, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell["Examples of relations at step 6:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "21", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "53"}], 
      "]"}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "1"}], "]"}], "^", "2"}], "/", 
     "4"}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "1"}], "]"}], "^", "2"}], "/", 
     "64"}], "+", 
    RowBox[{"3", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "4"}], "]"}], "/", "8"}]}], "-", 
    RowBox[{"5", 
     RowBox[{
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", "4"}], "]"}], "^", "2"}], "/", 
      "4"}]}], "-", 
    RowBox[{"3", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "5"}], "]"}], "/", "8"}]}], "+", 
    RowBox[{"5", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "4"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "5"}], "]"}], "/", "2"}]}], "-", 
    RowBox[{"5", 
     RowBox[{
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", "5"}], "]"}], "^", "2"}], "/", 
      "4"}]}], "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "3"}], "]"}],
      "/", "4"}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "5"}], "]"}],
      "/", "4"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "12"}], "]"}],
     "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "14"}], "]"}],
     "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "15"}], "]"}],
     "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "16"}], "]"}],
     "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "20"}], "]"}],
     "-", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "22"}], 
      "]"}]}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "23"}], "]"}],
     "-", 
    RowBox[{"3", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "38"}], 
      "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "39"}], 
      "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "40"}], 
      "]"}]}], "+", 
    RowBox[{"6", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "41"}], 
      "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "42"}], 
      "]"}]}], "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "43"}], "]"}],
     "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "44"}], "]"}],
     "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "45"}], 
      "]"}], "/", "2"}], "+", 
    RowBox[{"3", 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "46"}], 
       "]"}], "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "22", "]"}], "=", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "1104"}], 
     "]"}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "25"}], "]"}], "/", "4"}]}], 
    "-", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "1098"}], 
      "]"}], "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "23", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", "25986"}], 
      "]"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], ",", "294"}], "]"}], "/", "8"}]}], 
    "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "1"}], "]"}], "/", 
      "8"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "2"}], "]"}], "/", 
      "4"}]}], "+", 
    RowBox[{"3", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "18"}], "]"}], "/", 
      "32"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "63"}], "]"}], "/", 
      "8"}]}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "86"}], "]"}], "/", 
      "2"}]}], "+", 
    RowBox[{"5", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "87"}], "]"}], "/", 
      "8"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "97"}], "]"}], "/", 
      "16"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "117"}], "]"}], "/", 
      "32"}]}], "+", 
    RowBox[{"3", 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", "271"}], "]"}], "/", 
      "16"}]}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], "/", "16"}]}], "+", 
    RowBox[{
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", "25974"}], 
      "]"}], "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "24", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", "5470"}], 
      "]"}]}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], ",", "19"}], "]"}], "/", "8"}]}], 
    "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", "2"}], "]"}], "/", 
      "4"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", "5"}], "]"}], "/", 
      "16"}]}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", "14"}], "]"}], "/", 
      "16"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", "32"}], "]"}], "/", 
      "4"}]}], "-", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}], ",", "15"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], "/", "16"}]}], "+", 
    RowBox[{
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{"dinv", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], "/", "16"}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], "^", "2"}], 
     RowBox[{
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", "1"}], "]"}], "^", "2"}], "/", 
      "128"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"dinv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "]"}], "^", "2"}], 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], "/", "32"}]}], 
    "-", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", "5461"}], 
     "]"}], "+", 
    RowBox[{"inv", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", "5466"}], 
     "]"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$InvSimplifyLevel", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"InvSimplify", "/@", 
  RowBox[{"Array", "[", 
   RowBox[{"test", ",", "4", ",", "21"}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {1, 1, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {1, 1, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 1, 1}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0", "}"}], "\[InvisibleSpace]", "\<\" and dimension \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "Reading InvRules for step 6, case ", {0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 1, 3}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 2 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 3 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 4 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 5, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 5, case ", {0, 0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 6, case \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" and dimension \"\>", "\[InvisibleSpace]", "4"}],
  
  SequenceForm[
  "Reading InvRules for step 6, case ", {0, 0, 2, 2}, " and dimension ", 4],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"MemoryInUse", "[", "]"}], "-", "memory"}], ")"}], "/", 
   "1000."}], "/", "1024"}]], "Input"],

Cell[BoxData["265.2934140625`"], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dual products", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SignDetOfMetric", "[", "metric", "]"}], "^=", "sigma"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  StyleBox["\[Sigma]",
   AutoSpacing->False],
  sigma,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Read dual invariants", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadDuals", "[", "case_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Dlist", "[", "case", "]"}], "=", 
      RowBox[{
       RowBox[{"DualRInvs", "[", 
        RowBox[{"5", ",", "case"}], "]"}], "/.", 
       RowBox[{"DualRInv", "\[Rule]", 
        RowBox[{"DualRInv", "[", "metric", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Slist", "[", "case", "]"}], "=", 
      RowBox[{"InvToRiemann", "/@", 
       RowBox[{"Dlist", "[", "case", "]"}]}]}]}], ")"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Scalar", "[", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]", "cdef", "    "],
      AutoSpacing->False],
     epsilonmetric[-c, -d, -e, -f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"ab", "  "}], 
       RowBox[{"  ", "ef"}]],
      AutoSpacing->False],
     RiemannCD[-a, -b, e, f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", "    ", "abcd"],
      AutoSpacing->False],
     RiemannCD[a, b, c, d],
     Editable->False]}], "]"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Scalar", "[", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]", "cdfg", "    "],
      AutoSpacing->False],
     epsilonmetric[-c, -d, -f, -g],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", "    ", "abcd"],
      AutoSpacing->False],
     RiemannCD[a, b, c, d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{
        RowBox[{"a", " ", "e"}], " ", ";", "b", "  "}], 
       RowBox[{" ", 
        RowBox[{
         RowBox[{"e", " ", "f"}], "  ", ";", "g"}]}]],
      AutoSpacing->False],
     CD[g][
      CD[-b][
       RiemannCD[-a, e, -e, f]]],
     Editable->False]}], "]"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cfhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "d", " "}], 
        RowBox[{"de", " ", "f"}]],
       AutoSpacing->False],
      RiemannCD[d, e, -d, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"b", " ", "g"}], " ", ";", "e", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], "  ", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       CD[-e][
        RiemannCD[-b, g, -g, h]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cefi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -e, -f, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", "   "}], 
        RowBox[{" ", "def"}]],
       AutoSpacing->False],
      RiemannCD[-b, d, e, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", 
         RowBox[{"gh", ";", "d", "  "}]}], 
        RowBox[{"gh", "    ", ";", "i"}]],
       AutoSpacing->False],
      CD[i][
       CD[-d][
        RiemannCD[g, h, -g, -h]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cefh", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -e, -f, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", "   "}], 
        RowBox[{" ", "def"}]],
       AutoSpacing->False],
      RiemannCD[-b, d, e, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"d", " ", "g"}], "   ", ";", "i"}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i", "  "}]}]],
       AutoSpacing->False],
      CD[-i][
       CD[i][
        RiemannCD[-d, g, -g, h]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "efhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-e, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", "   "}], 
        RowBox[{" ", "def"}]],
       AutoSpacing->False],
      RiemannCD[-b, d, e, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "g"}], " ", ";", "d", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], "  ", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       CD[-d][
        RiemannCD[-c, g, -g, h]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "fghi", "    "],
       AutoSpacing->False],
      epsilonmetric[-f, -g, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "defg"],
       AutoSpacing->False],
      RiemannCD[d, e, f, g],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"bdc", " ", ";", "e", "  "}], 
        RowBox[{"   ", 
         RowBox[{"h", "  ", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       CD[-e][
        RiemannCD[-b, -d, -c, h]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "efhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-e, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"ab", "  "}], 
        RowBox[{"  ", "ef"}]],
       AutoSpacing->False],
      RiemannCD[-a, -b, e, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"c", " ", "g"}], " ", ";", "d", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], "  ", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       CD[-d][
        RiemannCD[-c, g, -g, h]]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cefi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -e, -f, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "d", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"d", " ", "e"}], ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-b, d, -d, e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "gh", "  "}], 
        RowBox[{"gh", "  ", ";", "i"}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[g, h, -g, -h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "efhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-e, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "d", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"d", " ", "e"}], ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-b, d, -d, e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", " ", "g", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-c, g, -g, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cfhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "d", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"d", " ", "e"}], ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-b, d, -d, e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"e", " ", "g", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-e, g, -g, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cdfi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -d, -f, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "e"}], " ", ";", "b"}], 
        RowBox[{" ", 
         RowBox[{"e", " ", "f", "  "}]}]],
       AutoSpacing->False],
      CD[-b][
       RiemannCD[-a, e, -e, f]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "gh", "  "}], 
        RowBox[{"gh", "  ", ";", "i"}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[g, h, -g, -h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "efhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-e, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "c", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"d", " ", "e"}], ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-b, d, -c, e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"d", " ", "g", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-d, g, -g, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cfgi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -f, -g, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", "     "}], 
        RowBox[{" ", 
         RowBox[{"def", ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-b, d, e, f]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"d", " ", "eh", "  "}], 
        RowBox[{" ", 
         RowBox[{"h", "  ", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-d, h, -e, -h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "dfhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-d, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", " ", "ce", "  "}], 
        RowBox[{" ", 
         RowBox[{"e", "  ", ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-a, e, -c, -e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "g", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-b, g, -g, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "dfhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-d, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "e"}], " ", ";", "b"}], 
        RowBox[{" ", 
         RowBox[{"e", " ", "f", "  "}]}]],
       AutoSpacing->False],
      CD[-b][
       RiemannCD[-a, e, -e, f]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", " ", "g", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-c, g, -g, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cdgi", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -d, -g, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"a", " ", "e", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-a, e, -e, f]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "fh", "  "}], 
        RowBox[{" ", 
         RowBox[{"h", "  ", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-b, h, -f, -h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "defi", "    "],
       AutoSpacing->False],
      epsilonmetric[-d, -e, -f, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"abc", "   "}], 
        RowBox[{"   ", 
         RowBox[{"e", ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-a, -b, -c, e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "gh", "  "}], 
        RowBox[{"gh", "  ", ";", "i"}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[g, h, -g, -h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "fghi", "    "],
       AutoSpacing->False],
      epsilonmetric[-f, -g, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", "     "}], 
        RowBox[{" ", 
         RowBox[{"def", ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-b, d, e, f]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"ced", "   "}], 
        RowBox[{"   ", 
         RowBox[{"h", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-c, -e, -d, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "efhi", "    "],
       AutoSpacing->False],
      epsilonmetric[-e, -f, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"abc", "   "}], 
        RowBox[{"   ", 
         RowBox[{"e", ";", "f"}]}]],
       AutoSpacing->False],
      CD[f][
       RiemannCD[-a, -b, -c, e]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"d", " ", "g", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"g", " ", "h"}], ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-d, g, -g, h]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "fghi", "    "],
       AutoSpacing->False],
      epsilonmetric[-f, -g, -h, -i],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"ab", "    "}], 
        RowBox[{"  ", 
         RowBox[{"ef", ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-a, -b, e, f]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cde", "   "}], 
        RowBox[{"   ", 
         RowBox[{"h", ";", "i"}]}]],
       AutoSpacing->False],
      CD[i][
       RiemannCD[-c, -d, -e, h]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 1}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cdfg", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -d, -f, -g],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "   "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d"}]],
       AutoSpacing->False],
      CD[d][
       RiemannCD[a, b, -a, c]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "e", "   "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-b, e, -e, f]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "defg", "    "],
       AutoSpacing->False],
      epsilonmetric[-d, -e, -f, -g],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"abc", "   "}], 
        RowBox[{"   ", 
         RowBox[{"f", ";", "g"}]}]],
       AutoSpacing->False],
      CD[g][
       RiemannCD[-a, -b, -c, f]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cefh", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -e, -f, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", "   "}], 
        RowBox[{" ", "def"}]],
       AutoSpacing->False],
      RiemannCD[-b, d, e, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"d", " ", "g", " "}], 
        RowBox[{" ", 
         RowBox[{"g", " ", "h"}]}]],
       AutoSpacing->False],
      RiemannCD[-d, g, -g, h],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "efgh", "    "],
       AutoSpacing->False],
      epsilonmetric[-e, -f, -g, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"ab", "  "}], 
        RowBox[{"  ", "ef"}]],
       AutoSpacing->False],
      RiemannCD[-a, -b, e, f],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "    ", "abcd"],
       AutoSpacing->False],
      RiemannCD[a, b, c, d],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"cd", "  "}], 
        RowBox[{"  ", "gh"}]],
       AutoSpacing->False],
      RiemannCD[-c, -d, g, h],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Scalar", "[", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]", "eghj", "    "],
      AutoSpacing->False],
     epsilonmetric[-e, -g, -h, -j],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"  ", "a", " "}], 
       RowBox[{"ab", " ", "c"}]],
      AutoSpacing->False],
     RiemannCD[a, b, -a, c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"b", " ", "c", " "}], 
       RowBox[{" ", 
        RowBox[{"d", " ", "e"}]}]],
      AutoSpacing->False],
     RiemannCD[-b, d, -c, e],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"d", "   "}], 
       RowBox[{" ", "fgh"}]],
      AutoSpacing->False],
     RiemannCD[-d, f, g, h],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{"f", " ", "i", " "}], 
       RowBox[{" ", 
        RowBox[{"i", " ", "j"}]}]],
      AutoSpacing->False],
     RiemannCD[-f, i, -i, j],
     Editable->False]}], "]"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "gijl", "    "],
       AutoSpacing->False],
      epsilonmetric[-g, -i, -j, -l],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "d", " "}], 
        RowBox[{" ", 
         RowBox[{"d", " ", "e"}]}]],
       AutoSpacing->False],
      RiemannCD[-b, d, -d, e],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"c", " ", "f", " "}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g"}]}]],
       AutoSpacing->False],
      RiemannCD[-c, f, -f, g],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"e", "   "}], 
        RowBox[{" ", "hij"}]],
       AutoSpacing->False],
      RiemannCD[-e, h, i, j],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"h", " ", "k", " "}], 
        RowBox[{" ", 
         RowBox[{"k", " ", "l"}]}]],
       AutoSpacing->False],
      RiemannCD[-h, k, -k, l],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "gijl", "    "],
       AutoSpacing->False],
      epsilonmetric[-g, -i, -j, -l],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", " "}], 
        RowBox[{"ab", " ", "c"}]],
       AutoSpacing->False],
      RiemannCD[a, b, -a, c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"b", " ", "c", " "}], 
        RowBox[{" ", 
         RowBox[{"d", " ", "e"}]}]],
       AutoSpacing->False],
      RiemannCD[-b, d, -c, e],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"d", " ", "e", " "}], 
        RowBox[{" ", 
         RowBox[{"f", " ", "g"}]}]],
       AutoSpacing->False],
      RiemannCD[-d, f, -e, g],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"f", "   "}], 
        RowBox[{" ", "hij"}]],
       AutoSpacing->False],
      RiemannCD[-f, h, i, j],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"h", " ", "k", " "}], 
        RowBox[{" ", 
         RowBox[{"k", " ", "l"}]}]],
       AutoSpacing->False],
      RiemannCD[-h, k, -k, l],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {0, 4}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {0, 4}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Scalar", "[", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["\[Epsilon]", "cdfh", "    "],
      AutoSpacing->False],
     epsilonmetric[-c, -d, -f, -h],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", "    ", "abcd"],
      AutoSpacing->False],
     RiemannCD[a, b, c, d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[
      SubsuperscriptBox["R", 
       RowBox[{
        RowBox[{"a", " ", "e"}], " ", ";", "b", "  ", ";", "g", "  "}], 
       RowBox[{" ", 
        RowBox[{
         RowBox[{"e", " ", "f"}], "  ", ";", "g", "  ", ";", "h"}]}]],
      AutoSpacing->False],
     CD[h][
      CD[-g][
       CD[g][
        CD[-b][
         RiemannCD[-a, e, -e, f]]]]],
     Editable->False]}], "]"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 3 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 3 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {1, 3}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {1, 3}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cdfh", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -d, -f, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "   "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d"}]],
       AutoSpacing->False],
      CD[d][
       RiemannCD[a, b, -a, c]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"b", " ", "e"}], "   ", ";", "g", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"e", " ", "f"}], ";", "g", "  ", ";", "h"}]}]],
       AutoSpacing->False],
      CD[h][
       CD[-g][
        CD[g][
         RiemannCD[-b, e, -e, f]]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "degh", "    "],
       AutoSpacing->False],
      epsilonmetric[-d, -e, -g, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "      ", 
        RowBox[{"abcd", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       RiemannCD[a, b, c, d]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"a", " ", "f"}], " ", ";", "b", ";", "c", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"f", " ", "g"}], "    ", ";", "h"}]}]],
       AutoSpacing->False],
      CD[h][
       CD[-c][
        CD[-b][
         RiemannCD[-a, f, -f, g]]]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadDuals", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "2"}], "}"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 2 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 2 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 4 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 4 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 5 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 5 and case ", {2, 2}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading DualInvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}],
  SequenceForm["Reading DualInvRules for step 1 and case ", {2, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cegh", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -e, -g, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "     "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       CD[d][
        RiemannCD[a, b, -a, c]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"b", " ", "f"}], " ", ";", "d", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"f", " ", "g"}], "  ", ";", "h"}]}]],
       AutoSpacing->False],
      CD[h][
       CD[-d][
        RiemannCD[-b, f, -f, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "cegh", "    "],
       AutoSpacing->False],
      epsilonmetric[-c, -e, -g, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"  ", "a", "     "}], 
        RowBox[{
         RowBox[{"ab", " ", "c"}], ";", "d", ";", "e"}]],
       AutoSpacing->False],
      CD[e][
       CD[d][
        RiemannCD[a, b, -a, c]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{
         RowBox[{"d", " ", "f"}], " ", ";", "b", "  "}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"f", " ", "g"}], "  ", ";", "h"}]}]],
       AutoSpacing->False],
      CD[h][
       CD[-b][
        RiemannCD[-d, f, -f, g]]],
      Editable->False]}], "]"}], ",", 
   RowBox[{"Scalar", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["\[Epsilon]", "dfgh", "    "],
       AutoSpacing->False],
      epsilonmetric[-d, -f, -g, -h],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", "        ", 
        RowBox[{"abcd", ";", "e", ";", "f"}]],
       AutoSpacing->False],
      CD[f][
       CD[e][
        RiemannCD[a, b, c, d]]],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[
       SubsuperscriptBox["R", 
        RowBox[{"abc", " ", ";", "e", "  "}], 
        RowBox[{"   ", 
         RowBox[{"g", "  ", ";", "h"}]}]],
       AutoSpacing->False],
      CD[h][
       CD[-e][
        RiemannCD[-a, -b, -c, g]]],
      Editable->False]}], "]"}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Products", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{"case1_", ",", "case2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dtmp", "=", 
        RowBox[{"Outer", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"Dlist", "[", "case1", "]"}], ",", 
          RowBox[{"Dlist", "[", "case2", "]"}]}], "]"}]}], ",", 
       RowBox[{"Stmp", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"RiemannToInv", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"Slist", "[", "case1", "]"}], ",", 
              RowBox[{"Slist", "[", "case2", "]"}]}], "]"}], "//", 
            "NoScalar"}], "//", "ContractMetric"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Union", "@", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InvSimplify", "[", 
            RowBox[{"#", ",", "5"}], "]"}], "&"}], ",", 
          RowBox[{"Stmp", "-", "Dtmp"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "//", "Expand"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "1", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "2", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "3", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "4", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}],
   ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "5", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "6", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "7", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 0, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "8", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "9", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "10", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "11", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 0, 4}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "12", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 1, 3}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "13", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 0, 2, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "14", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "15", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "16", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {1, 1, 1, 1}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "17", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading InvRules for step 1 and case \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["Reading InvRules for step 1 and case ", {0, 1, 1, 2}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"duals", "[", "18", "]"}], "=", 
   RowBox[{"MakeDualProducts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"allduals", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Array", "[", 
     RowBox[{"duals", ",", "18"}], "]"}]}]}], "]"}]], "Input"],

Cell[BoxData["51"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByteCount", "[", "allduals", "]"}]], "Input"],

Cell[BoxData["2127656"], "Output"]
}, Open  ]],

Cell["Two simple functions:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"invsof", "[", "expr_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Cases", "[", 
    RowBox[{"expr", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"RInv", "[", "_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{"RInv", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{
       RowBox[{"DualRInv", "[", "_", "]"}], "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{"DualRInv", "[", 
       RowBox[{"_", ",", "_"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"casesof", "[", "expr_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"First", "/@", 
    RowBox[{"invsof", "[", "expr", "]"}]}], "]"}]}]], "Input"],

Cell["We have 1044 invariants on the 51 equations:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"invsofallduals", "=", 
   RowBox[{"invsof", "[", "allduals", "]"}]}], "]"}]], "Input"],

Cell[BoxData["933"], "Output"]
}, Open  ]],

Cell["and these 29 different cases:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listofcases", "=", 
  RowBox[{"casesof", "[", "allduals", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input"],

Cell[BoxData["29"], "Output"]
}, Open  ]],

Cell["\<\
Let us check whether there are still invariants which can be expanded:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkinvs", "[", "case_", "]"}], ":=", 
  RowBox[{"Complement", "[", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"invsofallduals", ",", 
      RowBox[{
       RowBox[{"RInv", "[", "metric", "]"}], "[", 
       RowBox[{"case", ",", "_"}], "]"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"RInvs", "[", 
      RowBox[{"5", ",", "case"}], "]"}], "/.", 
     RowBox[{"RInv", "\[Rule]", 
      RowBox[{"RInv", "[", "metric", "]"}]}]}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkinvs", "/@", "listofcases"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["Invariants to solve for:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"order", "[", "case_", "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Length", "[", "case", "]"}]}], "+", 
    RowBox[{"Plus", "@@", "case"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"degree", "[", "case_", "]"}], ":=", 
   RowBox[{"Length", "[", "case", "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"largestRInv", "[", "expr_", "]"}], ":=", 
  RowBox[{"Last", "@", 
   RowBox[{"Last", "@", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"order", "[", 
          RowBox[{"First", "[", "#", "]"}], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"degree", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}]}], ",", "#"}], "}"}], 
       "&"}], "/@", 
      RowBox[{"Union", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{"expr", ",", 
         RowBox[{
          RowBox[{"RInv", "[", "_", "]"}], "[", "__", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"largests", "=", 
  RowBox[{"largestRInv", "/@", "allduals"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\<\"I\"\>", "\<\"0000,21\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00000,25\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00000,123\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"000000,180\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0000000,46\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0000000,2190\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"000000,13\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"000000,180\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"000000,1001\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0000000,87\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0000000,1704\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,618\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,708\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,457\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,1414\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,3843\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,6898\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,306\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,791\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,791\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,1815\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,2516\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,2516\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,6143\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,6999\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,12865\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,17074\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0002,545\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0011,368\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0011,1104\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0004,4725\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0013,4405\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0013,25986\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,19699\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,5470\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,5464\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,457\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,6898\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,187\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,2969\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"00011,17074\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"1111,53\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"1111,674\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"1111,4664\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0112,2464\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0112,22975\"\>"], ",", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,5669\"\>"]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "@", 
  RowBox[{"Split", "@", 
   RowBox[{"Sort", "[", "largests", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0000,21\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,545\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0004,4725\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0011,368\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0011,1104\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0013,4405\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0013,25986\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5464\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5470\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5669\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,19699\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0112,2464\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0112,22975\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"1111,53\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"1111,674\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"1111,4664\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00000,25\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00000,123\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,618\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,708\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,1414\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,3843\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,187\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,306\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,1815\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,2969\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,6143\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,6999\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"00011,12865\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"000000,13\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"000000,1001\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0000000,46\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0000000,87\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0000000,1704\"\>"], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox["\<\"I\"\>", "\<\"0000000,2190\"\>"], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00002,457\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,457\"\>"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00002,6898\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,6898\"\>"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00011,791\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00011,791\"\>"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00011,2516\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00011,2516\"\>"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00011,17074\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00011,17074\"\>"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"000000,180\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"000000,180\"\>"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"], ",", 
     SubscriptBox["\<\"I\"\>", "\<\"00011,5744\"\>"]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solutions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"eq", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"allduals", "[", 
         RowBox[{"[", "count", "]"}], "]"}], "/.", "solutions"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"Expand", "/@", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"eq", "\[Equal]", "0"}], ",", 
          RowBox[{"largestRInv", "[", "eq", "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Expand", ",", 
          RowBox[{"solutions", "/.", "sol"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"{", "sol", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"count", ",", "1", ",", 
      RowBox[{"Length", "[", "allduals", "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solutions", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\<\"I\"\>", "\<\"0022,5669\"\>"], "\[Rule]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubsuperscriptBox["\<\"D\"\>", "\<\"02,15\"\>", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"22,17\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"22,19\"\>"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"02,15\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"000,2\"\>"]}], "+", 
   FractionBox[
    RowBox[{"79", " ", 
     InterpretationBox[
      StyleBox["\[Sigma]",
       AutoSpacing->False],
      sigma,
      Editable->False], " ", 
     SubsuperscriptBox["\<\"D\"\>", "\<\"000,2\"\>", "2"]}], "48"], "-", 
   RowBox[{
    FractionBox["1", "12"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"000,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"000,13\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"002,2\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "96"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"002,14\"\>"]}], "+", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"002,32\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "32"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"02,15\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"]}], "+", 
   RowBox[{
    FractionBox["3", "64"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"D\"\>", "\<\"000,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "512"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubsuperscriptBox["\<\"D\"\>", "\<\"00,2\"\>", "2"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"]}], "-", 
   FractionBox[
    RowBox[{"721", " ", 
     SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "6"]}], "96"], "-", 
   RowBox[{
    FractionBox["3", "32"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "4"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"]}], "+", 
   RowBox[{
    FractionBox["31", "32"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"2,1\"\>", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "128"], " ", 
    InterpretationBox[
     StyleBox["\[Sigma]",
      AutoSpacing->False],
     sigma,
     Editable->False], " ", 
    SubsuperscriptBox["\<\"D\"\>", "\<\"00,2\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"]}], "+", 
   RowBox[{
    FractionBox["4069", "64"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "4"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"]}], "-", 
   RowBox[{
    FractionBox["33", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"]}], "-", 
   RowBox[{
    FractionBox["13", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"2,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"]}], "-", 
   RowBox[{
    FractionBox["1779", "32"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"00,1\"\>", "2"]}], "+", 
   RowBox[{
    FractionBox["11", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"00,1\"\>", "2"]}], "+", 
   FractionBox[
    RowBox[{"29", " ", 
     SubsuperscriptBox["\<\"I\"\>", "\<\"00,1\"\>", "3"]}], "8"], "+", 
   RowBox[{
    FractionBox["91", "192"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "4"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"]}], "-", 
   RowBox[{
    FractionBox["19", "96"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"]}], "+", 
   RowBox[{
    FractionBox["3", "32"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"2,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"]}], "+", 
   RowBox[{
    FractionBox["47", "16"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"]}], "+", 
   RowBox[{
    FractionBox["7", "24"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"]}], "-", 
   RowBox[{
    FractionBox["59", "16"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"00,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"]}], "+", 
   RowBox[{
    FractionBox["3", "64"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"00,2\"\>", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "64"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"00,2\"\>", "2"]}], "+", 
   RowBox[{
    FractionBox["23", "24"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,1\"\>"]}], "-", 
   RowBox[{
    FractionBox["25", "4"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,1\"\>"]}], "+", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,1\"\>"]}], "+", 
   RowBox[{
    FractionBox["28", "9"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"]}], "-", 
   RowBox[{
    FractionBox["19", "4"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"]}], "+", 
   RowBox[{
    FractionBox["29", "6"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"]}], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SubsuperscriptBox["\<\"I\"\>", "\<\"02,2\"\>", "2"]}], "2"], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,6\"\>"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,6\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,6\"\>"]}], "-", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,6\"\>"]}], "+", 
   SubsuperscriptBox["\<\"I\"\>", "\<\"02,6\"\>", "2"], "-", 
   RowBox[{
    FractionBox["3", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"22,1\"\>"]}], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,1\"\>"]}], "8"], "-", 
   RowBox[{
    FractionBox["13", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"22,8\"\>"]}], "+", 
   FractionBox[
    RowBox[{"9", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,8\"\>"]}], "4"], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,8\"\>"]}], "8"], "+", 
   RowBox[{
    FractionBox["15", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"22,17\"\>"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"22,17\"\>"]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,17\"\>"]}], "8"], "-", 
   RowBox[{
    FractionBox["9", "4"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"22,19\"\>"]}], "+", 
   FractionBox[
    RowBox[{"5", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,19\"\>"]}], "2"], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,19\"\>"]}], "4"], "+", 
   RowBox[{
    FractionBox["3", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"22,22\"\>"]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,22\"\>"]}], "2"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"22,22\"\>"]}], "8"], "+", 
   RowBox[{
    FractionBox["2503", "24"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "-", 
   RowBox[{
    FractionBox["343", "36"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "-", 
   RowBox[{"50", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "+", 
   RowBox[{
    FractionBox["203", "24"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "+", 
   FractionBox[
    RowBox[{"5", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "9"], "-", 
   FractionBox[
    RowBox[{"7", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"02,6\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"]}], "3"], "-", 
   RowBox[{"28", " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"000,1\"\>", "2"]}], "-", 
   RowBox[{
    FractionBox["51", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "-", 
   RowBox[{"12", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "+", 
   RowBox[{
    FractionBox["5", "8"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "+", 
   FractionBox[
    RowBox[{"11", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"02,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "2"], "+", 
   FractionBox[
    RowBox[{"25", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "6"], "-", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"02,6\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "+", 
   FractionBox[
    RowBox[{"107", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"]}], "3"], "-", 
   FractionBox[
    RowBox[{"21", " ", 
     SubsuperscriptBox["\<\"I\"\>", "\<\"000,2\"\>", "2"]}], "4"], "-", 
   RowBox[{
    FractionBox["13", "96"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "3"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "+", 
   RowBox[{
    FractionBox["5", "144"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "+", 
   RowBox[{
    FractionBox["13", "16"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"02,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "12"], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"02,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "18"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"000,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "2"], "-", 
   FractionBox[
    RowBox[{"7", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"000,5\"\>"]}], "12"], "+", 
   RowBox[{
    FractionBox["9", "8"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,1\"\>"]}], "-", 
   FractionBox[
    RowBox[{"7", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"002,1\"\>"]}], "2"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"002,1\"\>"]}], "8"], "+", 
   RowBox[{
    FractionBox["79", "24"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,2\"\>"]}], "-", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,2\"\>"]}], "+", 
   RowBox[{"7", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,2\"\>"]}], "-", 
   FractionBox[
    RowBox[{"7", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"002,2\"\>"]}], "24"], "-", 
   RowBox[{"6", " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,5\"\>"]}], "+", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,5\"\>"]}], "-", 
   RowBox[{"9", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,5\"\>"]}], "+", 
   RowBox[{"6", " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,6\"\>"]}], "-", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,6\"\>"]}], "+", 
   RowBox[{"9", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,6\"\>"]}], "+", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,7\"\>"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,8\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,8\"\>"]}], "-", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,8\"\>"]}], "+", 
   FractionBox[
    RowBox[{"5", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"002,8\"\>"]}], "12"], "-", 
   RowBox[{"3", " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,14\"\>"]}], "+", 
   RowBox[{"7", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,14\"\>"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"002,52\"\>"]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"002,52\"\>"]}], "2"], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"002,52\"\>"]}], "2"], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"022,1\"\>"]}], "4"], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,6\"\>"]}], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,8\"\>"]}], "-", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,21\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,22\"\>"]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,23\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,29\"\>"]}], "+", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,49\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,51\"\>"]}], "-", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,54\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,65\"\>"]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"022,109\"\>"]}], "2"], "+", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,271\"\>"]}], "-", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"022,273\"\>"]}], "+", 
   RowBox[{
    FractionBox["1291", "16"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0000,1\"\>"]}], "-", 
   FractionBox[
    RowBox[{"53", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,1\"\>"]}], "6"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,1\"\>"]}], "4"], "+", 
   FractionBox[
    RowBox[{"61", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,1\"\>"]}], "8"], "-", 
   RowBox[{
    FractionBox["97", "16"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0000,5\"\>"]}], "-", 
   FractionBox[
    RowBox[{"221", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,5\"\>"]}], "8"], "-", 
   FractionBox[
    RowBox[{"11", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,5\"\>"]}], "16"], "-", 
   RowBox[{
    FractionBox["55", "4"], " ", 
    SubsuperscriptBox["\<\"I\"\>", "\<\"0,1\"\>", "2"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0000,7\"\>"]}], "+", 
   FractionBox[
    RowBox[{"5", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"2,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,7\"\>"]}], "6"], "+", 
   FractionBox[
    RowBox[{"43", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,7\"\>"]}], "2"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"00,2\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0000,7\"\>"]}], "2"], "+", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,1\"\>"]}], "+", 
   FractionBox[
    RowBox[{"7", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0002,2\"\>"]}], "6"], "-", 
   RowBox[{"7", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,5\"\>"]}], "+", 
   RowBox[{"7", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,6\"\>"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,9\"\>"]}], "+", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,12\"\>"]}], "-", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,23\"\>"]}], "-", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,31\"\>"]}], "+", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,32\"\>"]}], "-", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,34\"\>"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,35\"\>"]}], "+", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,45\"\>"]}], "+", 
   RowBox[{
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,46\"\>"]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0002,55\"\>"]}], "3"], "+", 
   FractionBox[
    RowBox[{"7", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0002,59\"\>"]}], "3"], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0002,120\"\>"]}], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0022,1\"\>"]}], "4"], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,9\"\>"]}], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,11\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,24\"\>"]}], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,26\"\>"]}], "-", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,42\"\>"]}], "-", 
   FractionBox[
    RowBox[{"3", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0022,43\"\>"]}], "2"], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,44\"\>"]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,45\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,51\"\>"]}], "+", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,80\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,82\"\>"]}], "-", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,85\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,96\"\>"]}], "-", 
   FractionBox[
    RowBox[{"5", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0022,118\"\>"]}], "2"], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,120\"\>"]}], "+", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,124\"\>"], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,125\"\>"]}], "-", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,127\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,150\"\>"]}], "-", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,152\"\>"], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,154\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,155\"\>"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,157\"\>"]}], "+", 
   RowBox[{"3", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,161\"\>"]}], "+", 
   FractionBox[
    SubscriptBox["\<\"I\"\>", "\<\"0022,174\"\>"], "2"], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,348\"\>"]}], "-", 
   FractionBox[
    RowBox[{"3", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0022,1738\"\>"]}], "4"], "+", 
   FractionBox[
    SubscriptBox["\<\"I\"\>", "\<\"0022,1740\"\>"], "2"], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5459\"\>"]}], "+", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,5461\"\>"], "-", 
   SubscriptBox["\<\"I\"\>", "\<\"0022,5558\"\>"], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5560\"\>"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5564\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5621\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5623\"\>"]}], "-", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0022,5629\"\>"]}], "+", 
   RowBox[{"100", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00000,2\"\>"]}], "-", 
   RowBox[{"41", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00000,8\"\>"]}], "-", 
   FractionBox[
    RowBox[{"49", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"0,1\"\>"], " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00000,33\"\>"]}], "4"], "-", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,5\"\>"]}], "+", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,8\"\>"]}], "-", 
   RowBox[{"7", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,11\"\>"]}], "+", 
   SubscriptBox["\<\"I\"\>", "\<\"00002,12\"\>"], "-", 
   FractionBox[
    RowBox[{"16", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,17\"\>"]}], "3"], "-", 
   FractionBox[
    RowBox[{"20", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,18\"\>"]}], "3"], "-", 
   RowBox[{"8", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,37\"\>"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,46\"\>"]}], "+", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,48\"\>"]}], "-", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,50\"\>"]}], "+", 
   RowBox[{"14", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,56\"\>"]}], "-", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,61\"\>"]}], "+", 
   RowBox[{"6", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,65\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,90\"\>"]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,92\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,95\"\>"]}], "-", 
   FractionBox[
    RowBox[{"4", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,122\"\>"]}], "3"], "+", 
   FractionBox[
    RowBox[{"16", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,123\"\>"]}], "3"], "+", 
   RowBox[{"5", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,129\"\>"]}], "+", 
   RowBox[{"12", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,186\"\>"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,216\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,219\"\>"]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,243\"\>"]}], "-", 
   RowBox[{"8", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,291\"\>"]}], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["\<\"I\"\>", "\<\"00002,700\"\>"]}], "3"], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,862\"\>"]}], "-", 
   RowBox[{"8", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"00002,962\"\>"]}], "+", 
   RowBox[{"80", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000000,6\"\>"]}], "-", 
   RowBox[{"57", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000000,8\"\>"]}], "-", 
   RowBox[{"17", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000000,47\"\>"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["\<\"I\"\>", "\<\"000000,242\"\>"]}]}]}]], "Output"]
}, Closed]],

Cell[BoxData[
 RowBox[{"solutions", ">>", "\"\<solutions\>\""}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Intersection", "[", 
  RowBox[{
   RowBox[{"First", "/@", "solutions"}], ",", 
   RowBox[{"invsof", "[", 
    RowBox[{"Last", "/@", "solutions"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cases", "=", 
  RowBox[{"Union", "[", 
   RowBox[{"First", "/@", 
    RowBox[{"First", "/@", "solutions"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
     "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"newrules", "=", 
   RowBox[{"ReleaseHold", "/@", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Hold", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{"solutions", ",", 
          RowBox[{"HoldPattern", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RInv", "[", "_", "]"}], "[", 
             RowBox[{"#", ",", "_"}], "]"}], "\[Rule]", "_"}], "]"}]}], "]"}],
         "]"}], "&"}], ")"}], "/@", "cases"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input"],

Cell[BoxData["\<\"/home/jmm/math/DInvar\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"xAct`Invar`Private`filename", "[", 
      RowBox[{"6", ",", 
       RowBox[{"cases", "[", 
        RowBox[{"[", "count", "]"}], "]"}], ",", "4"}], "]"}], ",", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"newrules", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RInv", "[", "metric", "]"}], "\[Rule]", "RInv"}], ",", 
         RowBox[{
          RowBox[{"DualRInv", "[", "metric", "]"}], "\[Rule]", "DualRInv"}]}],
         "}"}]}], "]"}], ",", "\"\<Lines\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"count", ",", "1", ",", 
     RowBox[{"Length", "[", "cases", "]"}]}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"othercases", "=", 
  RowBox[{"Complement", "[", 
   RowBox[{
    RowBox[{"InvarCases", "[", "]"}], ",", "cases"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", "8", "}"}], ",", 
   RowBox[{"{", "10", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"xAct`Invar`Private`filename", "[", 
      RowBox[{"6", ",", 
       RowBox[{"othercases", "[", 
        RowBox[{"[", "count", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}], ",", "\"\<Lines\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"count", ",", "1", ",", 
     RowBox[{"Length", "[", "othercases", "]"}]}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"cases", ",", 
     RowBox[{"Length", "/@", "newrules"}]}], "}"}], "]"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}], "1"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "2"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}], "2"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}], "4"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "2"},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "3"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], "8"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], "17"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       "4"},
     {
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], "4"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1016, 696},
WindowMargins->{{8, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
TrackCellChangeTimes->False,
Magnification->1,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]

